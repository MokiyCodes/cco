-- Built at Mon Nov 14 2022 13:55:54 GMT+0100 (Central European Standard Time) / Production --
return(function(a,...)local b={...}local c=nil;local d={}local require=function(...)local e,f={...},{}for g,i in pairs(e)do if not d[i]then table.insert(f,a(i)or error('[blb] no such module \''..i..'\''))else local j=d[i]if j.isCached then table.insert(f,j.cache)else local k=j.load()j.cache=k;j.isCached=true;table.insert(f,j.cache)end end end;return table.unpack(f)end;d['auth.lua']={}d['auth.lua'].load=function()local l='auth.lua'local m='auth.lua'local n=''local o='96323b36e72a59f49468259a2f09b374829301bff3962b92cea634898064cedecbd96860feb71ee0ad1b58f0f4a55592d3cf8d0733f48c2f84ea93d1ed14a50f'local p=require'base64'local q='_ENCRYPTME'if q~='_'..'ENCRYPTME'then q=p.Decode(q)end;return{encryped=q}end;d['auth.lua'].cache=c;d['auth.lua'].isCached=false;d['boot.lua']={}d['boot.lua'].load=function()local l='boot.lua'local m='boot.lua'local n=''local o='db96a161a4f64aaa203c41d57b2f13d71688d4c030ac5d28fa3a52901935c8ae06d93ff1e93ff1d249d643e6a2c90da566afa89f813b6ca12db918eb6bf2c7fc'local r=require'console'return function()r.clear()if not term.isColor or not term.isColor()then local s={peripheral.find'monitor'}local t={}local u=false;for g,v in pairs(s)do local x,y=v.getSize()if v.isColour()and not(x<10 or y<10)then t[peripheral.getName(v)]=v;u=true end end;if#s==0 or not u then print'Please connect an advanced monitor (2x2 minimum) or run this on an advanced (golden) computer.\nReturning to shell.'return end;local z=''while not t[z]do r.clear()print'Please input a monitor to use.\nAvailable colour monitors:'for A in pairs(t)do print('-',A)end;print'\nNote: You\'ll still need to perform keyboard input on this device.\n\nSelected Montior:'z=read()end;r.clear()r.centerLog'Please continue on the monitor.\nInput text here.'term.redirect(t[z])end;r.clear()r.centerLog'Finalizing...'local xor=require'xor'local B=require'uniquekeys'_G.ccoEncryption={['encryptLocal']=function(C)return xor(C,B.enc)end}_G.ccoEncryption.decryptLocal=_G.ccoEncryption.encryptLocal;_G._g=_G;r.clear()r.centerLog'Rendering...'local D=require'basalt'D.setTheme{BasaltBG=colors.black,BasaltText=colors.white,FrameBG=colors.black,FrameText=colors.lightGray,ButtonBG=colors.gray,ButtonText=colors.white,CheckboxBG=colors.gray,CheckboxText=colors.white,InputBG=colors.gray,InputText=colors.white,TextfieldBG=colors.gray,TextfieldText=colors.white,ProgramBG=colors.gray,LabelText=colors.white}local E=D.createFrame()local F=1;local G={}local function H(I,J,K,L,M)J=J or 4;K=K or 4;L=L or 99;M=M or 99;I:addButton():setPosition('parent.w','parent.h'):setSize(1,1):setText('/'):setForeground(colors.blue):setBackground(colors.black):onDrag(function(self,event,N,O,P)local w,h=I:getSize()local Q,R=w,h;if w+O-1>=J and w+O-1<=L then Q=w+O-1 end;if h+P-1>=K and h+P-1<=M then R=h+P-1 end;I:setSize(Q,R)end)end;local function S(T,U,V,x,y,w,h)local W=F;F=F+1;local X=E:addFrame():setMovable():setSize(math.min((w or 25)+1,({term.getSize()})[1]),h or 12):setPosition(x or math.random(2,12),y or math.random(2,8)):setBackground(colors.red)if({term.getSize()})[1]==25 then X:setPosition(1,y or math.random(2,8))end;X:addLabel():setSize('parent.w - 1',1):setBackground(colors.black):setForeground(colors.lightGray):setText(U or'New Program')X:addProgram():setSize('parent.w - 1','parent.h - 1'):setPosition(1,2):execute(T or'/rom/programs/shell.lua','')X:addButton():setSize(1,1):setText('X'):setBackground(colors.black):setForeground(colors.red):setPosition('parent.w',1):onClick(function()X:remove()G[W]=nil end)if V then H(X,w,h)end;G[W]=X;return X end;_G._openProgramAsWindow=S;local Y=E:addFrame():setScrollable():setSize(8,'parent.h'):setPosition(1,1)local y=-3;local Z=function()y=y+4;return Y:addButton():setPosition(1,y):setSize(8,3)end;Z():setText('Shell'):onClick(function()S('/rom/programs/shell.lua','Shell',true)end)Z():setText('Update'):onClick(function()S('/rom/programs/http/wget.lua run https://raw.githubusercontent.com/MokiyCodes/cco/main/install.lua','Updater',true)end)Z():setText('Chat'):onClick(function()S(function()r.log'Hi!\nPlease enter the name of the room you want to join.'local _=read()r.clear()r.log'Please enter the username you want to join as.'local a0=read()shell.run(string.format('/rom/programs/rednet/chat.lua join %s %s',_,a0))end,'Chat',true)end)Z():setText('Shutdown'):onClick(function()os.shutdown()end)Z():setText('Reboot'):onClick(function()os.reboot()end)D.autoUpdate()end end;d['boot.lua'].cache=c;d['boot.lua'].isCached=false;d['index.lua']={}d['index.lua'].load=function()local l='index.lua'local m='index.lua'local n=''local o='e972ce6b551218c0f7392987b27bfdc76b9ab5f68ca1a72bc354e21cc1124462a0b3af2ddf8ee758242fce240a15dafb9f1b07dbcd2213cc6f8aa374e515be09'local r=require'console'_G.console=r;if b[#b-1]=='loadprogram'then return require('programs/'..b[#b])end;if isStartup then require('termination').setDisabled(true)end;if installer and(not term.isColor or not term.isColor())then r.clear()print'Warning: On non-colour displays, only login & libs are available.\nContinue? [Y/n]'if string.lower(string.sub(read(),1,1))=='n'then print'Aborted.'return end end;require'polyfills/table.create'r.clear()print('Host:',_HOST)print('Is Installer:',installer and'true'or'false')return require(installer and'load-installer'or'login')end;d['index.lua'].cache=c;d['index.lua'].isCached=false;d['load-installer.lua']={}d['load-installer.lua'].load=function()local l='load-installer.lua'local m='load-installer.lua'local n=''local o='91f71c145957e3e2bf325b2778f8a68a51b9875f75c105fa17df371ee628ff6b65977288dead24bff23950132b1c1a59c3679af77ddaab7b74b10617f17302f6'local r=require'console'local a1=require'json'local p=require'base64'r.clear()r.log'Loading Dependencies...'local a2=require'hash'local a3=require'misc/chime'local xor=require'xor'r.clear()term.setCursorBlink(false)r.centerLog'Welcome!'a3()sleep(1)local a4;local a5=function()local a6=function()return read'.'end;a4=''while#a4<1 do r.clear()print'First, we\'re gonna need you to set a password.\n\nRemember it; the device will be unsuable without it.\n\nMust be 8 characters or more.\n'r.logNoNl'Password => 'a4=a6()end;local a7=false;while not a7 do r.clear()print'Now, please repeat that password.\n\nForgot it?\nPress ctrl + t for a few seconds & try again.\n'r.logNoNl'Repeat Password => 'a7=read'.'==a4 end end;local a8={}local a9;if fs.exists'/.cco/.authbackup.json'then r.clear()print'We found a backup authentication store file.\nTypically, this is used to allow any encrypted data to persist when updating.\nWould you like to use it? [Y/n]'local aa=string.lower(string.sub(read(),1,1))if aa~='n'then print'Please input your old password.'a4=read'.'local X=fs.open('/.cco/.authbackup.json','r')local ab=a1.parse(X.readAll())X.close()local ac=ab.encryptionKeyStore;local ad=a2.hmac(a2.sha3_512,ac.pw,a4)local ae=xor(ac.enc,ac.Eenc..ad)if xor(p.Decode(ab.authStoreThing.encryped),ae)~=ad then print('Expected:',ad)print('Decrypt Result:',ab.authStoreThing.encryped)error'Decryption Failure. Please run the installer again.'else print'Decrypt Test Success! Decrypting...'a9=ab.authStoreThing.encryped;for af,ag in pairs(ac)do if af~='Eenc'and af~='pw'then ac[af]=xor(ag,ac.Eenc..a4)end end;a8=ac end else a5()end else a5()end;r.clear()r.centerLog'Setting up Encryption for you...'local B=require'uniquekeys'for af,ag in pairs(a8)do B[af]=ag end;a4=a2.hmac(a2.sha3_512,B.pw,a4)local ah=require'auth'if a9 then ah.encryped=a9 else ah.encryped=p.Encode(xor(a4,B.enc))end;local ai=thisBundle;local aj={}for af,ag in pairs(B)do if af~='pw'and af~='Eenc'then B[af]=xor(ag,B.Eenc..a4)end;aj[af]=p.Encode(B[af])ai=string.gsub(ai,'!!!'..af,aj[af])end;ai=string.gsub(ai,'local shouldB64Decode = false','local shouldB64Decode = true')sleep(0.2)r.clear()r.log'Do you wish to install this system-wide (y), or as an application (N)? [y/N]'local ak=fs.exists'/.cco/setup-launchonstartup'or string.lower(string.sub(read(),1,1))=='y'r.clear()r.centerLog'Installing...'ai=string.gsub(ai,'_ENCRYPTME',ah.encryped)if not fs.isDir'/.cco'then fs.makeDir'/.cco'end;if ak then local al=fs.open('/startup.lua','w')al.write('local isStartup = true;'..ai)al.close()local am=fs.open('/.cco/setup-launchonstartup','w')am.write'ok bro'am.close()else local an=fs.open('/cco.lua','w')an.write('local isStartup = false;'..ai)an.close()end;sleep(0.4)r.clear()r.centerLog'Backing up encryption keys...'local ao=fs.open('/.cco/.authbackup.json','w')ao.write(require('json').stringify{['authStoreThing']=ah,['encryptionKeyStore']=B})ao.close()sleep(0.4)r.clear()if ak then r.centerLog'Rebooting...'sleep(2)os.reboot()else r.log'The OS is available under the command \'cco\'.'sleep(0.5)end end;d['load-installer.lua'].cache=c;d['load-installer.lua'].isCached=false;d['login.lua']={}d['login.lua'].load=function()local l='login.lua'local m='login.lua'local n=''local o='b3a28f2df4c2612850fd9c24072b7402a2f2687d8a9395cc5f421ad2c6361fa50f3669de26028801fc271a29c61db6af01ca307fb70c4e50da62d5e2eb8e770e'local r=require'console'print'Preparing...'require('termination').setDisabled(true)_G.Math=math;local a2=require'hash'local B=require'uniquekeys'local xor=require'xor'local ap=function(a4)a4=a2.hmac(a2.sha3_512,B.pw,a4)local ae=xor(B.enc,B.Eenc..a4)if xor(require('auth').encryped,ae)~=a4 then return true else for af,ag in pairs(B)do if af~='Eenc'and af~='pw'then B[af]=xor(ag,B.Eenc..a4)end end;require('termination').setDisabled(false)require'boot'()end end;repeat r.clear()r.log'Enter your password.'until not ap(read'.')end;d['login.lua'].cache=c;d['login.lua'].isCached=false;d['misc/chime.lua']={}d['misc/chime.lua'].load=function()local l='chime.lua'local m='misc/chime.lua'local n='misc'local o='5cccb2e7b818ee81d9c7d596c00ec7871ab43e5bc512541595d4d896f370762e8c72d58946d9e5d8c52126b4ea2e881348397c7557bec7f087caaa5c88cbeec8'return function(aq)aq=aq or 0.5;local ar=peripheral.find'speaker'if ar then ar.playNote('hat',aq,1)sleep(0.1)ar.playNote('hat',aq,1)sleep(0.1)ar.playNote('hat',aq,13)sleep(0.2)ar.playNote('hat',aq,8)end end end;d['misc/chime.lua'].cache=c;d['misc/chime.lua'].isCached=false;d['packages/basalt.lua']={}d['packages/basalt.lua'].load=function()local l='basalt.lua'local m='packages/basalt.lua'local n='packages'local o='e0bf671b17a66a8f3d641c23c5c0cf03b8785f5e9a1ff2e3402a0fd2eecba02d37f839ecbdc96138e4f31ea5e4ec80551ed6224b94f25ead07a393c08112cadb'local as={}local at=true;local au=require;local require=function(T)for g,ag in pairs(as)do for A,av in pairs(ag)do if A==T then return av()end end end;return au(T)end;local aw=function(ax)if ax~=nil then return as[ax]end;return as end;as['objects']={}as['libraries']={}as['default']={}as['objects']['Animation']=function(...)local ay=require('utils').getValueFromXML;local az=require'basaltEvent'local aA,aB,aC,aD,aE,aF=math.floor,math.sin,math.cos,math.pi,math.sqrt,math.pow;local aG=function(aH,aI,aJ)return aH+(aI-aH)*aJ end;local aK=function(aH)return aH end;local aL=function(aH)return 1-aH end;local aM=function(aH)return aH*aH*aH end;local aN=function(aH)return aL(aM(aL(aH)))end;local aO=function(aH)return aG(aM(aH),aN(aH),aH)end;local aP=function(aH)return aB(aH*aD/2)end;local aQ=function(aH)return aL(aC(aH*aD/2))end;local aR=function(aH)return-(aC(aD*x)-1)/2 end;local aS=function(aH)local aI=1.70158;local aJ=aI+1;return aJ*aH^3-aI*aH^2 end;local aT=function(aH)return aH^3 end;local aU=function(aH)local aI=2*aD/3;return aH==0 and 0 or(aH==1 and 1 or-2^(10*aH-10)*aB((aH*10-10.75)*aI))end;local function aV(aH)return aH==0 and 0 or 2^(10*aH-10)end;local function aW(aH)return aH==0 and 0 or 2^(10*aH-10)end;local function aX(aH)local aI=1.70158;local aJ=aI*1.525;return aH<0.5 and(2*aH)^2*((aJ+1)*2*aH-aJ)/2 or((2*aH-2)^2*((aJ+1)*(aH*2-2)+aJ)+2)/2 end;local function aY(aH)return aH<0.5 and 4*aH^3 or 1-(-2*aH+2)^3/2 end;local function aZ(aH)local aI=2*aD/4.5;return aH==0 and 0 or(aH==1 and 1 or(aH<0.5 and-(2^(20*aH-10)*aB((20*aH-11.125)*aI))/2 or 2^(-20*aH+10)*aB((20*aH-11.125)*aI)/2+1))end;local function a_(aH)return aH==0 and 0 or(aH==1 and 1 or(aH<0.5 and 2^(20*aH-10)/2 or(2-2^(-20*aH+10))/2))end;local function b0(aH)return aH<0.5 and 2*aH^2 or 1-(-2*aH+2)^2/2 end;local function b1(aH)return aH<0.5 and 8*aH^4 or 1-(-2*aH+2)^4/2 end;local function b2(aH)return aH<0.5 and 16*aH^5 or 1-(-2*aH+2)^5/2 end;local function b3(aH)return aH^2 end;local function b4(aH)return aH^4 end;local function b5(aH)return aH^5 end;local function b6(aH)local aI=1.70158;local aJ=aI+1;return 1+aJ*(aH-1)^3+aI*(aH-1)^2 end;local function b7(aH)return 1-(1-aH)^3 end;local function b8(aH)local aI=2*aD/3;return aH==0 and 0 or(aH==1 and 1 or 2^(-10*aH)*aB((aH*10-0.75)*aI)+1)end;local function b9(aH)return aH==1 and 1 or 1-2^(-10*aH)end;local function ba(aH)return 1-(1-aH)*(1-aH)end;local function bb(aH)return 1-(1-aH)^4 end;local function bc(aH)return 1-(1-aH)^5 end;local function bd(aH)return 1-aE(1-aF(aH,2))end;local function be(aH)return aE(1-aF(aH-1,2))end;local function bf(aH)return aH<0.5 and(1-aE(1-aF(2*aH,2)))/2 or(aE(1-aF(-2*aH+2,2))+1)/2 end;local function bg(aH)local aI=7.5625;local aJ=2.75;if aH<1/aJ then return aI*aH*aH elseif aH<2/aJ then local bh=aH-1.5/aJ;return aI*bh*bh+0.75 elseif aH<2.5/aJ then local bh=aH-2.25/aJ;return aI*bh*bh+0.9375 else local bh=aH-2.625/aJ;return aI*bh*bh+0.984375 end end;local function bi(aH)return 1-bg(1-aH)end;local function bj(aH)return x<0.5 and(1-bg(1-2*aH))/2 or(1+bg(2*aH-1))/2 end;local bk={linear=aK,lerp=aG,flip=aL,easeIn=aM,easeInSine=aQ,easeInBack=aS,easeInCubic=aT,easeInElastic=aU,easeInExpo=aW,easeInQuad=b3,easeInQuart=b4,easeInQuint=b5,easeInCirc=bd,easeInBounce=bi,easeOut=aN,easeOutSine=aP,easeOutBack=b6,easeOutCubic=b7,easeOutElastic=b8,easeOutExpo=b9,easeOutQuad=ba,easeOutQuart=bb,easeOutQuint=bc,easeOutCirc=be,easeOutBounce=bg,easeInOut=aO,easeInOutSine=aR,easeInOutBack=aX,easeInOutCubic=aY,easeInOutElastic=aZ,easeInOutExpo=a_,easeInOutQuad=b0,easeInOutQuart=b1,easeInOutQuint=b2,easeInOutCirc=bf,easeInOutBounce=bj}local bl={}return function(aH)local aI={}local aJ='Animation'local bh;local bm={}local bn=0;local bo=false;local bp=1;local bq=false;local br=az()local bs=0;local bt;local bu=false;local bv=false;local bw='easeOut'local bx;local function by(bz)for bA,bB in pairs(bz)do bB(aI,bm[bp].t,bp)end end;local function bC(bz)if bp==1 then bz:animationStartHandler()end;if bm[bp]~=nil then by(bm[bp].f)bn=bm[bp].t end;bp=bp+1;if bm[bp]==nil then if bq then bp=1;bn=0 else bz:animationDoneHandler()return end end;if bm[bp].t>0 then bh=os.startTimer(bm[bp].t-bn)else bC(bz)end end;local function bD(bz,bA)for bE=1,#bm do if bm[bE].t==bz then table.insert(bm[bE].f,bA)return end end;for bE=1,#bm do if bm[bE].t>bz then if bm[bE-1]~=nil then if bm[bE-1].t<bz then table.insert(bm,bE-1,{t=bz,f={bA}})return end else table.insert(bm,bE,{t=bz,f={bA}})return end end end;if#bm<=0 then table.insert(bm,1,{t=bz,f={bA}})return elseif bm[#bm].t<bz then table.insert(bm,{t=bz,f={bA}})end end;local function bF(bz,bA,bB,bG,bH,bI,bJ,bK)local bL=bx;local bM,bN;local bO=''if bL.parent~=nil then bO=bL.parent:getName()end;bO=bO..bL:getName()bD(bG+0.05,function()if bJ~=nil then if bl[bJ]==nil then bl[bJ]={}end;if bl[bJ][bO]~=nil then if bl[bJ][bO]~=bK then bl[bJ][bO]:cancel()end end;bl[bJ][bO]=bK end;bM,bN=bH(bL)end)for bE=0.05,bB+0.01,0.05 do bD(bG+bE,function()local bP=math.floor(bk.lerp(bM,bz,bk[bw](bE/bB))+0.5)local bQ=math.floor(bk.lerp(bN,bA,bk[bw](bE/bB))+0.5)bI(bL,bP,bQ)if bJ~=nil then if bE>=bB-0.01 then if bl[bJ][bO]==bK then bl[bJ][bO]=nil end end end end)end end;aI={name=aH,getType=function(bz)return aJ end,getBaseFrame=function(bz)if bz.parent~=nil then return bz.parent:getBaseFrame()end;return bz end,setMode=function(bz,bA)bw=bA;return bz end,addMode=function(bz,bA,bB)bk[bA]=bB;return bz end,generateXMLEventFunction=function(bz,bA,bB)local bG=function(bH)if bH:sub(1,1)=='#'then local bI=bz:getBaseFrame():getDeepObject(bH:sub(2,bH:len()))if bI~=nil and bI.internalObjetCall~=nil then bA(bz,function()bI:internalObjetCall()end)end else bA(bz,bz:getBaseFrame():getVariable(bH))end end;if type(bB)=='string'then bG(bB)elseif type(bB)=='table'then for bH,bI in pairs(bB)do bG(bI)end end;return bz end,setValuesByXMLData=function(bz,bA)bu=ay('loop',bA)==true and true or false;if ay('object',bA)~=nil then local bB=bz:getBaseFrame():getDeepObject(ay('object',bA))if bB==nil then bB=bz:getBaseFrame():getVariable(ay('object',bA))end;if bB~=nil then bz:setObject(bB)end end;if bA['move']~=nil then local bB=ay('x',bA['move'])local bG=ay('y',bA['move'])local bH=ay('duration',bA['move'])local bI=ay('time',bA['move'])bz:move(bB,bG,bH,bI)end;if bA['size']~=nil then local bB=ay('width',bA['size'])local bG=ay('height',bA['size'])local bH=ay('duration',bA['size'])local bI=ay('time',bA['size'])bz:size(bB,bG,bH,bI)end;if bA['offset']~=nil then local bB=ay('x',bA['offset'])local bG=ay('y',bA['offset'])local bH=ay('duration',bA['offset'])local bI=ay('time',bA['offset'])bz:offset(bB,bG,bH,bI)end;if bA['textColor']~=nil then local bB=ay('duration',bA['textColor'])local bG=ay('time',bA['textColor'])local bH={}local bI=bA['textColor']['color']if bI~=nil then if bI.properties~=nil then bI={bI}end;for bJ,bK in pairs(bI)do table.insert(bH,colors[bK:value()])end end;if bB~=nil and#bH>0 then bz:changeTextColor(bB,bG or 0,table.unpack(bH))end end;if bA['background']~=nil then local bB=ay('duration',bA['background'])local bG=ay('time',bA['background'])local bH={}local bI=bA['background']['color']if bI~=nil then if bI.properties~=nil then bI={bI}end;for bJ,bK in pairs(bI)do table.insert(bH,colors[bK:value()])end end;if bB~=nil and#bH>0 then bz:changeBackground(bB,bG or 0,table.unpack(bH))end end;if bA['text']~=nil then local bB=ay('duration',bA['text'])local bG=ay('time',bA['text'])local bH={}local bI=bA['text']['text']if bI~=nil then if bI.properties~=nil then bI={bI}end;for bJ,bK in pairs(bI)do table.insert(bH,bK:value())end end;if bB~=nil and#bH>0 then bz:changeText(bB,bG or 0,table.unpack(bH))end end;if ay('onDone',bA)~=nil then bz:generateXMLEventFunction(bz.onDone,ay('onDone',bA))end;if ay('onStart',bA)~=nil then bz:generateXMLEventFunction(bz.onDone,ay('onStart',bA))end;if ay('autoDestroy',bA)~=nil then if ay('autoDestroy',bA)then bv=true end end;bw=ay('mode',bA)or bw;if ay('play',bA)~=nil then if ay('play',bA)then bz:play(bu)end end;return bz end,getZIndex=function(bz)return 1 end,getName=function(bz)return bz.name end,setObject=function(bz,bA)bx=bA;return bz end,move=function(bz,bA,bB,bG,bH,bI)bx=bI or bx;bF(bA,bB,bG,bH or 0,bx.getPosition,bx.setPosition,'position',bz)return bz end,offset=function(bz,bA,bB,bG,bH,bI)bx=bI or bx;bF(bA,bB,bG,bH or 0,bx.getOffset,bx.setOffset,'offset',bz)return bz end,size=function(bz,bA,bB,bG,bH,bI)bx=bI or bx;bF(bA,bB,bG,bH or 0,bx.getSize,bx.setSize,'size',bz)return bz end,changeText=function(bz,bA,bB,...)local bG={...}bB=bB or 0;bx=obj or bx;for bE=1,#bG do bD(bB+bE*bA/#bG,function()bx.setText(bx,bG[bE])end)end;return bz end,changeBackground=function(bz,bA,bB,...)local bG={...}bB=bB or 0;bx=obj or bx;for bE=1,#bG do bD(bB+bE*bA/#bG,function()bx.setBackground(bx,bG[bE])end)end;return bz end,changeTextColor=function(bz,bA,bB,...)local bG={...}bB=bB or 0;bx=obj or bx;for bE=1,#bG do bD(bB+bE*bA/#bG,function()bx.setForeground(bx,bG[bE])end)end;return bz end,add=function(bz,bA,bB)bt=bA;bD((bB or bs)+(bm[#bm]~=nil and bm[#bm].t or 0),bA)return bz end,wait=function(bz,bA)bs=bA;return bz end,rep=function(bz,bA)if bt~=nil then for bE=1,bA or 1 do bD((wait or bs)+(bm[#bm]~=nil and bm[#bm].t or 0),bt)end end;return bz end,onDone=function(bz,bA)br:registerEvent('animation_done',bA)return bz end,onStart=function(bz,bA)br:registerEvent('animation_start',bA)return bz end,setAutoDestroy=function(bz,bA)bv=bA~=nil and bA or true;return bz end,animationDoneHandler=function(bz)br:sendEvent('animation_done',bz)bz.parent:removeEvent('other_event',bz)if bv then bz.parent:removeObject(bz)bz=nil end end,animationStartHandler=function(bz)br:sendEvent('animation_start',bz)end,clear=function(bz)bm={}bt=nil;bs=0;bp=1;bn=0;bq=false;return bz end,play=function(bz,bA)bz:cancel()bo=true;bq=bA and true or false;bp=1;bn=0;if bm[bp]~=nil then if bm[bp].t>0 then bh=os.startTimer(bm[bp].t)else bC(bz)end else bz:animationDoneHandler()end;bz.parent:addEvent('other_event',bz)return bz end,cancel=function(bz)if bh~=nil then os.cancelTimer(bh)bq=false end;bo=false;bz.parent:removeEvent('other_event',bz)return bz end,internalObjetCall=function(bz)bz:play(bu)end,eventHandler=function(bz,bA,bB)if bo then if bA=='timer'and bB==bh then if bm[bp]~=nil then bC(bz)else bz:animationDoneHandler()end end end end}aI.__index=aI;return aI end end;as['objects']['Button']=function(...)local bR=require'Object'local bS=require'utils'local bT=bS.getValueFromXML;local bU=require'tHex'return function(bV)local bW=bR(bV)local bX='Button'local bY='center'local bZ='center'bW:setZIndex(5)bW:setValue'Button'bW.width=12;bW.height=3;local b_={init=function(c0)if bW.init(c0)then c0.bgColor=c0.parent:getTheme'ButtonBG'c0.fgColor=c0.parent:getTheme'ButtonText'end end,getType=function(c0)return bX end,setHorizontalAlign=function(c0,c1)bY=c1;c0:updateDraw()return c0 end,setVerticalAlign=function(c0,c1)bZ=c1;c0:updateDraw()return c0 end,setText=function(c0,c1)bW:setValue(c1)c0:updateDraw()return c0 end,setValuesByXMLData=function(c0,c1)bW.setValuesByXMLData(c0,c1)if bT('text',c1)~=nil then c0:setText(bT('text',c1))end;if bT('horizontalAlign',c1)~=nil then bY=bT('horizontalAlign',c1)end;if bT('verticalAlign',c1)~=nil then bZ=bT('verticalAlign',c1)end;return c0 end,draw=function(c0)if bW.draw(c0)then if c0.parent~=nil then local c1,c2=c0:getAnchorPosition()local c3,c4=c0:getSize()local c5=bS.getTextVerticalAlign(c4,bZ)for bE=1,c4 do if bE==c5 then c0.parent:setText(c1,c2+bE-1,bS.getTextHorizontalAlign(c0:getValue(),c3,bY))c0.parent:setFG(c1,c2+bE-1,bS.getTextHorizontalAlign(bU[c0.fgColor]:rep(c0:getValue():len()),c3,bY))end end end end end}return setmetatable(b_,bW)end end;as['objects']['Checkbox']=function(...)local c6=require'Object'local bR=require'utils'local bS=bR.getValueFromXML;return function(bT)local bU=c6(bT)local bV='Checkbox'bU:setZIndex(5)bU:setValue(false)bU.width=1;bU.height=1;local bW='\42'local bX={getType=function(bY)return bV end,setSymbol=function(bY,bZ)bW=bZ;bY:updateDraw()return bY end,mouseHandler=function(bY,bZ,b_,c0)if bU.mouseHandler(bY,bZ,b_,c0)then if bZ==1 then if bY:getValue()~=true and bY:getValue()~=false then bY:setValue(false)else bY:setValue(not bY:getValue())end;bY:updateDraw()return true end end;return false end,touchHandler=function(bY,bZ,b_)return bY:mouseHandler(1,bZ,b_)end,setValuesByXMLData=function(bY,bZ)bU.setValuesByXMLData(bY,bZ)if bS('checked',bZ)~=nil then if bS('checked',bZ)then bY:setValue(true)else bY:setValue(false)end end;return bY end,draw=function(bY)if bU.draw(bY)then if bY.parent~=nil then local bZ,b_=bY:getAnchorPosition()local c0,c1=bY:getSize()local c2=bR.getTextVerticalAlign(c1,'center')if bY.bgColor~=false then bY.parent:drawBackgroundBox(bZ,b_,c0,c1,bY.bgColor)end;for bE=1,c1 do if bE==c2 then if bY:getValue()==true then bY.parent:writeText(bZ,b_+bE-1,bR.getTextHorizontalAlign(bW,c0,'center'),bY.bgColor,bY.fgColor)else bY.parent:writeText(bZ,b_+bE-1,bR.getTextHorizontalAlign(' ',c0,'center'),bY.bgColor,bY.fgColor)end end end end end end,init=function(bY)bY.parent:addEvent('mouse_click',bY)bY.parent:addEvent('mouse_up',bY)if bU.init(bY)then bY.bgColor=bY.parent:getTheme'CheckboxBG'bY.fgColor=bY.parent:getTheme'CheckboxText'end end}return setmetatable(bX,bU)end end;as['objects']['Dropdown']=function(...)local c6=require'Object'local bR=require'utils'local bS=require('utils').getValueFromXML;return function(bT)local bU=c6(bT)local bV='Dropdown'bU.width=12;bU.height=1;bU:setZIndex(6)local bW={}local bX;local bY;local bZ=true;local b_='left'local c0=0;local c1=16;local c2=6;local c3='\16'local c4='\31'local c5=false;local c7={getType=function(c8)return bV end,setValuesByXMLData=function(c8,c9)bU.setValuesByXMLData(c8,c9)if bS('selectionBG',c9)~=nil then bX=colors[bS('selectionBG',c9)]end;if bS('selectionFG',c9)~=nil then bY=colors[bS('selectionFG',c9)]end;if bS('dropdownWidth',c9)~=nil then c1=bS('dropdownWidth',c9)end;if bS('dropdownHeight',c9)~=nil then c2=bS('dropdownHeight',c9)end;if bS('offset',c9)~=nil then c0=bS('offset',c9)end;if c9['item']~=nil then local ca=c9['item']if ca.properties~=nil then ca={ca}end;for cb,cc in pairs(ca)do c8:addItem(bS('text',cc),colors[bS('bg',cc)],colors[bS('fg',cc)])end end end,setOffset=function(c8,c9)c0=c9;c8:updateDraw()return c8 end,getOffset=function(c8)return c0 end,addItem=function(c8,c9,ca,cb,...)table.insert(bW,{text=c9,bgCol=ca or c8.bgColor,fgCol=cb or c8.fgColor,args={...}})c8:updateDraw()return c8 end,getAll=function(c8)return bW end,removeItem=function(c8,c9)table.remove(bW,c9)c8:updateDraw()return c8 end,getItem=function(c8,c9)return bW[c9]end,getItemIndex=function(c8)local c9=c8:getValue()for ca,cb in pairs(bW)do if cb==c9 then return ca end end end,clear=function(c8)bW={}c8:setValue{}c8:updateDraw()return c8 end,getItemCount=function(c8)return#bW end,editItem=function(c8,c9,ca,cb,cc,...)table.remove(bW,c9)table.insert(bW,c9,{text=ca,bgCol=cb or c8.bgColor,fgCol=cc or c8.fgColor,args={...}})c8:updateDraw()return c8 end,selectItem=function(c8,c9)c8:setValue(bW[c9]or{})c8:updateDraw()return c8 end,setSelectedItem=function(c8,c9,ca,cb)bX=c9 or c8.bgColor;bY=ca or c8.fgColor;bZ=cb;c8:updateDraw()return c8 end,setDropdownSize=function(c8,c9,ca)c1,c2=c9,ca;c8:updateDraw()return c8 end,mouseHandler=function(c8,c9,ca,cb)if c5 then local cc,cd=c8:getAbsolutePosition(c8:getAnchorPosition())if c9==1 then if#bW>0 then for bE=1,c2 do if bW[bE+c0]~=nil then if cc<=ca and cc+c1>ca and cd+bE==cb then c8:setValue(bW[bE+c0])c8:updateDraw()local ce=c8:getEventSystem():sendEvent('mouse_click',c8,'mouse_click',dir,ca,cb)if ce==false then return ce end;return true end end end end end end;if bU.mouseHandler(c8,c9,ca,cb)then c5=not c5;c8:updateDraw()return true else if c5 then c8:updateDraw()c5=false end;return false end end,mouseUpHandler=function(c8,c9,ca,cb)if c5 then local cc,cd=c8:getAbsolutePosition(c8:getAnchorPosition())if c9==1 then if#bW>0 then for bE=1,c2 do if bW[bE+c0]~=nil then if cc<=ca and cc+c1>ca and cd+bE==cb then c5=false;c8:updateDraw()local ce=c8:getEventSystem():sendEvent('mouse_up',c8,'mouse_up',dir,ca,cb)if ce==false then return ce end;return true end end end end end end end,scrollHandler=function(c8,c9,ca,cb)if c5 and c8:isFocused()then c0=c0+c9;if c0<0 then c0=0 end;if c9==1 then if#bW>c2 then if c0>#bW-c2 then c0=#bW-c2 end else c0=math.min(#bW-1,0)end end;local cc=c8:getEventSystem():sendEvent('mouse_scroll',c8,'mouse_scroll',c9,ca,cb)if cc==false then return cc end;c8:updateDraw()return true end end,draw=function(c8)if bU.draw(c8)then local c9,ca=c8:getAnchorPosition()local cb,cc=c8:getSize()if c8.parent~=nil then if c8.bgColor~=false then c8.parent:drawBackgroundBox(c9,ca,cb,cc,c8.bgColor)end;local cd=c8:getValue()local ce=bR.getTextHorizontalAlign(cd~=nil and cd.text or'',cb,b_):sub(1,cb-1)..(c5 and c4 or c3)c8.parent:writeText(c9,ca,ce,c8.bgColor,c8.fgColor)if c5 then for bE=1,c2 do if bW[bE+c0]~=nil then if bW[bE+c0]==cd then if bZ then c8.parent:writeText(c9,ca+bE,bR.getTextHorizontalAlign(bW[bE+c0].text,c1,b_),bX,bY)else c8.parent:writeText(c9,ca+bE,bR.getTextHorizontalAlign(bW[bE+c0].text,c1,b_),bW[bE+c0].bgCol,bW[bE+c0].fgCol)end else c8.parent:writeText(c9,ca+bE,bR.getTextHorizontalAlign(bW[bE+c0].text,c1,b_),bW[bE+c0].bgCol,bW[bE+c0].fgCol)end end end end end end end,init=function(c8)c8.parent:addEvent('mouse_click',c8)c8.parent:addEvent('mouse_up',c8)c8.parent:addEvent('mouse_scroll',c8)if bU.init(c8)then c8.bgColor=c8.parent:getTheme'DropdownBG'c8.fgColor=c8.parent:getTheme'DropdownText'bX=c8.parent:getTheme'SelectionBG'bY=c8.parent:getTheme'SelectionText'end end}return setmetatable(c7,bU)end end;as['objects']['Image']=function(...)local cf=require'Object'local c6=require('utils').getValueFromXML;return function(bR)local bS=cf(bR)local bT='Image'bS:setZIndex(2)local bU;local bV;local bW=false;local function bX()local bZ={[0]={8,4,3,6,5},{4,14,8,7},{6,10,8,7},{9,11,8,0},{1,14,8,0},{13,12,8,0},{2,10,8,0},{15,8,10,11,12,14},{0,7,1,9,2,13},{3,11,8,7},{2,6,7,15},{9,3,7,15},{13,5,7,15},{5,12,8,7},{1,4,7,15},{7,10,11,12,14}}local b_,c0,c1={},{},{}for cg=0,15 do c0[2^cg]=cg end;do local c9='0123456789abcdef'for cg=1,16 do b_[c9:sub(cg,cg)]=cg-1;b_[cg-1]=c9:sub(cg,cg)c1[c9:sub(cg,cg)]=2^(cg-1)c1[2^(cg-1)]=c9:sub(cg,cg)local ca=bZ[cg-1]for cg=1,#ca do ca[cg]=2^ca[cg]end end end;local function c2(c9)local ca=bZ[c0[c9[#c9][1]]]for ch=1,#ca do local cb=ca[ch]for cg=1,#c9-1 do if c9[cg][1]==cb then return cg end end end;return 1 end;local function c3(c9,ca)if not ca then local cc={}ca={}for cg=1,6 do local cd=c9[cg]local ce=ca[cd]ca[cd],cc[cg]=ce and ce+1 or 1,cd end;c9=cc end;local cb={}for cc,cd in pairs(ca)do cb[#cb+1]={cc,cd}end;if#cb>1 then while#cb>2 do table.sort(cb,function(ci,cj)return ci[2]>cj[2]end)local cd,ce=c2(cb),#cb;local ck,cl=cb[ce][1],cb[cd][1]for cg=1,6 do if c9[cg]==ck then c9[cg]=cl;cb[cd][2]=cb[cd][2]+1 end end;cb[ce]=nil end;local cc=128;for cg=1,#c9-1 do if c9[cg]~=c9[6]then cc=cc+2^(cg-1)end end;return string.char(cc),c1[cb[1][1]==c9[6]and cb[2][1]or cb[1][1]],c1[c9[6]]else return'\128',c1[c9[1]],c1[c9[1]]end end;local c4,c5,c7,c8={{},{},{}},0,#bU+#bU%3,bS.bgColor or colors.black;for cg=1,#bU do if#bU[cg]>c5 then c5=#bU[cg]end end;for y=0,c7-1,3 do local c9,ca,cb,cc={},{},{},1;for x=0,c5-1,2 do local cd,ce={},{}for cm=1,3 do for cn=1,2 do cd[#cd+1]=bU[y+cm]and bU[y+cm][x+cn]and(bU[y+cm][x+cn]==0 and c8 or bU[y+cm][x+cn])or c8;ce[cd[#cd]]=ce[cd[#cd]]and ce[cd[#cd]]+1 or 1 end end;c9[cc],ca[cc],cb[cc]=c3(cd,ce)cc=cc+1 end;c4[1][#c4[1]+1],c4[2][#c4[2]+1],c4[3][#c4[3]+1]=table.concat(c9),table.concat(ca),table.concat(cb)end;c4.width,c4.height=#c4[1][1],#c4[1]bV=c4 end;local bY={init=function(bZ)bZ.bgColor=bZ.parent:getTheme'ImageBG'end,getType=function(bZ)return bT end,loadImage=function(bZ,b_)bU=paintutils.loadImage(b_)bW=false;bZ:updateDraw()return bZ end,shrink=function(bZ)bX()bW=true;bZ:updateDraw()return bZ end,setValuesByXMLData=function(bZ,b_)bS.setValuesByXMLData(bZ,b_)if c6('shrink',b_)~=nil then if c6('shrink',b_)then bZ:shrink()end end;if c6('path',b_)~=nil then bZ:loadImage(c6('path',b_))end;return bZ end,draw=function(bZ)if bS.draw(bZ)then if bZ.parent~=nil then if bU~=nil then local b_,c0=bZ:getAnchorPosition()local c1,c2=bZ:getSize()if bW then local c3,c4,c5=bV[1],bV[2],bV[3]for cg=1,bV.height do local c7=c3[cg]if type(c7)=='string'then bZ.parent:setText(b_,c0+cg-1,c7)bZ.parent:setFG(b_,c0+cg-1,c4[cg])bZ.parent:setBG(b_,c0+cg-1,c5[cg])elseif type(c7)=='table'then bZ.parent:setText(b_,c0+cg-1,c7[2])bZ.parent:setFG(b_,c0+cg-1,c4[cg])bZ.parent:setBG(b_,c0+cg-1,c5[cg])end end else for co=1,math.min(#bU,c2)do local c3=bU[co]for cp=1,math.min(#c3,c1)do if c3[cp]>0 then bZ.parent:drawBackgroundBox(b_+cp-1,c0+co-1,1,1,c3[cp])end end end end end end end end}return setmetatable(bY,bS)end end;as['objects']['Input']=function(...)local bR=require'Object'local bS=require'utils'local bT=require'basaltLogs'local bU=bS.getValueFromXML;return function(bV)local bW=bR(bV)local bX='Input'local bY='text'local bZ=0;bW:setZIndex(5)bW:setValue''bW.width=10;bW.height=1;local b_=1;local c0=1;local c1=''local c2;local c3;local c4=c1;local c5=false;local c7={getType=function(c8)return bX end,setInputType=function(c8,c9)if c9=='password'or c9=='number'or c9=='text'then bY=c9 end;c8:updateDraw()return c8 end,setDefaultText=function(c8,c9,ca,cb)c1=c9;c2=cb or c2;c3=ca or c3;if c8:isFocused()then c4=''else c4=c1 end;c8:updateDraw()return c8 end,getInputType=function(c8)return bY end,setValue=function(c8,c9)bW.setValue(c8,tostring(c9))if not c5 then if c8:isFocused()then b_=tostring(c9):len()+1;c0=math.max(1,b_-c8:getWidth()+1)local ca,cb=c8:getAnchorPosition()c8.parent:setCursor(true,ca+b_-c0,cb+math.floor(c8:getHeight()/2),c8.fgColor)end end;c8:updateDraw()return c8 end,getValue=function(c8)local c9=bW.getValue(c8)return bY=='number'and tonumber(c9)or c9 end,setInputLimit=function(c8,c9)bZ=tonumber(c9)or bZ;c8:updateDraw()return c8 end,getInputLimit=function(c8)return bZ end,setValuesByXMLData=function(c8,c9)bW.setValuesByXMLData(c8,c9)local ca,cb;if bU('defaultBG',c9)~=nil then ca=bU('defaultBG',c9)end;if bU('defaultFG',c9)~=nil then cb=bU('defaultFG',c9)end;if bU('default',c9)~=nil then c8:setDefaultText(bU('default',c9),cb~=nil and colors[cb],ca~=nil and colors[ca])end;if bU('limit',c9)~=nil then c8:setInputLimit(bU('limit',c9))end;if bU('type',c9)~=nil then c8:setInputType(bU('type',c9))end;return c8 end,getFocusHandler=function(c8)bW.getFocusHandler(c8)if c8.parent~=nil then local c9,ca=c8:getAnchorPosition()c4=''if c1~=''then c8:updateDraw()end;c8.parent:setCursor(true,c9+b_-c0,ca+math.max(math.ceil(c8:getHeight()/2-1,1)),c8.fgColor)end end,loseFocusHandler=function(c8)bW.loseFocusHandler(c8)if c8.parent~=nil then c4=c1;if c1~=''then c8:updateDraw()end;c8.parent:setCursor(false)end end,keyHandler=function(c8,c9)if bW.keyHandler(c8,c9)then local ca,cb=c8:getSize()c5=true;if c9==keys.backspace then local ci=tostring(bW.getValue())if b_>1 then c8:setValue(ci:sub(1,b_-2)..ci:sub(b_,ci:len()))if b_>1 then b_=b_-1 end;if c0>1 then if b_<c0 then c0=c0-1 end end end end;if c9==keys.enter then if c8.parent~=nil then end end;if c9==keys.right then local ci=tostring(bW.getValue()):len()b_=b_+1;if b_>ci then b_=ci+1 end;if b_<1 then b_=1 end;if b_<c0 or b_>=ca+c0 then c0=b_-ca+1 end;if c0<1 then c0=1 end end;if c9==keys.left then b_=b_-1;if b_>=1 then if b_<c0 or b_>=ca+c0 then c0=b_ end end;if b_<1 then b_=1 end;if c0<1 then c0=1 end end;local cc,cd=c8:getAnchorPosition()local ce=tostring(bW.getValue())local ck=(b_<=ce:len()and b_-1 or ce:len())-(c0-1)local cl=c8:getX()if ck>cl+ca-1 then ck=cl+ca-1 end;if c8.parent~=nil then c8.parent:setCursor(true,cc+ck,cd+math.max(math.ceil(cb/2-1,1)),c8.fgColor)end;c8:updateDraw()c5=false;return true end;return false end,charHandler=function(c8,c9)if bW.charHandler(c8,c9)then c5=true;local ca,cb=c8:getSize()local cc=bW.getValue()if cc:len()<bZ or bZ<=0 then if bY=='number'then local cj=cc;if#cc==0 and c9=='-'or c9=='.'or tonumber(c9)~=nil then c8:setValue(cc:sub(1,b_-1)..c9 ..cc:sub(b_,cc:len()))b_=b_+1 end;if tonumber(bW.getValue())==nil then end else c8:setValue(cc:sub(1,b_-1)..c9 ..cc:sub(b_,cc:len()))b_=b_+1 end;if b_>=ca+c0 then c0=c0+1 end end;local cd,ce=c8:getAnchorPosition()local ck=tostring(bW.getValue())local cl=(b_<=ck:len()and b_-1 or ck:len())-(c0-1)local ci=c8:getX()if cl>ci+ca-1 then cl=ci+ca-1 end;if c8.parent~=nil then c8.parent:setCursor(true,cd+cl,ce+math.max(math.ceil(cb/2-1,1)),c8.fgColor)end;c5=false;c8:updateDraw()return true end;return false end,mouseHandler=function(c8,c9,ca,cb)if bW.mouseHandler(c8,c9,ca,cb)then local cc,cd=c8:getAnchorPosition()local ce,ck=c8:getAbsolutePosition(cc,cd)local cl,ci=c8:getSize()b_=ca-ce+c0;local cj=bW.getValue()if b_>cj:len()then b_=cj:len()+1 end;if b_<c0 then c0=b_-1;if c0<1 then c0=1 end end;c8.parent:setCursor(true,cc+b_-c0,cd+math.max(math.ceil(ci/2-1,1)),c8.fgColor)return true end end,dragHandler=function(c8,c9,ca,cb,cc,cd)if c8:isFocused()then if c8:isCoordsInObject(ca,cb)then if bW.dragHandler(c8,c9,ca,cb,cc,cd)then return true end end;c8.parent:removeFocusedObject()end end,eventHandler=function(c8,c9,ca,cb,cc,cd)if bW.eventHandler(c8,c9,ca,cb,cc,cd)then if c9=='paste'then if c8:isFocused()then local ce=bW.getValue()local ck,cl=c8:getSize()c5=true;if bY=='number'then local cq=ce;if ca=='.'or tonumber(ca)~=nil then c8:setValue(ce:sub(1,b_-1)..ca..ce:sub(b_,ce:len()))b_=b_+ca:len()end;if tonumber(bW.getValue())==nil then c8:setValue(cq)end else c8:setValue(ce:sub(1,b_-1)..ca..ce:sub(b_,ce:len()))b_=b_+ca:len()end;if b_>=ck+c0 then c0=b_+1-ck end;local ci,cj=c8:getAnchorPosition()local cr=tostring(bW.getValue())local cs=(b_<=cr:len()and b_-1 or cr:len())-(c0-1)local ct=c8:getX()if cs>ct+ck-1 then cs=ct+ck-1 end;if c8.parent~=nil then c8.parent:setCursor(true,ci+cs,cj+math.max(math.ceil(cl/2-1,1)),c8.fgColor)end;c8:updateDraw()c5=false end end end end,draw=function(c8)if bW.draw(c8)then if c8.parent~=nil then local c9,ca=c8:getAnchorPosition()local cb,cc=c8:getSize()local cd=bS.getTextVerticalAlign(cc,'center')if c8.bgColor~=false then c8.parent:drawBackgroundBox(c9,ca,cb,cc,c8.bgColor)end;for bE=1,cc do if bE==cd then local ce=tostring(bW.getValue())local ck=c8.bgColor;local cl=c8.fgColor;local ci;if ce:len()<=0 then ci=c4;ck=c2 or ck;cl=c3 or cl end;ci=c4;if ce~=''then ci=ce end;ci=ci:sub(c0,cb+c0-1)local cj=cb-ci:len()if cj<0 then cj=0 end;if bY=='password'and ce~=''then ci=string.rep('*',ci:len())end;ci=ci..string.rep(c8.bgSymbol,cj)c8.parent:writeText(c9,ca+bE-1,ci,ck,cl)end end;if c8:isFocused()then c8.parent:setCursor(true,c9+b_-c0,ca+math.floor(c8:getHeight()/2),c8.fgColor)end end end end,init=function(c8)if c8.parent~=nil then c8.parent:addEvent('mouse_click',c8)c8.parent:addEvent('key',c8)c8.parent:addEvent('char',c8)c8.parent:addEvent('other_event',c8)c8.parent:addEvent('mouse_drag',c8)end;if bW.init(c8)then c8.bgColor=c8.parent:getTheme'InputBG'c8.fgColor=c8.parent:getTheme'InputText'end end}return setmetatable(c7,bW)end end;as['objects']['Label']=function(...)local bT=require'Object'local bU=require'utils'local bV=bU.getValueFromXML;local bW=bU.createText;local bX=require'tHex'local bY=require'bigfont'return function(bZ)local b_=bT(bZ)local c0='Label'b_:setZIndex(3)local c1=true;b_:setValue'Label'b_.width=5;local c2='left'local c3='top'local c4=0;local c5,c7=false,false;local c8={getType=function(c9)return c0 end,setText=function(c9,ca)ca=tostring(ca)b_:setValue(ca)if c1 then if ca:len()+c9:getX()>c9.parent:getWidth()then local cb=c9.parent:getWidth()-c9:getX()b_.setSize(c9,cb,#bW(ca,cb))else b_.setSize(c9,ca:len(),1)end end;c9:updateDraw()return c9 end,setBackground=function(c9,ca)b_.setBackground(c9,ca)c7=true;c9:updateDraw()return c9 end,setForeground=function(c9,ca)b_.setForeground(c9,ca)c5=true;c9:updateDraw()return c9 end,setTextAlign=function(c9,ca,cb)c2=ca or c2;c3=cb or c3;c9:updateDraw()return c9 end,setFontSize=function(c9,ca)if ca>0 and ca<=4 then c4=ca-1 or 0 end;c9:updateDraw()return c9 end,getFontSize=function(c9)return c4+1 end,setValuesByXMLData=function(c9,ca)b_.setValuesByXMLData(c9,ca)if bV('text',ca)~=nil then c9:setText(bV('text',ca))end;if bV('verticalAlign',ca)~=nil then c3=bV('verticalAlign',ca)end;if bV('horizontalAlign',ca)~=nil then c2=bV('horizontalAlign',ca)end;if bV('font',ca)~=nil then c9:setFontSize(bV('font',ca))end;return c9 end,setSize=function(c9,ca,cb,cc)b_.setSize(c9,ca,cb,cc)c1=false;c9:updateDraw()return c9 end,eventHandler=function(c9,ca)if ca=='basalt_resize'then if c1 then local cb=c9:getValue()if cb:len()+c9:getX()>c9.parent:getWidth()then local cc=c9.parent:getWidth()-c9:getX()b_.setSize(c9,cc,#bW(cb,cc))else b_.setSize(c9,cb:len(),1)end else end end end,draw=function(c9)if b_.draw(c9)then if c9.parent~=nil then local ca,cb=c9:getAnchorPosition()local cc,cd=c9:getSize()local ce=bU.getTextVerticalAlign(cd,c3)if c4==0 then if not c1 then local ck=bW(c9:getValue(),c9:getWidth())for cl,ci in pairs(ck)do if cl<=cd then c9.parent:writeText(ca,cb+cl-1,ci,c9.bgColor,c9.fgColor)end end else if#c9:getValue()+ca>c9.parent:getWidth()then local ck=bW(c9:getValue(),c9:getWidth())for cl,ci in pairs(ck)do if cl<=cd then c9.parent:writeText(ca,cb+cl-1,ci,c9.bgColor,c9.fgColor)end end else c9.parent:writeText(ca,cb,c9:getValue(),c9.bgColor,c9.fgColor)end end else local ck=bY(c4,c9:getValue(),c9.fgColor,c9.bgColor or colors.lightGray)if c1 then c9:setSize(#ck[1][1],#ck[1]-1)end;local cl,ci=c9.parent:getSize()local cj,cr=#ck[1][1],#ck[1]ca=ca or math.floor((cl-cj)/2)+1;cb=cb or math.floor((ci-cr)/2)+1;for cg=1,cr do c9.parent:setFG(ca,cb+cg-1,ck[2][cg])c9.parent:setBG(ca,cb+cg-1,ck[3][cg])c9.parent:setText(ca,cb+cg-1,ck[1][cg])end end end end end,init=function(c9)c9.parent:addEvent('other_event',c9)if b_.init(c9)then c9.bgColor=c9.parent:getTheme'LabelBG'c9.fgColor=c9.parent:getTheme'LabelText'if c9.parent.bgColor==colors.black and c9.fgColor==colors.black then c9.fgColor=colors.lightGray end end end}return setmetatable(c8,b_)end end;as['objects']['List']=function(...)local c6=require'Object'local bR=require'utils'local bS=bR.getValueFromXML;return function(bT)local bU=c6(bT)local bV='List'bU.width=16;bU.height=6;bU:setZIndex(5)local bW={}local bX;local bY;local bZ=true;local b_='left'local c0=0;local c1=true;local c2={getType=function(c3)return bV end,addItem=function(c3,c4,c5,c7,...)table.insert(bW,{text=c4,bgCol=c5 or c3.bgColor,fgCol=c7 or c3.fgColor,args={...}})if#bW==1 then c3:setValue(bW[1])end;c3:updateDraw()return c3 end,setOffset=function(c3,c4)c0=c4;c3:updateDraw()return c3 end,getOffset=function(c3)return c0 end,removeItem=function(c3,c4)table.remove(bW,c4)c3:updateDraw()return c3 end,getItem=function(c3,c4)return bW[c4]end,getAll=function(c3)return bW end,getItemIndex=function(c3)local c4=c3:getValue()for c5,c7 in pairs(bW)do if c7==c4 then return c5 end end end,clear=function(c3)bW={}c3:setValue{}c3:updateDraw()return c3 end,getItemCount=function(c3)return#bW end,editItem=function(c3,c4,c5,c7,c8,...)table.remove(bW,c4)table.insert(bW,c4,{text=c5,bgCol=c7 or c3.bgColor,fgCol=c8 or c3.fgColor,args={...}})c3:updateDraw()return c3 end,selectItem=function(c3,c4)c3:setValue(bW[c4]or{})c3:updateDraw()return c3 end,setSelectedItem=function(c3,c4,c5,c7)bX=c4 or c3.bgColor;bY=c5 or c3.fgColor;bZ=c7~=nil and c7 or true;c3:updateDraw()return c3 end,setScrollable=function(c3,c4)c1=c4;if c4==nil then c1=true end;c3:updateDraw()return c3 end,setValuesByXMLData=function(c3,c4)bU.setValuesByXMLData(c3,c4)if bS('selectionBG',c4)~=nil then bX=colors[bS('selectionBG',c4)]end;if bS('selectionFG',c4)~=nil then bY=colors[bS('selectionFG',c4)]end;if bS('scrollable',c4)~=nil then if bS('scrollable',c4)then c3:setScrollable(true)else c3:setScrollable(false)end end;if bS('offset',c4)~=nil then c0=bS('offset',c4)end;if c4['item']~=nil then local c5=c4['item']if c5.properties~=nil then c5={c5}end;for c7,c8 in pairs(c5)do c3:addItem(bS('text',c8),colors[bS('bg',c8)],colors[bS('fg',c8)])end end;return c3 end,scrollHandler=function(c3,c4,c5,c7)if bU.scrollHandler(c3,c4,c5,c7)then if c1 then local c8,c9=c3:getSize()c0=c0+c4;if c0<0 then c0=0 end;if c4>=1 then if#bW>c9 then if c0>#bW-c9 then c0=#bW-c9 end;if c0>=#bW then c0=#bW-1 end else c0=c0-1 end end;c3:updateDraw()end;return true end;return false end,mouseHandler=function(c3,c4,c5,c7)if bU.mouseHandler(c3,c4,c5,c7)then local c8,c9=c3:getAbsolutePosition(c3:getAnchorPosition())local ca,cb=c3:getSize()if#bW>0 then for bE=1,cb do if bW[bE+c0]~=nil then if c8<=c5 and c8+ca>c5 and c9+bE-1==c7 then c3:setValue(bW[bE+c0])c3:updateDraw()end end end end;return true end;return false end,dragHandler=function(c3,c4,c5,c7)return c3:mouseHandler(c4,c5,c7)end,touchHandler=function(c3,c4,c5)return c3:mouseHandler(1,c4,c5)end,draw=function(c3)if bU.draw(c3)then if c3.parent~=nil then local c4,c5=c3:getAnchorPosition()local c7,c8=c3:getSize()if c3.bgColor~=false then c3.parent:drawBackgroundBox(c4,c5,c7,c8,c3.bgColor)end;for bE=1,c8 do if bW[bE+c0]~=nil then if bW[bE+c0]==c3:getValue()then if bZ then c3.parent:writeText(c4,c5+bE-1,bR.getTextHorizontalAlign(bW[bE+c0].text,c7,b_),bX,bY)else c3.parent:writeText(c4,c5+bE-1,bR.getTextHorizontalAlign(bW[bE+c0].text,c7,b_),bW[bE+c0].bgCol,bW[bE+c0].fgCol)end else c3.parent:writeText(c4,c5+bE-1,bR.getTextHorizontalAlign(bW[bE+c0].text,c7,b_),bW[bE+c0].bgCol,bW[bE+c0].fgCol)end end end end end end,init=function(c3)c3.parent:addEvent('mouse_click',c3)c3.parent:addEvent('mouse_drag',c3)c3.parent:addEvent('mouse_scroll',c3)if bU.init(c3)then c3.bgColor=c3.parent:getTheme'ListBG'c3.fgColor=c3.parent:getTheme'ListText'bX=c3.parent:getTheme'SelectionBG'bY=c3.parent:getTheme'SelectionText'end end}return setmetatable(c2,bU)end end;as['objects']['Menubar']=function(...)local bR=require'Object'local bS=require'utils'local bT=bS.getValueFromXML;local bU=require'tHex'return function(bV)local bW=bR(bV)local bX='Menubar'local bY={}bW.width=30;bW.height=1;bW:setZIndex(5)local bZ={}local b_;local c0;local c1=true;local c2='left'local c3=0;local c4=1;local c5=false;local function c7()local c8=0;local c9=0;local ca=bY:getWidth()for bE=1,#bZ do if c9+bZ[bE].text:len()+c4*2>ca then if c9<ca then c8=c8+bZ[bE].text:len()+c4*2-(ca-c9)else c8=c8+bZ[bE].text:len()+c4*2 end end;c9=c9+bZ[bE].text:len()+c4*2 end;return c8 end;bY={getType=function(c8)return bX end,addItem=function(c8,c9,ca,cb,...)table.insert(bZ,{text=tostring(c9),bgCol=ca or c8.bgColor,fgCol=cb or c8.fgColor,args={...}})if#bZ==1 then c8:setValue(bZ[1])end;c8:updateDraw()return c8 end,getAll=function(c8)return bZ end,getItemIndex=function(c8)local c9=c8:getValue()for ca,cb in pairs(bZ)do if cb==c9 then return ca end end end,clear=function(c8)bZ={}c8:setValue{}c8:updateDraw()return c8 end,setSpace=function(c8,c9)c4=c9 or c4;c8:updateDraw()return c8 end,setOffset=function(c8,c9)c3=c9 or 0;if c3<0 then c3=0 end;local ca=c7()if c3>ca then c3=ca end;c8:updateDraw()return c8 end,getOffset=function(c8)return c3 end,setScrollable=function(c8,c9)c5=c9;if c9==nil then c5=true end;return c8 end,setValuesByXMLData=function(c8,c9)bW.setValuesByXMLData(c8,c9)if bT('selectionBG',c9)~=nil then b_=colors[bT('selectionBG',c9)]end;if bT('selectionFG',c9)~=nil then c0=colors[bT('selectionFG',c9)]end;if bT('scrollable',c9)~=nil then if bT('scrollable',c9)then c8:setScrollable(true)else c8:setScrollable(false)end end;if bT('offset',c9)~=nil then c8:setOffset(bT('offset',c9))end;if bT('space',c9)~=nil then c4=bT('space',c9)end;if c9['item']~=nil then local ca=c9['item']if ca.properties~=nil then ca={ca}end;for cb,cc in pairs(ca)do c8:addItem(bT('text',cc),colors[bT('bg',cc)],colors[bT('fg',cc)])end end;return c8 end,removeItem=function(c8,c9)table.remove(bZ,c9)c8:updateDraw()return c8 end,getItem=function(c8,c9)return bZ[c9]end,getItemCount=function(c8)return#bZ end,editItem=function(c8,c9,ca,cb,cc,...)table.remove(bZ,c9)table.insert(bZ,c9,{text=ca,bgCol=cb or c8.bgColor,fgCol=cc or c8.fgColor,args={...}})c8:updateDraw()return c8 end,selectItem=function(c8,c9)c8:setValue(bZ[c9]or{})c8:updateDraw()return c8 end,setSelectedItem=function(c8,c9,ca,cb)b_=c9 or c8.bgColor;c0=ca or c8.fgColor;c1=cb;c8:updateDraw()return c8 end,mouseHandler=function(c8,c9,ca,cb)if bW.mouseHandler(c8,c9,ca,cb)then local cc,cd=c8:getAbsolutePosition(c8:getAnchorPosition())local ce,ck=c8:getSize()local cl=0;for bE=1,#bZ do if bZ[bE]~=nil then if cc+cl<=ca+c3 and cc+cl+bZ[bE].text:len()+c4*2>ca+c3 and cd==cb then c8:setValue(bZ[bE])c8:getEventSystem():sendEvent(event,c8,event,0,ca,cb,bZ[bE])end;cl=cl+bZ[bE].text:len()+c4*2 end end;c8:updateDraw()return true end;return false end,scrollHandler=function(c8,c9,ca,cb)if bW.scrollHandler(c8,c9,ca,cb)then if c5 then c3=c3+c9;if c3<0 then c3=0 end;local cc=c7()if c3>cc then c3=cc end;c8:updateDraw()end;return true end;return false end,draw=function(c8)if bW.draw(c8)then if c8.parent~=nil then local c9,ca=c8:getAnchorPosition()local cb,cc=c8:getSize()if c8.bgColor~=false then c8.parent:drawBackgroundBox(c9,ca,cb,cc,c8.bgColor)end;local cd=''local ce=''local ck=''for cl,ci in pairs(bZ)do local cj=(' '):rep(c4)..ci.text..(' '):rep(c4)cd=cd..cj;if ci==c8:getValue()then ce=ce..bU[b_ or ci.bgCol or c8.bgColor]:rep(cj:len())ck=ck..bU[c0 or ci.FgCol or c8.fgColor]:rep(cj:len())else ce=ce..bU[ci.bgCol or c8.bgColor]:rep(cj:len())ck=ck..bU[ci.FgCol or c8.fgColor]:rep(cj:len())end end;c8.parent:setText(c9,ca,cd:sub(c3+1,cb+c3))c8.parent:setBG(c9,ca,ce:sub(c3+1,cb+c3))c8.parent:setFG(c9,ca,ck:sub(c3+1,cb+c3))end end end,init=function(c8)c8.parent:addEvent('mouse_click',c8)c8.parent:addEvent('mouse_scroll',c8)if bW.init(c8)then c8.bgColor=c8.parent:getTheme'MenubarBG'c8.fgColor=c8.parent:getTheme'MenubarText'b_=c8.parent:getTheme'SelectionBG'c0=c8.parent:getTheme'SelectionText'end end}return setmetatable(bY,bW)end end;as['objects']['Pane']=function(...)local cf=require'Object'local c6=require'basaltLogs'return function(bR)local bS=cf(bR)local bT='Pane'local bU={getType=function(bV)return bT end,setBackground=function(bV,bW,bX,bY)bS.setBackground(bV,bW,bX,bY)return bV end,init=function(bV)if bS.init(bV)then bV.bgColor=bV.parent:getTheme'PaneBG'bV.fgColor=bV.parent:getTheme'PaneBG'end end}return setmetatable(bU,bS)end end;as['objects']['Program']=function(...)local bS=require'Object'local bT=require'tHex'local bU=require'process'local bV=require('utils').getValueFromXML;local bW=string.sub;return function(bX,bY)local bZ=bS(bX)local b_='Program'bZ:setZIndex(5)local c0;local c1;local c2={}local function c3(cd,ce,ck,cl,ci)local cj,cr=1,1;local cs,ct=colors.black,colors.white;local cq=false;local cu=false;local cv={}local cw={}local cx={}local cy={}local cz;local cA={}for cg=0,15 do local aG=2^cg;cy[aG]={bY:getBasaltInstance().getBaseTerm().getPaletteColour(aG)}end;local function cB()cz=(' '):rep(ck)for bE=0,15 do local aG=2^bE;local aK=bT[aG]cA[aG]=aK:rep(ck)end end;local function cC()cB()local aG=cz;local aK=cA[colors.white]local aL=cA[colors.black]for bE=1,cl do cv[bE]=bW(cv[bE]==nil and aG or cv[bE]..aG:sub(1,ck-cv[bE]:len()),1,ck)cx[bE]=bW(cx[bE]==nil and aK or cx[bE]..aK:sub(1,ck-cx[bE]:len()),1,ck)cw[bE]=bW(cw[bE]==nil and aL or cw[bE]..aL:sub(1,ck-cw[bE]:len()),1,ck)end;bZ.updateDraw(bZ)end;cC()local function cD()if cj>=1 and cr>=1 and cj<=ck and cr<=cl then else end end;local function cE(aG,aK,aL)local aM=cj;local aN=aM+#aG-1;if cr>=1 and cr<=cl then if aM<=ck and aN>=1 then if aM==1 and aN==ck then cv[cr]=aG;cx[cr]=aK;cw[cr]=aL else local aO,aP,aQ;if aM<1 then local aX=1-aM+1;local aY=ck-aM+1;aO=bW(aG,aX,aY)aP=bW(aK,aX,aY)aQ=bW(aL,aX,aY)elseif aN>ck then local aX=ck-aM+1;aO=bW(aG,1,aX)aP=bW(aK,1,aX)aQ=bW(aL,1,aX)else aO=aG;aP=aK;aQ=aL end;local aR=cv[cr]local aS=cx[cr]local aT=cw[cr]local aU,aV,aW;if aM>1 then local aX=aM-1;aU=bW(aR,1,aX)..aO;aV=bW(aS,1,aX)..aP;aW=bW(aT,1,aX)..aQ else aU=aO;aV=aP;aW=aQ end;if aN<ck then local aX=aN+1;aU=aU..bW(aR,aX,ck)aV=aV..bW(aS,aX,ck)aW=aW..bW(aT,aX,ck)end;cv[cr]=aU;cx[cr]=aV;cw[cr]=aW end;c0:updateDraw()end;cj=aN+1;if cu then cD()end end end;local function ay(aG,aK,aL)if aL~=nil then local aM=cv[aK]if aM~=nil then cv[aK]=bW(aM:sub(1,aG-1)..aL..aM:sub(aG+aL:len(),ck),1,ck)end end;c0:updateDraw()end;local function az(aG,aK,aL)if aL~=nil then local aM=cw[aK]if aM~=nil then cw[aK]=bW(aM:sub(1,aG-1)..aL..aM:sub(aG+aL:len(),ck),1,ck)end end;c0:updateDraw()end;local function aA(aG,aK,aL)if aL~=nil then local aM=cx[aK]if aM~=nil then cx[aK]=bW(aM:sub(1,aG-1)..aL..aM:sub(aG+aL:len(),ck),1,ck)end end;c0:updateDraw()end;local aB=function(aG)if type(aG)~='number'then error('bad argument #1 (expected number, got '..type(aG)..')',2)elseif bT[aG]==nil then error('Invalid color (got '..aG..')',2)end;ct=aG end;local aC=function(aG)if type(aG)~='number'then error('bad argument #1 (expected number, got '..type(aG)..')',2)elseif bT[aG]==nil then error('Invalid color (got '..aG..')',2)end;cs=aG end;local aD=function(aG,aK,aL,aM)if type(aG)~='number'then error('bad argument #1 (expected number, got '..type(aG)..')',2)end;if bT[aG]==nil then error('Invalid color (got '..aG..')',2)end;local aN;if type(aK)=='number'and aL==nil and aM==nil then aN={colours.rgb8(aK)}cy[aG]=aN else if type(aK)~='number'then error('bad argument #2 (expected number, got '..type(aK)..')',2)end;if type(aL)~='number'then error('bad argument #3 (expected number, got '..type(aL)..')',2)end;if type(aM)~='number'then error('bad argument #4 (expected number, got '..type(aM)..')',2)end;aN=cy[aG]aN[1]=aK;aN[2]=aL;aN[3]=aM end end;local aE=function(aG)if type(aG)~='number'then error('bad argument #1 (expected number, got '..type(aG)..')',2)end;if bT[aG]==nil then error('Invalid color (got '..aG..')',2)end;local aK=cy[aG]return aK[1],aK[2],aK[3]end;local aF={setCursorPos=function(aG,aK)if type(aG)~='number'then error('bad argument #1 (expected number, got '..type(aG)..')',2)end;if type(aK)~='number'then error('bad argument #2 (expected number, got '..type(aK)..')',2)end;cj=math.floor(aG)cr=math.floor(aK)if cu then cD()end end,getCursorPos=function()return cj,cr end,setCursorBlink=function(aG)if type(aG)~='boolean'then error('bad argument #1 (expected boolean, got '..type(aG)..')',2)end;cq=aG end,getCursorBlink=function()return cq end,getPaletteColor=aE,getPaletteColour=aE,setBackgroundColor=aC,setBackgroundColour=aC,setTextColor=aB,setTextColour=aB,setPaletteColor=aD,setPaletteColour=aD,getBackgroundColor=function()return cs end,getBackgroundColour=function()return cs end,getSize=function()return ck,cl end,getTextColor=function()return ct end,getTextColour=function()return ct end,basalt_resize=function(aG,aK)ck,cl=aG,aK;cC()end,basalt_reposition=function(aG,aK)cd,ce=aG,aK end,basalt_setVisible=function(aG)cu=aG end,drawBackgroundBox=function(aG,aK,aL,aM,aN)for bE=1,aM do az(aG,aK+bE-1,bT[aN]:rep(aL))end end,drawForegroundBox=function(aG,aK,aL,aM,aN)for bE=1,aM do aA(aG,aK+bE-1,bT[aN]:rep(aL))end end,drawTextBox=function(aG,aK,aL,aM,aN)for bE=1,aM do ay(aG,aK+bE-1,aN:rep(aL))end end,writeText=function(aG,aK,aL,aM,aN)aM=aM or cs;aN=aN or ct;ay(cd,aK,aL)az(aG,aK,bT[aM]:rep(aL:len()))aA(aG,aK,bT[aN]:rep(aL:len()))end,basalt_update=function()if bY~=nil then for bE=1,cl do bY:setText(cd,ce+bE-1,cv[bE])bY:setBG(cd,ce+bE-1,cw[bE])bY:setFG(cd,ce+bE-1,cx[bE])end end end,scroll=function(aG)if type(aG)~='number'then error('bad argument #1 (expected number, got '..type(aG)..')',2)end;if aG~=0 then local aK=cz;local aL=cA[ct]local aM=cA[cs]for cF=1,cl do local aN=cF+aG;if aN>=1 and aN<=cl then cv[cF]=cv[aN]cw[cF]=cw[aN]cx[cF]=cx[aN]else cv[cF]=aK;cx[cF]=aL;cw[cF]=aM end end end;if cu then cD()end end,isColor=function()return bY:getBasaltInstance().getBaseTerm().isColor()end,isColour=function()return bY:getBasaltInstance().getBaseTerm().isColor()end,write=function(aG)aG=tostring(aG)if cu then cE(aG,bT[ct]:rep(aG:len()),bT[cs]:rep(aG:len()))end end,clearLine=function()if cu then ay(1,cr,(' '):rep(ck))az(1,cr,bT[cs]:rep(ck))aA(1,cr,bT[ct]:rep(ck))end;if cu then cD()end end,clear=function()for bE=1,cl do ay(1,bE,(' '):rep(ck))az(1,bE,bT[cs]:rep(ck))aA(1,bE,bT[ct]:rep(ck))end;if cu then cD()end end,blit=function(aG,aK,aL)if type(aG)~='string'then error('bad argument #1 (expected string, got '..type(aG)..')',2)end;if type(aK)~='string'then error('bad argument #2 (expected string, got '..type(aK)..')',2)end;if type(aL)~='string'then error('bad argument #3 (expected string, got '..type(aL)..')',2)end;if#aK~=#aG or#aL~=#aG then error('Arguments must be the same length',2)end;if cu then cE(aG,aK,aL)end end}return aF end;bZ.width=30;bZ.height=12;local c4=c3(1,1,bZ.width,bZ.height)local c5;local c7=false;local c8={}local function c9(cd)local ce,ck=c4.getCursorPos()local cl,ci=cd:getAnchorPosition()local cj,cr=cd:getSize()if cl+ce-1>=1 and cl+ce-1<=cl+cj-1 and ck+ci-1>=1 and ck+ci-1<=ci+cr-1 then cd.parent:setCursor(cd:isFocused()and c4.getCursorBlink(),cl+ce-1,ck+ci-1,c4.getTextColor())end end;local function ca(cd,ce,...)local ck,cl=c5:resume(ce,...)if ck==false and cl~=nil and cl~='Terminated'then local ci=cd:sendEvent('program_error',cl)if ci~=false then error('Basalt Program - '..cl)end end;if c5:getStatus()=='dead'then cd:sendEvent'program_done'end end;local function cb(cd,ce,ck,cl,ci)if c5==nil then return false end;if not c5:isDead()then if not c7 then local cj,cr=cd:getAbsolutePosition(cd:getAnchorPosition(nil,nil,true))ca(cd,ce,ck,cl-cj+1,ci-cr+1)c9(cd)end end end;local function cc(cd,ce,ck,cl)if c5==nil then return false end;if not c5:isDead()then if not c7 then if cd.draw then ca(cd,ce,ck,cl)c9(cd)end end end end;c0={getType=function(cd)return b_ end,show=function(cd)bZ.show(cd)c4.setBackgroundColor(cd.bgColor)c4.setTextColor(cd.fgColor)c4.basalt_setVisible(true)return cd end,hide=function(cd)bZ.hide(cd)c4.basalt_setVisible(false)return cd end,setPosition=function(cd,ce,ck,cl)bZ.setPosition(cd,ce,ck,cl)c4.basalt_reposition(cd:getAnchorPosition())return cd end,setValuesByXMLData=function(cd,ce)bZ.setValuesByXMLData(cd,ce)if bV('path',ce)~=nil then c1=bV('path',ce)end;if bV('execute',ce)~=nil then if bV('execute',ce)then if c1~=nil then cd:execute(c1)end end end end,getBasaltWindow=function()return c4 end,getBasaltProcess=function()return c5 end,setSize=function(cd,ce,ck,cl)bZ.setSize(cd,ce,ck,cl)c4.basalt_resize(cd:getWidth(),cd:getHeight())return cd end,getStatus=function(cd)if c5~=nil then return c5:getStatus()end;return'inactive'end,setEnviroment=function(cd,ce)c2=ce or{}return cd end,execute=function(cd,ce,...)c1=ce or c1;c5=bU:new(c1,c4,c2,...)c4.setBackgroundColor(colors.black)c4.setTextColor(colors.white)c4.clear()c4.setCursorPos(1,1)c4.setBackgroundColor(cd.bgColor)c4.setTextColor(cd.fgColor)c4.basalt_setVisible(true)ca(cd)c7=false;if cd.parent~=nil then cd.parent:addEvent('mouse_click',cd)cd.parent:addEvent('mouse_up',cd)cd.parent:addEvent('mouse_drag',cd)cd.parent:addEvent('mouse_scroll',cd)cd.parent:addEvent('key',cd)cd.parent:addEvent('key_up',cd)cd.parent:addEvent('char',cd)cd.parent:addEvent('other_event',cd)end;return cd end,stop=function(cd)if c5~=nil then if not c5:isDead()then ca(cd,'terminate')if c5:isDead()then if cd.parent~=nil then cd.parent:setCursor(false)end end end end;cd.parent:removeEvents(cd)return cd end,pause=function(cd,ce)c7=ce or not c7;if c5~=nil then if not c5:isDead()then if not c7 then cd:injectEvents(c8)c8={}end end end;return cd end,isPaused=function(cd)return c7 end,injectEvent=function(cd,ce,ck,cl,ci,cj,cr)if c5~=nil then if not c5:isDead()then if c7==false or cr then ca(cd,ce,ck,cl,ci,cj)else table.insert(c8,{event=ce,args={ck,cl,ci,cj}})end end end;return cd end,getQueuedEvents=function(cd)return c8 end,updateQueuedEvents=function(cd,ce)c8=ce or c8;return cd end,injectEvents=function(cd,ce)if c5~=nil then if not c5:isDead()then for ck,cl in pairs(ce)do ca(cd,cl.event,table.unpack(cl.args))end end end;return cd end,mouseHandler=function(cd,ce,ck,cl)if bZ.mouseHandler(cd,ce,ck,cl)then cb(cd,'mouse_click',ce,ck,cl)return true end;return false end,mouseUpHandler=function(cd,ce,ck,cl)if bZ.mouseUpHandler(cd,ce,ck,cl)then cb(cd,'mouse_up',ce,ck,cl)return true end;return false end,scrollHandler=function(cd,ce,ck,cl)if bZ.scrollHandler(cd,ce,ck,cl)then cb(cd,'mouse_scroll',ce,ck,cl)return true end;return false end,dragHandler=function(cd,ce,ck,cl)if bZ.dragHandler(cd,ce,ck,cl)then cb(cd,'mouse_drag',ce,ck,cl)return true end;return false end,keyHandler=function(cd,ce,ck)if bZ.keyHandler(cd,ce,ck)then cc(cd,'key',ce,ck)return true end;return false end,keyUpHandler=function(cd,ce)if bZ.keyUpHandler(cd,ce)then cc(cd,'key_up',ce)return true end;return false end,charHandler=function(cd,ce)if bZ.charHandler(cd,ce)then cc(cd,'char',ce)return true end;return false end,getFocusHandler=function(cd)bZ.getFocusHandler(cd)if c5~=nil then if not c5:isDead()then if not c7 then if cd.parent~=nil then local ce,ck=c4.getCursorPos()local cl,ci=cd:getAnchorPosition()local cj,cr=cd:getSize()if cl+ce-1>=1 and cl+ce-1<=cl+cj-1 and ck+ci-1>=1 and ck+ci-1<=ci+cr-1 then cd.parent:setCursor(c4.getCursorBlink(),cl+ce-1,ck+ci-1,c4.getTextColor())end end end end end end,loseFocusHandler=function(cd)bZ.loseFocusHandler(cd)if c5~=nil then if not c5:isDead()then if cd.parent~=nil then cd.parent:setCursor(false)end end end end,eventHandler=function(cd,ce,ck,cl,ci,cj)if bZ.eventHandler(cd,ce,ck,cl,ci,cj)then if c5==nil then return end;if ce=='dynamicValueEvent'then local cr,cs=c4.getSize()local ct,cq=cd:getSize()if cr~=ct or cs~=cq then c4.basalt_resize(ct,cq)if not c5:isDead()then ca(cd,'term_resize')end end;c4.basalt_reposition(cd:getAnchorPosition())end;if not c5:isDead()then if not c7 then if ce~='terminate'then ca(cd,ce,ck,cl,ci,cj)end;if cd:isFocused()then local cr,cs=cd:getAnchorPosition()local ct,cq=c4.getCursorPos()if cd.parent~=nil then local cu,cv=cd:getSize()if cr+ct-1>=1 and cr+ct-1<=cr+cu-1 and cq+cs-1>=1 and cq+cs-1<=cs+cv-1 then cd.parent:setCursor(c4.getCursorBlink(),cr+ct-1,cq+cs-1,c4.getTextColor())end end;if ce=='terminate'then ca(cd,ce)cd.parent:setCursor(false)return true end end else table.insert(c8,{event=ce,args={ck,cl,ci,cj}})end end;return false end end,draw=function(cd)if bZ.draw(cd)then if cd.parent~=nil then local ce,ck=cd:getAnchorPosition()local cl,ci=c4.getCursorPos()local cj,cr=cd:getSize()c4.basalt_reposition(ce,ck)c4.basalt_update()if ce+cl-1>=1 and ce+cl-1<=ce+cj-1 and ci+ck-1>=1 and ci+ck-1<=ck+cr-1 then cd.parent:setCursor(cd:isFocused()and c4.getCursorBlink(),ce+cl-1,ci+ck-1,c4.getTextColor())end end end end,onError=function(cd,...)for ce,ck in pairs(table.pack(...))do if type(ck)=='function'then cd:registerEvent('program_error',ck)end end;if cd.parent~=nil then cd.parent:addEvent('other_event',cd)end;return cd end,onDone=function(cd,...)for ce,ck in pairs(table.pack(...))do if type(ck)=='function'then cd:registerEvent('program_done',ck)end end;if cd.parent~=nil then cd.parent:addEvent('other_event',cd)end;return cd end,init=function(cd)if bZ.init(cd)then pcall(function()elf.bgColor=cd.parent:getTheme'ProgramBG'end)end end}return setmetatable(c0,bZ)end end;as['objects']['Progressbar']=function(...)local cf=require'Object'local c6=require('utils').getValueFromXML;return function(bR)local bS=cf(bR)local bT='Progressbar'local bU=0;bS:setZIndex(5)bS:setValue(false)bS.width=25;bS.height=1;local bV;local bW=''local bX=colors.white;local bY=''local bZ=0;local b_={init=function(c0)if bS.init(c0)then c0.bgColor=c0.parent:getTheme'ProgressbarBG'c0.fgColor=c0.parent:getTheme'ProgressbarText'bV=c0.parent:getTheme'ProgressbarActiveBG'end end,getType=function(c0)return bT end,setValuesByXMLData=function(c0,c1)bS.setValuesByXMLData(c0,c1)if c6('direction',c1)~=nil then bZ=c6('direction',c1)end;if c6('progressColor',c1)~=nil then bV=colors[c6('progressColor',c1)]end;if c6('progressSymbol',c1)~=nil then bW=c6('progressSymbol',c1)end;if c6('backgroundSymbol',c1)~=nil then bY=c6('backgroundSymbol',c1)end;if c6('progressSymbolColor',c1)~=nil then bX=colors[c6('progressSymbolColor',c1)]end;if c6('onDone',c1)~=nil then c0:generateXMLEventFunction(c0.onProgressDone,c6('onDone',c1))end;return c0 end,setDirection=function(c0,c1)bZ=c1;c0:updateDraw()return c0 end,setProgressBar=function(c0,c1,c2,c3)bV=c1 or bV;bW=c2 or bW;bX=c3 or bX;c0:updateDraw()return c0 end,setBackgroundSymbol=function(c0,c1)bY=c1:sub(1,1)c0:updateDraw()return c0 end,setProgress=function(c0,c1)if c1>=0 and c1<=100 and bU~=c1 then bU=c1;c0:setValue(bU)if bU==100 then c0:progressDoneHandler()end end;c0:updateDraw()return c0 end,getProgress=function(c0)return bU end,onProgressDone=function(c0,c1)c0:registerEvent('progress_done',c1)return c0 end,progressDoneHandler=function(c0)c0:sendEvent('progress_done',c0)end,draw=function(c0)if bS.draw(c0)then if c0.parent~=nil then local c1,c2=c0:getAnchorPosition()local c3,c4=c0:getSize()if c0.bgColor~=false then c0.parent:drawBackgroundBox(c1,c2,c3,c4,c0.bgColor)end;if bY~=''then c0.parent:drawTextBox(c1,c2,c3,c4,bY)end;if c0.fgColor~=false then c0.parent:drawForegroundBox(c1,c2,c3,c4,c0.fgColor)end;if bZ==1 then c0.parent:drawBackgroundBox(c1,c2,c3,c4/100*bU,bV)c0.parent:drawForegroundBox(c1,c2,c3,c4/100*bU,bX)c0.parent:drawTextBox(c1,c2,c3,c4/100*bU,bW)elseif bZ==2 then c0.parent:drawBackgroundBox(c1,c2+math.ceil(c4-c4/100*bU),c3,c4/100*bU,bV)c0.parent:drawForegroundBox(c1,c2+math.ceil(c4-c4/100*bU),c3,c4/100*bU,bX)c0.parent:drawTextBox(c1,c2+math.ceil(c4-c4/100*bU),c3,c4/100*bU,bW)elseif bZ==3 then c0.parent:drawBackgroundBox(c1+math.ceil(c3-c3/100*bU),c2,c3/100*bU,c4,bV)c0.parent:drawForegroundBox(c1+math.ceil(c3-c3/100*bU),c2,c3/100*bU,c4,bX)c0.parent:drawTextBox(c1+math.ceil(c3-c3/100*bU),c2,c3/100*bU,c4,bW)else c0.parent:drawBackgroundBox(c1,c2,c3/100*bU,c4,bV)c0.parent:drawForegroundBox(c1,c2,c3/100*bU,c4,bX)c0.parent:drawTextBox(c1,c2,c3/100*bU,c4,bW)end end end end}return setmetatable(b_,bS)end end;as['objects']['Radio']=function(...)local c6=require'Object'local bR=require'utils'local bS=bR.getValueFromXML;return function(bT)local bU=c6(bT)local bV='Radio'bU.width=8;bU:setZIndex(5)local bW={}local bX;local bY;local bZ;local b_;local c0;local c1;local c2=true;local c3='\7'local c4='left'local c5={getType=function(c7)return bV end,setValuesByXMLData=function(c7,c8)bU.setValuesByXMLData(c7,c8)if bS('selectionBG',c8)~=nil then bX=colors[bS('selectionBG',c8)]end;if bS('selectionFG',c8)~=nil then bY=colors[bS('selectionFG',c8)]end;if bS('boxBG',c8)~=nil then bZ=colors[bS('boxBG',c8)]end;if bS('inactiveBoxBG',c8)~=nil then c0=colors[bS('inactiveBoxBG',c8)]end;if bS('inactiveBoxFG',c8)~=nil then c1=colors[bS('inactiveBoxFG',c8)]end;if bS('boxFG',c8)~=nil then b_=colors[bS('boxFG',c8)]end;if bS('symbol',c8)~=nil then c3=bS('symbol',c8)end;if c8['item']~=nil then local c9=c8['item']if c9.properties~=nil then c9={c9}end;for ca,cb in pairs(c9)do c7:addItem(bS('text',cb),bS('x',cb),bS('y',cb),colors[bS('bg',cb)],colors[bS('fg',cb)])end end;return c7 end,addItem=function(c7,c8,c9,ca,cb,cc,...)table.insert(bW,{x=c9 or 1,y=ca or 1,text=c8,bgCol=cb or c7.bgColor,fgCol=cc or c7.fgColor,args={...}})if#bW==1 then c7:setValue(bW[1])end;c7:updateDraw()return c7 end,getAll=function(c7)return bW end,removeItem=function(c7,c8)table.remove(bW,c8)c7:updateDraw()return c7 end,getItem=function(c7,c8)return bW[c8]end,getItemIndex=function(c7)local c8=c7:getValue()for c9,ca in pairs(bW)do if ca==c8 then return c9 end end end,clear=function(c7)bW={}c7:setValue{}c7:updateDraw()return c7 end,getItemCount=function(c7)return#bW end,editItem=function(c7,c8,c9,ca,cb,cc,cd,...)table.remove(bW,c8)table.insert(bW,c8,{x=ca or 1,y=cb or 1,text=c9,bgCol=cc or c7.bgColor,fgCol=cd or c7.fgColor,args={...}})c7:updateDraw()return c7 end,selectItem=function(c7,c8)c7:setValue(bW[c8]or{})c7:updateDraw()return c7 end,setActiveSymbol=function(c7,c8)c3=c8:sub(1,1)c7:updateDraw()return c7 end,setSelectedItem=function(c7,c8,c9,ca,cb,cc)bX=c8 or bX;bY=c9 or bY;bZ=ca or bZ;b_=cb or b_;c2=cc~=nil and cc or true;c7:updateDraw()return c7 end,mouseHandler=function(c7,c8,c9,ca)if#bW>0 then local cb,cc=c7:getAbsolutePosition(c7:getAnchorPosition())for cd,ce in pairs(bW)do if cb+ce.x-1<=c9 and cb+ce.x-1+ce.text:len()+1>=c9 and cc+ce.y-1==ca then c7:setValue(ce)local ck=c7:getEventSystem():sendEvent('mouse_click',c7,'mouse_click',c8,c9,ca)if ck==false then return ck end;if c7.parent~=nil then c7.parent:setFocusedObject(c7)end;c7:updateDraw()return true end end end;return false end,draw=function(c7)if c7.parent~=nil then local c8,c9=c7:getAnchorPosition()for ca,cb in pairs(bW)do if cb==c7:getValue()then if c4=='left'then c7.parent:writeText(cb.x+c8-1,cb.y+c9-1,c3,bZ,b_)c7.parent:writeText(cb.x+2+c8-1,cb.y+c9-1,cb.text,bX,bY)end else c7.parent:drawBackgroundBox(cb.x+c8-1,cb.y+c9-1,1,1,c0 or c7.bgColor)c7.parent:writeText(cb.x+2+c8-1,cb.y+c9-1,cb.text,cb.bgCol,cb.fgCol)end end;return true end end,init=function(c7)c7.parent:addEvent('mouse_click',c7)if bU.init(c7)then c7.bgColor=c7.parent:getTheme'MenubarBG'c7.fgColor=c7.parent:getTheme'MenubarFG'bX=c7.parent:getTheme'SelectionBG'bY=c7.parent:getTheme'SelectionText'bZ=c7.parent:getTheme'MenubarBG'b_=c7.parent:getTheme'MenubarText'end end}return setmetatable(c5,bU)end end;as['objects']['Scrollbar']=function(...)local cf=require'Object'local c6=require('utils').getValueFromXML;return function(bR)local bS=cf(bR)local bT='Scrollbar'bS.width=1;bS.height=8;bS:setValue(1)bS:setZIndex(2)local bU='vertical'local bV=' 'local bW;local bX='\127'local bY=bS.height;local bZ=1;local b_=1;local function c0(c2,c3,c4,c5)local c7,c8=c2:getAbsolutePosition(c2:getAnchorPosition())local c9,ca=c2:getSize()if bU=='horizontal'then for cG=0,c9 do if c7+cG==c4 and c8<=c5 and c8+ca>c5 then bZ=math.min(cG+1,c9-(b_-1))c2:setValue(bY/c9*bZ)c2:updateDraw()end end end;if bU=='vertical'then for cG=0,ca do if c8+cG==c5 and c7<=c4 and c7+c9>c4 then bZ=math.min(cG+1,ca-(b_-1))c2:setValue(bY/ca*bZ)c2:updateDraw()end end end end;local c1={getType=function(c2)return bT end,setSymbol=function(c2,c3)bV=c3:sub(1,1)c2:updateDraw()return c2 end,setValuesByXMLData=function(c2,c3)bS.setValuesByXMLData(c2,c3)if c6('maxValue',c3)~=nil then bY=c6('maxValue',c3)end;if c6('backgroundSymbol',c3)~=nil then bX=c6('backgroundSymbol',c3):sub(1,1)end;if c6('symbol',c3)~=nil then bV=c6('symbol',c3):sub(1,1)end;if c6('barType',c3)~=nil then bU=c6('barType',c3):lower()end;if c6('symbolSize',c3)~=nil then c2:setSymbolSize(c6('symbolSize',c3))end;if c6('symbolColor',c3)~=nil then bW=colors[c6('symbolColor',c3)]end;if c6('index',c3)~=nil then c2:setIndex(c6('index',c3))end end,setIndex=function(c2,c3)bZ=c3;if bZ<1 then bZ=1 end;local c4,c5=c2:getSize()bZ=math.min(bZ,(bU=='vertical'and c5 or c4)-(b_-1))c2:setValue(bY/(bU=='vertical'and c5 or c4)*bZ)c2:updateDraw()return c2 end,getIndex=function(c2)return bZ end,setSymbolSize=function(c2,c3)b_=tonumber(c3)or 1;local c4,c5=c2:getSize()if bU=='vertical'then c2:setValue(bZ-1*bY/(c5-(b_-1))-bY/(c5-(b_-1)))elseif bU=='horizontal'then c2:setValue(bZ-1*bY/(c4-(b_-1))-bY/(c4-(b_-1)))end;c2:updateDraw()return c2 end,setMaxValue=function(c2,c3)bY=c3;c2:updateDraw()return c2 end,setBackgroundSymbol=function(c2,c3)bX=string.sub(c3,1,1)c2:updateDraw()return c2 end,setSymbolColor=function(c2,c3)bW=c3;c2:updateDraw()return c2 end,setBarType=function(c2,c3)bU=c3:lower()c2:updateDraw()return c2 end,mouseHandler=function(c2,c3,c4,c5)if bS.mouseHandler(c2,c3,c4,c5)then c0(c2,c3,c4,c5)return true end;return false end,dragHandler=function(c2,c3,c4,c5)if bS.dragHandler(c2,c3,c4,c5)then c0(c2,c3,c4,c5)return true end;return false end,scrollHandler=function(c2,c3,c4,c5)if bS.scrollHandler(c2,c3,c4,c5)then local c7,c8=c2:getSize()bZ=bZ+c3;if bZ<1 then bZ=1 end;bZ=math.min(bZ,(bU=='vertical'and c8 or c7)-(b_-1))c2:setValue(bY/(bU=='vertical'and c8 or c7)*bZ)c2:updateDraw()end end,draw=function(c2)if bS.draw(c2)then if c2.parent~=nil then local c3,c4=c2:getAnchorPosition()local c5,c7=c2:getSize()if bU=='horizontal'then c2.parent:writeText(c3,c4,bX:rep(bZ-1),c2.bgColor,c2.fgColor)c2.parent:writeText(c3+bZ-1,c4,bV:rep(b_),bW,bW)c2.parent:writeText(c3+bZ+b_-1,c4,bX:rep(c5-(bZ+b_-1)),c2.bgColor,c2.fgColor)end;if bU=='vertical'then for bE=0,c7-1 do if bZ==bE+1 then for cH=0,math.min(b_-1,c7)do c2.parent:writeText(c3,c4+bE+cH,bV,bW,bW)end else if bE+1<bZ or bE+1>bZ-1+b_ then c2.parent:writeText(c3,c4+bE,bX,c2.bgColor,c2.fgColor)end end end end end end end,init=function(c2)c2.parent:addEvent('mouse_click',c2)c2.parent:addEvent('mouse_drag',c2)c2.parent:addEvent('mouse_scroll',c2)if bS.init(c2)then c2.bgColor=c2.parent:getTheme'ScrollbarBG'c2.fgColor=c2.parent:getTheme'ScrollbarText'bW=c2.parent:getTheme'ScrollbarSymbolColor'end end}return setmetatable(c1,bS)end end;as['objects']['Slider']=function(...)local c6=require'Object'local bR=require'basaltLogs'local bS=require('utils').getValueFromXML;return function(bT)local bU=c6(bT)local bV='Slider'bU.width=8;bU.height=1;bU:setValue(1)local bW='horizontal'local bX=' 'local bY;local bZ='\140'local b_=bU.width;local c0=1;local c1=1;local function c2(c4,c5,c7,c8)local c9,ca=c4:getAbsolutePosition(c4:getAnchorPosition())local cb,cc=c4:getSize()if bW=='horizontal'then for cG=0,cb do if c9+cG==c7 and ca<=c8 and ca+cc>c8 then c0=math.min(cG+1,cb-(c1-1))c4:setValue(b_/cb*c0)c4:updateDraw()end end end;if bW=='vertical'then for cG=0,cc do if ca+cG==c8 and c9<=c7 and c9+cb>c7 then c0=math.min(cG+1,cc-(c1-1))c4:setValue(b_/cc*c0)c4:updateDraw()end end end end;local c3={getType=function(c4)return bV end,setSymbol=function(c4,c5)bX=c5:sub(1,1)c4:updateDraw()return c4 end,setValuesByXMLData=function(c4,c5)bU.setValuesByXMLData(c4,c5)if bS('maxValue',c5)~=nil then b_=bS('maxValue',c5)end;if bS('backgroundSymbol',c5)~=nil then bZ=bS('backgroundSymbol',c5):sub(1,1)end;if bS('barType',c5)~=nil then bW=bS('barType',c5):lower()end;if bS('symbol',c5)~=nil then bX=bS('symbol',c5):sub(1,1)end;if bS('symbolSize',c5)~=nil then c4:setSymbolSize(bS('symbolSize',c5))end;if bS('symbolColor',c5)~=nil then bY=colors[bS('symbolColor',c5)]end;if bS('index',c5)~=nil then c4:setIndex(bS('index',c5))end end,setIndex=function(c4,c5)c0=c5;if c0<1 then c0=1 end;local c7,c8=c4:getSize()c0=math.min(c0,(bW=='vertical'and c8 or c7)-(c1-1))c4:setValue(b_/(bW=='vertical'and c8 or c7)*c0)c4:updateDraw()return c4 end,getIndex=function(c4)return c0 end,setSymbolSize=function(c4,c5)c1=tonumber(c5)or 1;if bW=='vertical'then c4:setValue(c0-1*b_/(h-(c1-1))-b_/(h-(c1-1)))elseif bW=='horizontal'then c4:setValue(c0-1*b_/(w-(c1-1))-b_/(w-(c1-1)))end;c4:updateDraw()return c4 end,setMaxValue=function(c4,c5)b_=c5;return c4 end,setBackgroundSymbol=function(c4,c5)bZ=string.sub(c5,1,1)c4:updateDraw()return c4 end,setSymbolColor=function(c4,c5)bY=c5;c4:updateDraw()return c4 end,setBarType=function(c4,c5)bW=c5:lower()c4:updateDraw()return c4 end,mouseHandler=function(c4,c5,c7,c8)if bU.mouseHandler(c4,c5,c7,c8)then c2(c4,c5,c7,c8)return true end;return false end,dragHandler=function(c4,c5,c7,c8)if bU.dragHandler(c4,c5,c7,c8)then c2(c4,c5,c7,c8)return true end;return false end,scrollHandler=function(c4,c5,c7,c8)if bU.scrollHandler(c4,c5,c7,c8)then local c9,ca=c4:getSize()c0=c0+c5;if c0<1 then c0=1 end;c0=math.min(c0,(bW=='vertical'and ca or c9)-(c1-1))c4:setValue(b_/(bW=='vertical'and ca or c9)*c0)c4:updateDraw()return true end;return false end,draw=function(c4)if bU.draw(c4)then if c4.parent~=nil then local c5,c7=c4:getAnchorPosition()local c8,c9=c4:getSize()if bW=='horizontal'then c4.parent:writeText(c5,c7,bZ:rep(c0-1),c4.bgColor,c4.fgColor)c4.parent:writeText(c5+c0-1,c7,bX:rep(c1),bY,bY)c4.parent:writeText(c5+c0+c1-1,c7,bZ:rep(c8-(c0+c1-1)),c4.bgColor,c4.fgColor)end;if bW=='vertical'then for bE=0,c9-1 do if c0==bE+1 then for cH=0,math.min(c1-1,c9)do c4.parent:writeText(c5,c7+bE+cH,bX,bY,bY)end else if bE+1<c0 or bE+1>c0-1+c1 then c4.parent:writeText(c5,c7+bE,bZ,c4.bgColor,c4.fgColor)end end end end end end end,init=function(c4)c4.parent:addEvent('mouse_click',c4)c4.parent:addEvent('mouse_drag',c4)c4.parent:addEvent('mouse_scroll',c4)if bU.init(c4)then c4.bgColor=c4.parent:getTheme'SliderBG'c4.fgColor=c4.parent:getTheme'SliderText'bY=c4.parent:getTheme'SliderSymbolColor'end end}return setmetatable(c3,bU)end end;as['objects']['Switch']=function(...)local cf=require'Object'local c6=require('utils').getValueFromXML;return function(bR)local bS=cf(bR)local bT='Switch'bS.width=2;bS.height=1;bS.bgColor=colors.lightGray;bS.fgColor=colors.gray;bS:setValue(false)bS:setZIndex(5)local bU=colors.black;local bV=colors.red;local bW=colors.green;local bX={getType=function(bY)return bT end,setSymbolColor=function(bY,bZ)bU=bZ;bY:updateDraw()return bY end,setActiveBackground=function(bY,bZ)bW=bZ;bY:updateDraw()return bY end,setInactiveBackground=function(bY,bZ)bV=bZ;bY:updateDraw()return bY end,setValuesByXMLData=function(bY,bZ)bS.setValuesByXMLData(bY,bZ)if c6('inactiveBG',bZ)~=nil then bV=colors[c6('inactiveBG',bZ)]end;if c6('activeBG',bZ)~=nil then bW=colors[c6('activeBG',bZ)]end;if c6('symbolColor',bZ)~=nil then bU=colors[c6('symbolColor',bZ)]end end,mouseHandler=function(bY,bZ,b_,c0)if bS.mouseHandler(bY,bZ,b_,c0)then local c1,c2=bY:getAbsolutePosition(bY:getAnchorPosition())bY:setValue(not bY:getValue())bY:updateDraw()return true end end,draw=function(bY)if bS.draw(bY)then if bY.parent~=nil then local bZ,b_=bY:getAnchorPosition()local c0,c1=bY:getSize()bY.parent:drawBackgroundBox(bZ,b_,c0,c1,bY.bgColor)if bY:getValue()then bY.parent:drawBackgroundBox(bZ,b_,1,c1,bW)bY.parent:drawBackgroundBox(bZ+1,b_,1,c1,bU)else bY.parent:drawBackgroundBox(bZ,b_,1,c1,bU)bY.parent:drawBackgroundBox(bZ+1,b_,1,c1,bV)end end end end,init=function(bY)bY.parent:addEvent('mouse_click',bY)if bS.init(bY)then bY.bgColor=bY.parent:getTheme'SwitchBG'bY.fgColor=bY.parent:getTheme'SwitchText'bU=bY.parent:getTheme'SwitchBGSymbol'bV=bY.parent:getTheme'SwitchInactive'bW=bY.parent:getTheme'SwitchActive'end end}return setmetatable(bX,bS)end end;as['objects']['Textfield']=function(...)local bS=require'Object'local bT=require'tHex'local bU=require'basaltLogs'local bV=require('utils').getValueFromXML;local bW=string.rep;return function(bX)local bY=bS(bX)local bZ='Textfield'local b_,c0,c1,c2=1,1,1,1;local c3={''}local c4={''}local c5={''}local c7={}local c8={}bY.width=30;bY.height=12;bY:setZIndex(5)local function c9(cd,ce)local ck={}if cd:len()>0 then for cl in string.gmatch(cd,ce)do local ci,cj=string.find(cd,cl)if ci~=nil and cj~=nil then table.insert(ck,ci)table.insert(ck,cj)local cr=string.sub(cd,1,ci-1)local cs=string.sub(cd,cj+1,cd:len())cd=cr..(':'):rep(cl:len())..cs end end end;return ck end;local function ca(cd,ce)ce=ce or c2;local ck=bT[cd.fgColor]:rep(c5[ce]:len())local cl=bT[cd.bgColor]:rep(c4[ce]:len())for ci,cj in pairs(c8)do local cr=c9(c3[ce],cj[1])if#cr>0 then for x=1,#cr/2 do local cs=x*2-1;if cj[2]~=nil then ck=ck:sub(1,cr[cs]-1)..bT[cj[2]]:rep(cr[cs+1]-(cr[cs]-1))..ck:sub(cr[cs+1]+1,ck:len())end;if cj[3]~=nil then cl=cl:sub(1,cr[cs]-1)..bT[cj[3]]:rep(cr[cs+1]-(cr[cs]-1))..cl:sub(cr[cs+1]+1,cl:len())end end end end;for ci,cj in pairs(c7)do for cr,cs in pairs(cj)do local ct=c9(c3[ce],cs)if#ct>0 then for x=1,#ct/2 do local cq=x*2-1;ck=ck:sub(1,ct[cq]-1)..bT[ci]:rep(ct[cq+1]-(ct[cq]-1))..ck:sub(ct[cq+1]+1,ck:len())end end end end;c5[ce]=ck;c4[ce]=cl;cd:updateDraw()end;local function cb(cd)for bE=1,#c3 do ca(cd,bE)end end;local cc={getType=function(cd)return bZ end,setBackground=function(cd,ce)bY.setBackground(cd,ce)cb(cd)return cd end,setForeground=function(cd,ce)bY.setForeground(cd,ce)cb(cd)return cd end,setValuesByXMLData=function(cd,ce)bY.setValuesByXMLData(cd,ce)if ce['lines']~=nil then local ck=ce['lines']['line']if ck.properties~=nil then ck={ck}end;for cl,ci in pairs(ck)do cd:addLine(ci:value())end end;if ce['keywords']~=nil then for ck,cl in pairs(ce['keywords'])do if colors[ck]~=nil then local ci=cl;if ci.properties~=nil then ci={ci}end;local cj={}for cr,cs in pairs(ci)do local ct=cs['keyword']if cs['keyword'].properties~=nil then ct={cs['keyword']}end;for cq,cu in pairs(ct)do table.insert(cj,cu:value())end end;cd:addKeywords(colors[ck],cj)end end end;if ce['rules']~=nil then if ce['rules']['rule']~=nil then local ck=ce['rules']['rule']if ce['rules']['rule'].properties~=nil then ck={ce['rules']['rule']}end;for cl,ci in pairs(ck)do if bV('pattern',ci)~=nil then cd:addRule(bV('pattern',ci),colors[bV('fg',ci)],colors[bV('bg',ci)])end end end end end,getLines=function(cd)return c3 end,getLine=function(cd,ce)return c3[ce]end,editLine=function(cd,ce,ck)c3[ce]=ck or c3[ce]ca(cd,ce)cd:updateDraw()return cd end,clear=function(cd)c3={''}c4={''}c5={''}b_,c0,c1,c2=1,1,1,1;cd:updateDraw()return cd end,addLine=function(cd,ce,ck)if ce~=nil then if#c3==1 and c3[1]==''then c3[1]=ce;c4[1]=bT[cd.bgColor]:rep(ce:len())c5[1]=bT[cd.fgColor]:rep(ce:len())ca(cd,1)return cd end;if ck~=nil then table.insert(c3,ck,ce)table.insert(c4,ck,bT[cd.bgColor]:rep(ce:len()))table.insert(c5,ck,bT[cd.fgColor]:rep(ce:len()))else table.insert(c3,ce)table.insert(c4,bT[cd.bgColor]:rep(ce:len()))table.insert(c5,bT[cd.fgColor]:rep(ce:len()))end end;ca(cd,ck or#c3)cd:updateDraw()return cd end,addKeywords=function(cd,ce,ck)if c7[ce]==nil then c7[ce]={}end;for cl,ci in pairs(ck)do table.insert(c7[ce],ci)end;cd:updateDraw()return cd end,addRule=function(cd,ce,ck,cl)table.insert(c8,{ce,ck,cl})cd:updateDraw()return cd end,editRule=function(cd,ce,ck,cl)for ci,cj in pairs(c8)do if cj[1]==ce then c8[ci][2]=ck;c8[ci][3]=cl end end;cd:updateDraw()return cd end,removeRule=function(cd,ce)for ck,cl in pairs(c8)do if cl[1]==ce then table.remove(c8,ck)end end;cd:updateDraw()return cd end,setKeywords=function(cd,ce,ck)c7[ce]=ck;cd:updateDraw()return cd end,removeLine=function(cd,ce)table.remove(c3,ce or#c3)if#c3<=0 then table.insert(c3,'')end;cd:updateDraw()return cd end,getTextCursor=function(cd)return c1,c2 end,getFocusHandler=function(cd)bY.getFocusHandler(cd)if cd.parent~=nil then local ce,ck=cd:getAnchorPosition()if cd.parent~=nil then cd.parent:setCursor(true,ce+c1-c0,ck+c2-b_,cd.fgColor)end end end,loseFocusHandler=function(cd)bY.loseFocusHandler(cd)if cd.parent~=nil then cd.parent:setCursor(false)end end,keyHandler=function(cd,ce)if bY.keyHandler(cd,event,ce)then local ck,cl=cd:getAnchorPosition()local ci,cj=cd:getSize()if ce==keys.backspace then if c3[c2]==''then if c2>1 then table.remove(c3,c2)table.remove(c5,c2)table.remove(c4,c2)c1=c3[c2-1]:len()+1;c0=c1-ci+1;if c0<1 then c0=1 end;c2=c2-1 end elseif c1<=1 then if c2>1 then c1=c3[c2-1]:len()+1;c0=c1-ci+1;if c0<1 then c0=1 end;c3[c2-1]=c3[c2-1]..c3[c2]c5[c2-1]=c5[c2-1]..c5[c2]c4[c2-1]=c4[c2-1]..c4[c2]table.remove(c3,c2)table.remove(c5,c2)table.remove(c4,c2)c2=c2-1 end else c3[c2]=c3[c2]:sub(1,c1-2)..c3[c2]:sub(c1,c3[c2]:len())c5[c2]=c5[c2]:sub(1,c1-2)..c5[c2]:sub(c1,c5[c2]:len())c4[c2]=c4[c2]:sub(1,c1-2)..c4[c2]:sub(c1,c4[c2]:len())if c1>1 then c1=c1-1 end;if c0>1 then if c1<c0 then c0=c0-1 end end end;if c2<b_ then b_=b_-1 end;ca(cd)cd:setValue''end;if ce==keys.delete then if c1>c3[c2]:len()then if c3[c2+1]~=nil then c3[c2]=c3[c2]..c3[c2+1]table.remove(c3,c2+1)table.remove(c4,c2+1)table.remove(c5,c2+1)end else c3[c2]=c3[c2]:sub(1,c1-1)..c3[c2]:sub(c1+1,c3[c2]:len())c5[c2]=c5[c2]:sub(1,c1-1)..c5[c2]:sub(c1+1,c5[c2]:len())c4[c2]=c4[c2]:sub(1,c1-1)..c4[c2]:sub(c1+1,c4[c2]:len())end;ca(cd)end;if ce==keys.enter then table.insert(c3,c2+1,c3[c2]:sub(c1,c3[c2]:len()))table.insert(c5,c2+1,c5[c2]:sub(c1,c5[c2]:len()))table.insert(c4,c2+1,c4[c2]:sub(c1,c4[c2]:len()))c3[c2]=c3[c2]:sub(1,c1-1)c5[c2]=c5[c2]:sub(1,c1-1)c4[c2]=c4[c2]:sub(1,c1-1)c2=c2+1;c1=1;c0=1;if c2-b_>=cj then b_=b_+1 end;cd:setValue''end;if ce==keys.up then if c2>1 then c2=c2-1;if c1>c3[c2]:len()+1 then c1=c3[c2]:len()+1 end;if c0>1 then if c1<c0 then c0=c1-ci+1;if c0<1 then c0=1 end end end;if b_>1 then if c2<b_ then b_=b_-1 end end end end;if ce==keys.down then if c2<#c3 then c2=c2+1;if c1>c3[c2]:len()+1 then c1=c3[c2]:len()+1 end;if c0>1 then if c1<c0 then c0=c1-ci+1;if c0<1 then c0=1 end end end;if c2>=b_+cj then b_=b_+1 end end end;if ce==keys.right then c1=c1+1;if c2<#c3 then if c1>c3[c2]:len()+1 then c1=1;c2=c2+1 end elseif c1>c3[c2]:len()then c1=c3[c2]:len()+1 end;if c1<1 then c1=1 end;if c1<c0 or c1>=ci+c0 then c0=c1-ci+1 end;if c0<1 then c0=1 end end;if ce==keys.left then c1=c1-1;if c1>=1 then if c1<c0 or c1>=ci+c0 then c0=c1 end end;if c2>1 then if c1<1 then c2=c2-1;c1=c3[c2]:len()+1;c0=c1-ci+1 end end;if c1<1 then c1=1 end;if c0<1 then c0=1 end end;local cr=(c1<=c3[c2]:len()and c1-1 or c3[c2]:len())-(c0-1)if cr>cd.x+ci-1 then cr=cd.x+ci-1 end;local cs=c2-b_<cj and c2-b_ or c2-b_-1;if cr<1 then cr=0 end;cd.parent:setCursor(true,ck+cr,cl+cs,cd.fgColor)cd:updateDraw()return true end end,charHandler=function(cd,ce)if bY.charHandler(cd,ce)then local ck,cl=cd:getAnchorPosition()local ci,cj=cd:getSize()c3[c2]=c3[c2]:sub(1,c1-1)..ce..c3[c2]:sub(c1,c3[c2]:len())c5[c2]=c5[c2]:sub(1,c1-1)..bT[cd.fgColor]..c5[c2]:sub(c1,c5[c2]:len())c4[c2]=c4[c2]:sub(1,c1-1)..bT[cd.bgColor]..c4[c2]:sub(c1,c4[c2]:len())c1=c1+1;if c1>=ci+c0 then c0=c0+1 end;ca(cd)cd:setValue''local cr=(c1<=c3[c2]:len()and c1-1 or c3[c2]:len())-(c0-1)if cr>cd.x+ci-1 then cr=cd.x+ci-1 end;local cs=c2-b_<cj and c2-b_ or c2-b_-1;if cr<1 then cr=0 end;cd.parent:setCursor(true,ck+cr,cl+cs,cd.fgColor)cd:updateDraw()return true end end,dragHandler=function(cd,ce,ck,cl)if bY.dragHandler(cd,ce,ck,cl)then local ci,cj=cd:getAbsolutePosition(cd:getAnchorPosition())local cr,cs=cd:getAnchorPosition()local ct,cq=cd:getSize()if c3[cl-cj+b_]~=nil then if cr+ct>cr+ck-(ci+1)+c0 and cr<cr+ck-ci+c0 then c1=ck-ci+c0;c2=cl-cj+b_;if c1>c3[c2]:len()then c1=c3[c2]:len()+1 end;if c1<c0 then c0=c1-1;if c0<1 then c0=1 end end;if cd.parent~=nil then cd.parent:setCursor(true,cr+c1-c0,cs+c2-b_,cd.fgColor)end;cd:updateDraw()end end;return true end end,scrollHandler=function(cd,ce,ck,cl)if bY.scrollHandler(cd,ce,ck,cl)then local ci,cj=cd:getAbsolutePosition(cd:getAnchorPosition())local cr,cs=cd:getAnchorPosition()local ct,cq=cd:getSize()b_=b_+ce;if b_>#c3-(cq-1)then b_=#c3-(cq-1)end;if b_<1 then b_=1 end;if cd.parent~=nil then if ci+c1-c0>=ci and ci+c1-c0<ci+ct and(cj+c2-b_>=cj and cj+c2-b_<cj+cq)then cd.parent:setCursor(true,cr+c1-c0,cs+c2-b_,cd.fgColor)else cd.parent:setCursor(false)end end;cd:updateDraw()return true end end,mouseHandler=function(cd,ce,ck,cl)if bY.mouseHandler(cd,ce,ck,cl)then local ci,cj=cd:getAbsolutePosition(cd:getAnchorPosition())local cr,cs=cd:getAnchorPosition()if c3[cl-cj+b_]~=nil then c1=ck-ci+c0;c2=cl-cj+b_;if c1>c3[c2]:len()then c1=c3[c2]:len()+1 end;if c1<c0 then c0=c1-1;if c0<1 then c0=1 end end end;if cd.parent~=nil then cd.parent:setCursor(true,cr+c1-c0,cs+c2-b_,cd.fgColor)end;return true end end,eventHandler=function(cd,ce,ck,cl,ci,cj)if bY.eventHandler(cd,ce,ck,cl,ci,cj)then if ce=='paste'then if cd:isFocused()then local cr,cs=cd:getSize()c3[c2]=c3[c2]:sub(1,c1-1)..ck..c3[c2]:sub(c1,c3[c2]:len())c5[c2]=c5[c2]:sub(1,c1-1)..bT[cd.fgColor]:rep(ck:len())..c5[c2]:sub(c1,c5[c2]:len())c4[c2]=c4[c2]:sub(1,c1-1)..bT[cd.bgColor]:rep(ck:len())..c4[c2]:sub(c1,c4[c2]:len())c1=c1+ck:len()if c1>=cr+c0 then c0=c1+1-cr end;local ct,cq=cd:getAnchorPosition()cd.parent:setCursor(true,ct+c1-c0,cq+c2-b_,cd.fgColor)ca(cd)cd:updateDraw()end end end end,draw=function(cd)if bY.draw(cd)then if cd.parent~=nil then local ce,ck=cd:getAnchorPosition()local cl,ci=cd:getSize()for bE=1,ci do local cj=''local cr=''local cs=''if c3[bE+b_-1]~=nil then cj=c3[bE+b_-1]cs=c5[bE+b_-1]cr=c4[bE+b_-1]end;cj=cj:sub(c0,cl+c0-1)cr=cr:sub(c0,cl+c0-1)cs=cs:sub(c0,cl+c0-1)local ct=cl-cj:len()if ct<0 then ct=0 end;cj=cj..bW(cd.bgSymbol,ct)cr=cr..bW(bT[cd.bgColor],ct)cs=cs..bW(bT[cd.fgColor],ct)cd.parent:setText(ce,ck+bE-1,cj)cd.parent:setBG(ce,ck+bE-1,cr)cd.parent:setFG(ce,ck+bE-1,cs)end;if cd:isFocused()then local cj,cr=cd:getAnchorPosition()cd.parent:setCursor(true,cj+c1-c0,cr+c2-b_,cd.fgColor)end end end end,init=function(cd)cd.parent:addEvent('mouse_click',cd)cd.parent:addEvent('mouse_scroll',cd)cd.parent:addEvent('mouse_drag',cd)cd.parent:addEvent('key',cd)cd.parent:addEvent('char',cd)cd.parent:addEvent('other_event',cd)if bY.init(cd)then cd.bgColor=cd.parent:getTheme'TextfieldBG'cd.fgColor=cd.parent:getTheme'TextfieldText'end end}return setmetatable(cc,bY)end end;as['objects']['Thread']=function(...)local av=require('utils').getValueFromXML;return function(cf)local c6;local bR='Thread'local bS;local bT;local bU=false;local bV=function(bW,bX)if bX:sub(1,1)=='#'then local bY=bW:getBaseFrame():getDeepObject(bX:sub(2,bX:len()))if bY~=nil and bY.internalObjetCall~=nil then return function()bY:internalObjetCall()end end else return bW:getBaseFrame():getVariable(bX)end;return bW end;c6={name=cf,getType=function(bW)return bR end,getZIndex=function(bW)return 1 end,getName=function(bW)return bW.name end,getBaseFrame=function(bW)if bW.parent~=nil then return bW.parent:getBaseFrame()end;return bW end,setValuesByXMLData=function(bW,bX)local bY;if av('thread',bX)~=nil then bY=bV(bW,av('thread',bX))end;if av('start',bX)~=nil then if av('start',bX)and bY~=nil then bW:start(bY)end end;return bW end,start=function(bW,bX)if bX==nil then error'Function provided to thread is nil'end;bS=bX;bT=coroutine.create(bS)bU=true;local bY,bZ=coroutine.resume(bT)if not bY then if bZ~='Terminated'then error('Thread Error Occurred - '..bZ)end end;bW.parent:addEvent('other_event',bW)return bW end,getStatus=function(bW,bX)if bT~=nil then return coroutine.status(bT)end;return nil end,stop=function(bW,bX)bU=false;bW.parent:removeEvent('other_event',bW)return bW end,eventHandler=function(bW,bX,bY,bZ,b_)if bU then if coroutine.status(bT)~='dead'then local c0,c1=coroutine.resume(bT,bX,bY,bZ,b_)if not c0 then if c1~='Terminated'then error('Thread Error Occurred - '..c1)end end else bU=false end end end}c6.__index=c6;return c6 end end;as['objects']['Timer']=function(...)local cf=require'basaltEvent'local c6=require('utils').getValueFromXML;return function(bR)local bS='Timer'local bT=0;local bU=0;local bV=0;local bW;local bX=cf()local bY=false;local bZ=function(c0,c1,c2)local c3=function(c4)if c4:sub(1,1)=='#'then local c5=c0:getBaseFrame():getDeepObject(c4:sub(2,c4:len()))if c5~=nil and c5.internalObjetCall~=nil then c1(c0,function()c5:internalObjetCall()end)end else c1(c0,c0:getBaseFrame():getVariable(c4))end end;if type(c2)=='string'then c3(c2)elseif type(c2)=='table'then for c4,c5 in pairs(c2)do c3(c5)end end;return c0 end;local b_={name=bR,getType=function(c0)return bS end,setValuesByXMLData=function(c0,c1)if c6('time',c1)~=nil then bT=c6('time',c1)end;if c6('repeat',c1)~=nil then bU=c6('repeat',c1)end;if c6('start',c1)~=nil then if c6('start',c1)then c0:start()end end;if c6('onCall',c1)~=nil then bZ(c0,c0.onCall,c6('onCall',c1))end;return c0 end,getBaseFrame=function(c0)if c0.parent~=nil then return c0.parent:getBaseFrame()end;return c0 end,getZIndex=function(c0)return 1 end,getName=function(c0)return c0.name end,setTime=function(c0,c1,c2)bT=c1 or 0;bU=c2 or 1;return c0 end,start=function(c0)if bY then os.cancelTimer(bW)end;bV=bU;bW=os.startTimer(bT)bY=true;c0.parent:addEvent('other_event',c0)return c0 end,isActive=function(c0)return bY end,cancel=function(c0)if bW~=nil then os.cancelTimer(bW)end;bY=false;c0.parent:removeEvent('other_event',c0)return c0 end,onCall=function(c0,c1)bX:registerEvent('timed_event',c1)return c0 end,eventHandler=function(c0,c1,c2)if c1=='timer'and c2==bW and bY then bX:sendEvent('timed_event',c0)if bV>=1 then bV=bV-1;if bV>=1 then bW=os.startTimer(bT)end elseif bV==-1 then bW=os.startTimer(bT)end end end}b_.__index=b_;return b_ end end;as['libraries']['basaltDraw']=function(...)local c6=require'tHex'local bR,bS=string.sub,string.rep;return function(bT)local bU=bT or term.current()local bV;local bW,bX=bU.getSize()local bY={}local bZ={}local b_={}local c0={}local c1={}local c2={}local c3;local c4={}local function c5()c3=bS(' ',bW)for bE=0,15 do local cc=2^bE;local cd=c6[cc]c4[cc]=bS(cd,bW)end end;c5()local function c7()c5()local cc=c3;local cd=c4[colors.white]local ce=c4[colors.black]for cI=1,bX do bY[cI]=bR(bY[cI]==nil and cc or bY[cI]..cc:sub(1,bW-bY[cI]:len()),1,bW)b_[cI]=bR(b_[cI]==nil and cd or b_[cI]..cd:sub(1,bW-b_[cI]:len()),1,bW)bZ[cI]=bR(bZ[cI]==nil and ce or bZ[cI]..ce:sub(1,bW-bZ[cI]:len()),1,bW)end end;c7()local function c8(cc,cd,ce)if cd>=1 and cd<=bX then if cc+ce:len()>0 and cc<=bW then local ck=bY[cd]local cl;local ci=cc+#ce-1;if cc<1 then local cj=1-cc+1;local cr=bW-cc+1;ce=bR(ce,cj,cr)elseif ci>bW then local cj=bW-cc+1;ce=bR(ce,1,cj)end;if cc>1 then local cj=cc-1;cl=bR(ck,1,cj)..ce else cl=ce end;if ci<bW then cl=cl..bR(ck,ci+1,bW)end;bY[cd]=cl end end end;local function c9(cc,cd,ce)if cd>=1 and cd<=bX then if cc+ce:len()>0 and cc<=bW then local ck=bZ[cd]local cl;local ci=cc+#ce-1;if cc<1 then ce=bR(ce,1-cc+1,bW-cc+1)elseif ci>bW then ce=bR(ce,1,bW-cc+1)end;if cc>1 then cl=bR(ck,1,cc-1)..ce else cl=ce end;if ci<bW then cl=cl..bR(ck,ci+1,bW)end;bZ[cd]=cl end end end;local function ca(cc,cd,ce)if cd>=1 and cd<=bX then if cc+ce:len()>0 and cc<=bW then local ck=b_[cd]local cl;local ci=cc+#ce-1;if cc<1 then local cj=1-cc+1;local cr=bW-cc+1;ce=bR(ce,cj,cr)elseif ci>bW then local cj=bW-cc+1;ce=bR(ce,1,cj)end;if cc>1 then local cj=cc-1;cl=bR(ck,1,cj)..ce else cl=ce end;if ci<bW then cl=cl..bR(ck,ci+1,bW)end;b_[cd]=cl end end end;local cb={setSize=function(cc,cd)bW,bX=cc,cd;c7()end,setMirror=function(cc)bV=cc end,setBG=function(cc,cd,ce)c9(cc,cd,ce)end,setText=function(cc,cd,ce)c8(cc,cd,ce)end,setFG=function(cc,cd,ce)ca(cc,cd,ce)end,drawBackgroundBox=function(cc,cd,ce,ck,cl)for bE=1,ck do c9(cc,cd+bE-1,bS(c6[cl],ce))end end,drawForegroundBox=function(cc,cd,ce,ck,cl)for bE=1,ck do ca(cc,cd+bE-1,bS(c6[cl],ce))end end,drawTextBox=function(cc,cd,ce,ck,cl)for bE=1,ck do c8(cc,cd+bE-1,bS(cl,ce))end end,writeText=function(cc,cd,ce,ck,cl)if ce~=nil then c8(cc,cd,ce)if ck~=nil and ck~=false then c9(cc,cd,bS(c6[ck],ce:len()))end;if cl~=nil and cl~=false then ca(cc,cd,bS(c6[cl],ce:len()))end end end,update=function()local cc,cd=bU.getCursorPos()local ce=false;if bU.getCursorBlink~=nil then ce=bU.getCursorBlink()end;bU.setCursorBlink(false)if bV~=nil then bV.setCursorBlink(false)end;for bE=1,bX do bU.setCursorPos(1,bE)bU.blit(bY[bE],b_[bE],bZ[bE])if bV~=nil then bV.setCursorPos(1,bE)bV.blit(bY[bE],b_[bE],bZ[bE])end end;bU.setBackgroundColor(colors.black)bU.setCursorBlink(ce)bU.setCursorPos(cc,cd)if bV~=nil then bV.setBackgroundColor(colors.black)bV.setCursorBlink(ce)bV.setCursorPos(cc,cd)end end,setTerm=function(cc)bU=cc end}return cb end end;as['libraries']['basaltEvent']=function(...)return function()local cJ={}local av={}local cf={registerEvent=function(c6,bR,bS)if cJ[bR]==nil then cJ[bR]={}av[bR]=1 end;cJ[bR][av[bR]]=bS;av[bR]=av[bR]+1;return av[bR]-1 end,removeEvent=function(c6,bR,bS)cJ[bR][bS[bR]]=nil end,sendEvent=function(c6,bR,...)local bS;if cJ[bR]~=nil then for bT,bU in pairs(cJ[bR])do local bV=bU(...)if bV==false then bS=bV end end end;return bS end}cf.__index=cf;return cf end end;as['libraries']['basaltLogs']=function(...)local bR=''local bS='basaltLog.txt'local bT='Debug'fs.delete(bR~=''and bR..'/'..bS or bS)local bU={__call=function(bV,bW,bX)if bW==nil then return end;local bY=bR~=''and bR..'/'..bS or bS;local bZ=fs.open(bY,fs.exists(bY)and'a'or'w')bZ.writeLine('[Basalt]['..(bX and bX or bT)..']: '..tostring(bW))bZ.close()end}return setmetatable({},bU)end;as['libraries']['basaltMon']=function(...)local bS={[colors.white]='0',[colors.orange]='1',[colors.magenta]='2',[colors.lightBlue]='3',[colors.yellow]='4',[colors.lime]='5',[colors.pink]='6',[colors.gray]='7',[colors.lightGray]='8',[colors.cyan]='9',[colors.purple]='a',[colors.blue]='b',[colors.brown]='c',[colors.green]='d',[colors.red]='e',[colors.black]='f'}local bT,bU,bV,bW=type,string.len,string.rep,string.sub;return function(bX)local bY={}for cl,ci in pairs(bX)do bY[cl]={}for cj,cr in pairs(ci)do local cs=peripheral.wrap(cr)if cs==nil then error('Unable to find monitor '..cr)end;bY[cl][cj]=cs;bY[cl][cj].name=cr end end;local bZ,b_,c0,c1,c2,c3,c4,c5=1,1,1,1,0,0,0,0;local c7,c8=false,1;local c9,ca=colors.white,colors.black;local function cb()local cl,ci=0,0;for cj,cr in pairs(bY)do local cs,ct=0,0;for cq,cu in pairs(cr)do local cv,cw=cu.getSize()cs=cs+cv;ct=cw>ct and cw or ct end;cl=cl>cs and cl or cs;ci=ci+ct end;c4,c5=cl,ci end;cb()local function cc()local cl=0;local ci,cj=0,0;for cr,cs in pairs(bY)do local ct=0;local cq=0;for cu,cv in pairs(cs)do local cw,cx=cv.getSize()if bZ-ct>=1 and bZ-ct<=cw then ci=cu end;cv.setCursorPos(bZ-ct,b_-cl)ct=ct+cw;if cq<cx then cq=cx end end;if b_-cl>=1 and b_-cl<=cq then cj=cr end;cl=cl+cq end;c0,c1=ci,cj end;cc()local function cd(cl,...)local ci={...}return function()for cj,cr in pairs(bY)do for cs,ct in pairs(cr)do ct[cl](table.unpack(ci))end end end end;local function ce()cd('setCursorBlink',false)()if not c7 then return end;if bY[c1]==nil then return end;local cl=bY[c1][c0]if cl==nil then return end;cl.setCursorBlink(c7)end;local function ck(cl,ci,cj)if bY[c1]==nil then return end;local cr=bY[c1][c0]if cr==nil then return end;cr.blit(cl,ci,cj)local cs,ct=cr.getSize()if bU(cl)+bZ>cs then local cq=bY[c1][c0+1]if cq~=nil then cq.blit(cl,ci,cj)c0=c0+1;bZ=bZ+bU(cl)end end;cc()end;return{clear=cd'clear',setCursorBlink=function(cl)c7=cl;ce()end,getCursorBlink=function()return c7 end,getCursorPos=function()return bZ,b_ end,setCursorPos=function(cl,ci)bZ,b_=cl,ci;cc()ce()end,setTextScale=function(cl)cd('setTextScale',cl)()cb()cc()c8=cl end,getTextScale=function()return c8 end,blit=function(cl,ci,cj)ck(cl,ci,cj)end,write=function(cl)cl=tostring(cl)local ci=bU(cl)ck(cl,bV(bS[c9],ci),bV(bS[ca],ci))end,getSize=function()return c4,c5 end,setBackgroundColor=function(cl)cd('setBackgroundColor',cl)()ca=cl end,setTextColor=function(cl)cd('setTextColor',cl)()c9=cl end,calculateClick=function(cl,ci,cj)local cr=0;for cs,ct in pairs(bY)do local cq=0;local cu=0;for cv,cw in pairs(ct)do local cx,cy=cw.getSize()if cw.name==cl then return ci+cq,cj+cr end;cq=cq+cx;if cy>cu then cu=cy end end;cr=cr+cu end;return ci,cj end}end end;as['libraries']['bigfont']=function(...)local bT=require'tHex'local bU={{'\32\32\32\137\156\148\158\159\148\135\135\144\159\139\32\136\157\32\159\139\32\32\143\32\32\143\32\32\32\32\32\32\32\32\147\148\150\131\148\32\32\32\151\140\148\151\140\147','\32\32\32\149\132\149\136\156\149\144\32\133\139\159\129\143\159\133\143\159\133\138\32\133\138\32\133\32\32\32\32\32\32\150\150\129\137\156\129\32\32\32\133\131\129\133\131\132','\32\32\32\130\131\32\130\131\32\32\129\32\32\32\32\130\131\32\130\131\32\32\32\32\143\143\143\32\32\32\32\32\32\130\129\32\130\135\32\32\32\32\131\32\32\131\32\131','\139\144\32\32\143\148\135\130\144\149\32\149\150\151\149\158\140\129\32\32\32\135\130\144\135\130\144\32\149\32\32\139\32\159\148\32\32\32\32\159\32\144\32\148\32\147\131\132','\159\135\129\131\143\149\143\138\144\138\32\133\130\149\149\137\155\149\159\143\144\147\130\132\32\149\32\147\130\132\131\159\129\139\151\129\148\32\32\139\131\135\133\32\144\130\151\32','\32\32\32\32\32\32\130\135\32\130\32\129\32\129\129\131\131\32\130\131\129\140\141\132\32\129\32\32\129\32\32\32\32\32\32\32\131\131\129\32\32\32\32\32\32\32\32\32','\32\32\32\32\149\32\159\154\133\133\133\144\152\141\132\133\151\129\136\153\32\32\154\32\159\134\129\130\137\144\159\32\144\32\148\32\32\32\32\32\32\32\32\32\32\32\151\129','\32\32\32\32\133\32\32\32\32\145\145\132\141\140\132\151\129\144\150\146\129\32\32\32\138\144\32\32\159\133\136\131\132\131\151\129\32\144\32\131\131\129\32\144\32\151\129\32','\32\32\32\32\129\32\32\32\32\130\130\32\32\129\32\129\32\129\130\129\129\32\32\32\32\130\129\130\129\32\32\32\32\32\32\32\32\133\32\32\32\32\32\129\32\129\32\32','\150\156\148\136\149\32\134\131\148\134\131\148\159\134\149\136\140\129\152\131\32\135\131\149\150\131\148\150\131\148\32\148\32\32\148\32\32\152\129\143\143\144\130\155\32\134\131\148','\157\129\149\32\149\32\152\131\144\144\131\148\141\140\149\144\32\149\151\131\148\32\150\32\150\131\148\130\156\133\32\144\32\32\144\32\130\155\32\143\143\144\32\152\129\32\134\32','\130\131\32\131\131\129\131\131\129\130\131\32\32\32\129\130\131\32\130\131\32\32\129\32\130\131\32\130\129\32\32\129\32\32\133\32\32\32\129\32\32\32\130\32\32\32\129\32','\150\140\150\137\140\148\136\140\132\150\131\132\151\131\148\136\147\129\136\147\129\150\156\145\138\143\149\130\151\32\32\32\149\138\152\129\149\32\32\157\152\149\157\144\149\150\131\148','\149\143\142\149\32\149\149\32\149\149\32\144\149\32\149\149\32\32\149\32\32\149\32\149\149\32\149\32\149\32\144\32\149\149\130\148\149\32\32\149\32\149\149\130\149\149\32\149','\130\131\129\129\32\129\131\131\32\130\131\32\131\131\32\131\131\129\129\32\32\130\131\32\129\32\129\130\131\32\130\131\32\129\32\129\131\131\129\129\32\129\129\32\129\130\131\32','\136\140\132\150\131\148\136\140\132\153\140\129\131\151\129\149\32\149\149\32\149\149\32\149\137\152\129\137\152\129\131\156\133\149\131\32\150\32\32\130\148\32\152\137\144\32\32\32','\149\32\32\149\159\133\149\32\149\144\32\149\32\149\32\149\32\149\150\151\129\138\155\149\150\130\148\32\149\32\152\129\32\149\32\32\32\150\32\32\149\32\32\32\32\32\32\32','\129\32\32\130\129\129\129\32\129\130\131\32\32\129\32\130\131\32\32\129\32\129\32\129\129\32\129\32\129\32\131\131\129\130\131\32\32\32\129\130\131\32\32\32\32\140\140\132','\32\154\32\159\143\32\149\143\32\159\143\32\159\144\149\159\143\32\159\137\145\159\143\144\149\143\32\32\145\32\32\32\145\149\32\144\32\149\32\143\159\32\143\143\32\159\143\32','\32\32\32\152\140\149\151\32\149\149\32\145\149\130\149\157\140\133\32\149\32\154\143\149\151\32\149\32\149\32\144\32\149\149\153\32\32\149\32\149\133\149\149\32\149\149\32\149','\32\32\32\130\131\129\131\131\32\130\131\32\130\131\129\130\131\129\32\129\32\140\140\129\129\32\129\32\129\32\137\140\129\130\32\129\32\130\32\129\32\129\129\32\129\130\131\32','\144\143\32\159\144\144\144\143\32\159\143\144\159\138\32\144\32\144\144\32\144\144\32\144\144\32\144\144\32\144\143\143\144\32\150\129\32\149\32\130\150\32\134\137\134\134\131\148','\136\143\133\154\141\149\151\32\129\137\140\144\32\149\32\149\32\149\154\159\133\149\148\149\157\153\32\154\143\149\159\134\32\130\148\32\32\149\32\32\151\129\32\32\32\32\134\32','\133\32\32\32\32\133\129\32\32\131\131\32\32\130\32\130\131\129\32\129\32\130\131\129\129\32\129\140\140\129\131\131\129\32\130\129\32\129\32\130\129\32\32\32\32\32\129\32','\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32','\32\32\32\32\32\32\32\32\32\32\32\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\32\32\32\32\32\32\32\32\32\32\32','\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32\32','\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32\32\32\32\32\149\32\32\149\32\32\32\32','\32\32\32\32\32\32\32\32\32\32\32\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\32\32\32\32\32\32\32\32\32\32\32','\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32\32\149\32','\32\32\32\32\145\32\159\139\32\151\131\132\155\143\132\134\135\145\32\149\32\158\140\129\130\130\32\152\147\155\157\134\32\32\144\144\32\32\32\32\32\32\152\131\155\131\131\129','\32\32\32\32\149\32\149\32\145\148\131\32\149\32\149\140\157\132\32\148\32\137\155\149\32\32\32\149\154\149\137\142\32\153\153\32\131\131\149\131\131\129\149\135\145\32\32\32','\32\32\32\32\129\32\130\135\32\131\131\129\134\131\132\32\129\32\32\129\32\131\131\32\32\32\32\130\131\129\32\32\32\32\129\129\32\32\32\32\32\32\130\131\129\32\32\32','\150\150\32\32\148\32\134\32\32\132\32\32\134\32\32\144\32\144\150\151\149\32\32\32\32\32\32\145\32\32\152\140\144\144\144\32\133\151\129\133\151\129\132\151\129\32\145\32','\130\129\32\131\151\129\141\32\32\142\32\32\32\32\32\149\32\149\130\149\149\32\143\32\32\32\32\142\132\32\154\143\133\157\153\132\151\150\148\151\158\132\151\150\148\144\130\148','\32\32\32\140\140\132\32\32\32\32\32\32\32\32\32\151\131\32\32\129\129\32\32\32\32\134\32\32\32\32\32\32\32\129\129\32\129\32\129\129\130\129\129\32\129\130\131\32','\156\143\32\159\141\129\153\140\132\153\137\32\157\141\32\159\142\32\150\151\129\150\131\132\140\143\144\143\141\145\137\140\148\141\141\144\157\142\32\159\140\32\151\134\32\157\141\32','\157\140\149\157\140\149\157\140\149\157\140\149\157\140\149\157\140\149\151\151\32\154\143\132\157\140\32\157\140\32\157\140\32\157\140\32\32\149\32\32\149\32\32\149\32\32\149\32','\129\32\129\129\32\129\129\32\129\129\32\129\129\32\129\129\32\129\129\131\129\32\134\32\131\131\129\131\131\129\131\131\129\131\131\129\130\131\32\130\131\32\130\131\32\130\131\32','\151\131\148\152\137\145\155\140\144\152\142\145\153\140\132\153\137\32\154\142\144\155\159\132\150\156\148\147\32\144\144\130\145\136\137\32\146\130\144\144\130\145\130\136\32\151\140\132','\151\32\149\151\155\149\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\152\137\144\157\129\149\149\32\149\149\32\149\149\32\149\149\32\149\130\150\32\32\157\129\149\32\149','\131\131\32\129\32\129\130\131\32\130\131\32\130\131\32\130\131\32\130\131\32\32\32\32\130\131\32\130\131\32\130\131\32\130\131\32\130\131\32\32\129\32\130\131\32\133\131\32','\156\143\32\159\141\129\153\140\132\153\137\32\157\141\32\159\142\32\159\159\144\152\140\144\156\143\32\159\141\129\153\140\132\157\141\32\130\145\32\32\147\32\136\153\32\130\146\32','\152\140\149\152\140\149\152\140\149\152\140\149\152\140\149\152\140\149\149\157\134\154\143\132\157\140\133\157\140\133\157\140\133\157\140\133\32\149\32\32\149\32\32\149\32\32\149\32','\130\131\129\130\131\129\130\131\129\130\131\129\130\131\129\130\131\129\130\130\131\32\134\32\130\131\129\130\131\129\130\131\129\130\131\129\32\129\32\32\129\32\32\129\32\32\129\32','\159\134\144\137\137\32\156\143\32\159\141\129\153\140\132\153\137\32\157\141\32\32\132\32\159\143\32\147\32\144\144\130\145\136\137\32\146\130\144\144\130\145\130\138\32\146\130\144','\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\149\32\149\131\147\129\138\134\149\149\32\149\149\32\149\149\32\149\149\32\149\154\143\149\32\157\129\154\143\149','\130\131\32\129\32\129\130\131\32\130\131\32\130\131\32\130\131\32\130\131\32\32\32\32\130\131\32\130\131\129\130\131\129\130\131\129\130\131\129\140\140\129\130\131\32\140\140\129'},{'000110000110110000110010101000000010000000100101','000000110110000000000010101000000010000000100101','000000000000000000000000000000000000000000000000','100010110100000010000110110000010100000100000110','000000110000000010110110000110000000000000110000','000000000000000000000000000000000000000000000000','000000110110000010000000100000100000000000000010','000000000110110100010000000010000000000000000100','000000000000000000000000000000000000000000000000','010000000000100110000000000000000000000110010000','000000000000000000000000000010000000010110000000','000000000000000000000000000000000000000000000000','011110110000000100100010110000000100000000000000','000000000000000000000000000000000000000000000000','000000000000000000000000000000000000000000000000','110000110110000000000000000000010100100010000000','000010000000000000110110000000000100010010000000','000000000000000000000000000000000000000000000000','010110010110100110110110010000000100000110110110','000000000000000000000110000000000110000000000000','000000000000000000000000000000000000000000000000','010100010110110000000000000000110000000010000000','110110000000000000110000110110100000000010000000','000000000000000000000000000000000000000000000000','000100011111000100011111000100011111000100011111','000000000000100100100100011011011011111111111111','000000000000000000000000000000000000000000000000','000100011111000100011111000100011111000100011111','000000000000100100100100011011011011111111111111','100100100100100100100100100100100100100100100100','000000110100110110000010000011110000000000011000','000000000100000000000010000011000110000000001000','000000000000000000000000000000000000000000000000','010000100100000000000000000100000000010010110000','000000000000000000000000000000110110110110110000','000000000000000000000000000000000000000000000000','110110110110110110000000110110110110110110110110','000000000000000000000110000000000000000000000000','000000000000000000000000000000000000000000000000','000000000000110110000110010000000000000000010010','000010000000000000000000000000000000000000000000','000000000000000000000000000000000000000000000000','110110110110110110110000110110110110000000000000','000000000000000000000110000000000000000000000000','000000000000000000000000000000000000000000000000','110110110110110110110000110000000000000000010000','000000000000000000000000100000000000000110000110','000000000000000000000000000000000000000000000000'}}local bV={}local bW={}do local bZ=0;local b_=#bU[1]local c0=#bU[1][1]for cg=1,b_,3 do for ch=1,c0,3 do local c1=string.char(bZ)local c2={}c2[1]=bU[1][cg]:sub(ch,ch+2)c2[2]=bU[1][cg+1]:sub(ch,ch+2)c2[3]=bU[1][cg+2]:sub(ch,ch+2)local c3={}c3[1]=bU[2][cg]:sub(ch,ch+2)c3[2]=bU[2][cg+1]:sub(ch,ch+2)c3[3]=bU[2][cg+2]:sub(ch,ch+2)bW[c1]={c2,c3}bZ=bZ+1 end end;bV[1]=bW end;local function bX(bZ,b_)local c0={['0']='1',['1']='0'}if bZ<=#bV then return true end;for X=#bV+1,bZ do local c1={}local c2=bV[X-1]for cK=0,255 do local c3=string.char(cK)local c4={}local c5={}local c7=c2[c3][1]local c8=c2[c3][2]for cg=1,#c7 do local c9,ca,cb,cc,cd,ce={},{},{},{},{},{}for ch=1,#c7[1]do local ck=bW[c7[cg]:sub(ch,ch)][1]table.insert(c9,ck[1])table.insert(ca,ck[2])table.insert(cb,ck[3])local cl=bW[c7[cg]:sub(ch,ch)][2]if c8[cg]:sub(ch,ch)=='1'then table.insert(cc,cl[1]:gsub('[01]',c0))table.insert(cd,cl[2]:gsub('[01]',c0))table.insert(ce,cl[3]:gsub('[01]',c0))else table.insert(cc,cl[1])table.insert(cd,cl[2])table.insert(ce,cl[3])end end;table.insert(c4,table.concat(c9))table.insert(c4,table.concat(ca))table.insert(c4,table.concat(cb))table.insert(c5,table.concat(cc))table.insert(c5,table.concat(cd))table.insert(c5,table.concat(ce))end;c1[c3]={c4,c5}if b_ then b_='Font'..X..'Yeld'..cK;os.queueEvent(b_)os.pullEvent(b_)end end;bV[X]=c1 end;return true end;local function bY(bZ,b_,c0,c1,c2)if not type(b_)=='string'then error('Not a String',3)end;local c3=type(c0)=='string'and c0:sub(1,1)or bT[c0]or error('Wrong Front Color',3)local c4=type(c1)=='string'and c1:sub(1,1)or bT[c1]or error('Wrong Back Color',3)if bV[bZ]==nil then bX(3,false)end;local c5=bV[bZ]or error('Wrong font size selected',3)if b_==''then return{{''},{''},{''}}end;local c7={}for ce in b_:gmatch'.'do table.insert(c7,ce)end;local c8={}local c9=#c5[c7[1]][1]for cL=1,c9 do local ce={}for cg=1,#c7 do ce[cg]=c5[c7[cg]]and c5[c7[cg]][1][cL]or''end;c8[cL]=table.concat(ce)end;local ca={}local cb={}local cc={['0']=c3,['1']=c4}local cd={['0']=c4,['1']=c3}for cL=1,c9 do local ce={}local ck={}for cg=1,#c7 do local cl=c5[c7[cg]]and c5[c7[cg]][2][cL]or''ce[cg]=cl:gsub('[01]',c2 and{['0']=c0:sub(cg,cg),['1']=c1:sub(cg,cg)}or cc)ck[cg]=cl:gsub('[01]',c2 and{['0']=c1:sub(cg,cg),['1']=c0:sub(cg,cg)}or cd)end;ca[cL]=table.concat(ce)cb[cL]=table.concat(ck)end;return{c8,ca,cb}end;return bY end;as['libraries']['layout']=function(...)local function cf(bR)local bS={}bS.___value=nil;bS.___name=bR;bS.___children={}bS.___props={}function bS:value()return self.___value end;function bS:setValue(bT)self.___value=bT end;function bS:name()return self.___name end;function bS:setName(bT)self.___name=bT end;function bS:children()return self.___children end;function bS:numChildren()return#self.___children end;function bS:addChild(bT)if self[bT:name()]~=nil then if type(self[bT:name()].name)=='function'then local bU={}table.insert(bU,self[bT:name()])self[bT:name()]=bU end;table.insert(self[bT:name()],bT)else self[bT:name()]=bT end;table.insert(self.___children,bT)end;function bS:properties()return self.___props end;function bS:numProperties()return#self.___props end;function bS:addProperty(bT,bU)local bV='@'..bT;if self[bV]~=nil then if type(self[bV])=='string'then local bW={}table.insert(bW,self[bV])self[bV]=bW end;table.insert(self[bV],bU)else self[bV]=bU end;table.insert(self.___props,{name=bT,value=self[bT]})end;return bS end;local c6={}function c6:ToXmlString(bR)bR=string.gsub(bR,'&','&amp;')bR=string.gsub(bR,'<','&lt;')bR=string.gsub(bR,'>','&gt;')bR=string.gsub(bR,'"','&quot;')bR=string.gsub(bR,'([^%w%&%;%p%\t% ])',function(bS)return string.format('&#x%X;',string.byte(bS))end)return bR end;function c6:FromXmlString(bR)bR=string.gsub(bR,'&#x([%x]+)%;',function(bS)return string.char(tonumber(bS,16))end)bR=string.gsub(bR,'&#([0-9]+)%;',function(bS)return string.char(tonumber(bS,10))end)bR=string.gsub(bR,'&quot;','"')bR=string.gsub(bR,'&apos;','\'')bR=string.gsub(bR,'&gt;','>')bR=string.gsub(bR,'&lt;','<')bR=string.gsub(bR,'&amp;','&')return bR end;function c6:ParseArgs(bR,bS)string.gsub(bS,'(%w+)=(["\'])(.-)%2',function(bT,bU,bV)bR:addProperty(bT,self:FromXmlString(bV))end)end;function c6:ParseXmlText(bR)local bS={}local bT=cf()table.insert(bS,bT)local bU,bV,bW,bX,bY;local bZ,b_=1,1;while true do bU,b_,bV,bW,bX,bY=string.find(bR,'<(%/?)([%w_:]+)(.-)(%/?)>',bZ)if not bU then break end;local c1=string.sub(bR,bZ,bU-1)if not string.find(c1,'^%s*$')then local c2=(bT:value()or'')..self:FromXmlString(c1)bS[#bS]:setValue(c2)end;if bY=='/'then local c2=cf(bW)self:ParseArgs(c2,bX)bT:addChild(c2)elseif bV==''then local c2=cf(bW)self:ParseArgs(c2,bX)table.insert(bS,c2)bT=c2 else local c2=table.remove(bS)bT=bS[#bS]if#bS<1 then error('XmlParser: nothing to close with '..bW)end;if c2:name()~=bW then error('XmlParser: trying to close '..c2.name..' with '..bW)end;bT:addChild(c2)end;bZ=b_+1 end;local c0=string.sub(bR,bZ)if#bS>1 then error('XmlParser: unclosed '..bS[#bS]:name())end;return bT end;function c6:loadFile(bR,bS)if not bS then bS=system.ResourceDirectory end;local bT=system.pathForFile(bR,bS)local bU,bV=io.open(bT,'r')if bU and not bV then local bW=bU:read'*a'io.close(bU)return self:ParseXmlText(bW),nil else print(bV)return nil end end;return c6 end;as['libraries']['module']=function(...)return function(cJ)local av,cf=pcall(require,cJ)return av and cf or nil end end;as['libraries']['process']=function(...)local c6={}local bR={}local bS=0;function bR:new(bT,bU,...)local bV={...}local bW=setmetatable({path=bT},{__index=self})bW.window=bU;bW.processId=bS;if type(bT)=='string'then bW.coroutine=coroutine.create(function()shell.run(bT)end)elseif type(bT)=='function'then bW.coroutine=coroutine.create(function()bT(table.unpack(bV))end)else return end;c6[bS]=bW;bS=bS+1;return bW end;function bR:resume(bT,...)term.redirect(self.window)if self.filter~=nil then if bT~=self.filter then return end;self.filter=nil end;local bU,bV=coroutine.resume(self.coroutine,bT,...)if bU then self.filter=bV else error(bV)end end;function bR:isDead()if self.coroutine~=nil then if coroutine.status(self.coroutine)=='dead'then table.remove(c6,self.processId)return true end else return true end;return false end;function bR:getStatus()if self.coroutine~=nil then return coroutine.status(self.coroutine)end;return nil end;function bR:start()coroutine.resume(self.coroutine)end;return bR end;as['libraries']['tHex']=function(...)return{[colors.white]='0',[colors.orange]='1',[colors.magenta]='2',[colors.lightBlue]='3',[colors.yellow]='4',[colors.lime]='5',[colors.pink]='6',[colors.gray]='7',[colors.lightGray]='8',[colors.cyan]='9',[colors.purple]='a',[colors.blue]='b',[colors.brown]='c',[colors.green]='d',[colors.red]='e',[colors.black]='f'}end;as['libraries']['utils']=function(...)local av=function(cf,c6)if c6==nil then c6='%s'end;local bR={}for bS in string.gmatch(cf,'([^'..c6 ..']+)')do table.insert(bR,bS)end;return bR end;return{getTextHorizontalAlign=function(cf,c6,bR,bS)cf=string.sub(cf,1,c6)local bT=c6-string.len(cf)if bR=='right'then cf=string.rep(bS or' ',bT)..cf elseif bR=='center'then cf=string.rep(bS or' ',math.floor(bT/2))..cf..string.rep(bS or' ',math.floor(bT/2))cf=cf..(string.len(cf)<c6 and(bS or' ')or'')else cf=cf..string.rep(bS or' ',bT)end;return cf end,getTextVerticalAlign=function(cf,c6)local bR=0;if c6=='center'then bR=math.ceil(cf/2)if bR<1 then bR=1 end end;if c6=='bottom'then bR=cf end;if bR<1 then bR=1 end;return bR end,rpairs=function(cf)return function(c6,bR)bR=bR-1;if bR~=0 then return bR,c6[bR]end end,cf,#cf+1 end,tableCount=function(cf)local c6=0;if cf~=nil then for bR,bS in pairs(cf)do c6=c6+1 end end;return c6 end,splitString=av,createText=function(cf,c6)local bR=av(cf,'\n')local bS={}for bT,bU in pairs(bR)do local bV=''local bW=av(bU,' ')for bX,bY in pairs(bW)do if#bV+#bY<=c6 then bV=bV==''and bY or bV..' '..bY;if bX==#bW then table.insert(bS,bV)end else table.insert(bS,bV)bV=bY:sub(1,c6)if bX==#bW then table.insert(bS,bV)end end end end;return bS end,getValueFromXML=function(cf,c6)local bR;if type(c6)~='table'then return end;if c6[cf]~=nil then if type(c6[cf])=='table'then if c6[cf].value~=nil then bR=c6[cf]:value()end end end;if bR==nil then bR=c6['@'..cf]end;if bR=='true'then bR=true elseif bR=='false'then bR=false elseif tonumber(bR)~=nil then bR=tonumber(bR)end;return bR end,numberFromString=function(cf)return load('return '..cf)()end,uuid=function()local cf=math.random;local function c6()local bR='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'return string.gsub(bR,'[xy]',function(bS)local bT=bS=='x'and cf(0,0xf)or cf(8,0xb)return string.format('%x',bT)end)end;return c6()end}end;as['default']['Frame']=function(...)local c0=require'module'local c1=require'Object'local c2=require'loadObjects'local c3=require'basaltDraw'local c4=require'utils'local c5=c0'layout'local c7=c0'basaltMon'local c8=c4.uuid;local c9=c4.rpairs;local ca=c4.getValueFromXML;local cb=c4.tableCount;local cc,cd,ce=string.sub,math.min,math.max;return function(ck,cl,ci,cj)local cr=c1(ck)local cs='Frame'local ct={}local cq={}local cu={}local cv={}local cw={}local cx={}local cy={}local cz={}local cA=0;local cB=ci or term.current()local cC=''local cD=false;local cE=false;local ay=false;local az=0;local aA=0;local aB=false;local aC=0;local aD=false;local aE=false;local aF=''local aG=false;local aK=false;local aL;local aM;local aN=true;local aO=true;local aP=false;local aQ={}cr:setZIndex(10)local aR=c3(cB)local aS=false;local aT=1;local aU=1;local aV=colors.white;local aW,aX=0,0;local aY={}local function aZ(bf,bg)if bg~=nil then bg:setValuesByXMLData(bf)end end;local function a_(bf,bg,bi)if bf~=nil then if bf.properties~=nil then bf={bf}end;for bj,bk in pairs(bf)do local bl=bg(bi,bk['@id']or c8())table.insert(aY,bl)aZ(bk,bl)end end end;local function b0(bf)for bg,bi in pairs(ct)do for bj,bk in pairs(bi)do if bk:getName()==bf then return bk end end end end;local function b1(bf)local bg=b0(bf)if bg~=nil then return bg end;for bi,bj in pairs(ct)do for bk,bl in pairs(bj)do if bl:getType()=='Frame'then local aH=bl:getDeepObject(bf)if aH~=nil then return aH end end end end end;local function b2(bf)local bg=bf:getZIndex()if b0(bf.name)~=nil then return nil end;if ct[bg]==nil then for x=1,#cq+1 do if cq[x]~=nil then if bg==cq[x]then break end;if bg>cq[x]then table.insert(cq,x,bg)break end else table.insert(cq,bg)end end;if#cq<=0 then table.insert(cq,bg)end;ct[bg]={}end;bf.parent=cu;if bf.init~=nil then bf:init()end;table.insert(ct[bg],bf)return bf end;local function b3(bf,bg)for bi,bj in pairs(cv)do for bk,bl in pairs(bj)do for aH,aI in pairs(bl)do if aI==bg then table.remove(cv[bi][bk],aH)if bf.parent~=nil then if cb(cv[bi])<=0 then bf.parent:removeEvent(bi,bf)end end end end end end end;local function b4(bf,bg)for bi,bj in pairs(ct)do for bk,bl in pairs(bj)do if type(bg)=='string'then if bl:getName()==bg then table.remove(ct[bi],bk)b3(cu,bl)bf:updateDraw()return true end else if bl==bg then table.remove(ct[bi],bk)b3(cu,bl)bf:updateDraw()return true end end end end;return false end;local function b5(bf,bg,bi)for bj,bk in pairs(cv[bg])do for bl,aH in pairs(bk)do if aH:getName()==bi then return aH end end end end;local function b6(bf,bg,bi)local bj=bi:getZIndex()if cv[bg]==nil then cv[bg]={}end;if cw[bg]==nil then cw[bg]={}end;if b5(bf,bg,bi.name)~=nil then return nil end;if bf.parent~=nil then bf.parent:addEvent(bg,bf)end;aQ[bg]=true;if cv[bg][bj]==nil then for x=1,#cw[bg]+1 do if cw[bg][x]~=nil then if bj==cw[bg][x]then break end;if bj>cw[bg][x]then table.insert(cw[bg],x,bj)break end else table.insert(cw[bg],bj)end end;if#cw[bg]<=0 then table.insert(cw[bg],bj)end;cv[bg][bj]={}end;table.insert(cv[bg][bj],bi)return bi end;local function b7(bf,bg,bi)if cv[bg]~=nil then for bj,bk in pairs(cv[bg])do for bl,aH in pairs(bk)do if aH==bi then table.remove(cv[bg][bj],bl)if#cv[bg][bj]<=0 then cv[bg][bj]=nil;if bf.parent~=nil then if cb(cv[bg])<=0 then aQ[bg]=false;bf.parent:removeEvent(bg,bf)end end end;return true end end end end;return false end;local function b8(bf)local bg,bi=pcall(load('return '..bf))if not bg then error(bf..' is not a valid dynamic code')end;return load('return '..bf)()end;local function b9(bf,bg,bi)for bj,bk in pairs(cz)do if bk[2]==bi and bk[4]==bg then return bk end end;cA=cA+1;cz[cA]={0,bi,{},bg,cA}return cz[cA]end;local function ba(bf,bg)local bi={}local bj={}for bk in bg:gmatch'%a+%.x'do local bl=bk:gsub('%.x','')if bl~='self'and bl~='parent'then table.insert(bi,bl)end end;for bk in bg:gmatch'%w+%.y'do local bl=bk:gsub('%.y','')if bl~='self'and bl~='parent'then table.insert(bi,bl)end end;for bk in bg:gmatch'%a+%.w'do local bl=bk:gsub('%.w','')if bl~='self'and bl~='parent'then table.insert(bi,bl)end end;for bk in bg:gmatch'%a+%.h'do local bl=bk:gsub('%.h','')if bl~='self'and bl~='parent'then table.insert(bi,bl)end end;for bk,bl in pairs(bi)do bj[bl]=b0(bl)if bj[bl]==nil then error('Dynamic Values - unable to find object '..bl)end end;bj['self']=bf;bj['parent']=bf:getParent()return bj end;local function bb(bf,bg)local bi=bf;for bj in bf:gmatch'%w+%.x'do bi=bi:gsub(bj,bg[bj:gsub('%.x','')]:getX())end;for bj in bf:gmatch'%w+%.y'do bi=bi:gsub(bj,bg[bj:gsub('%.y','')]:getY())end;for bj in bf:gmatch'%w+%.w'do bi=bi:gsub(bj,bg[bj:gsub('%.w','')]:getWidth())end;for bj in bf:gmatch'%w+%.h'do bi=bi:gsub(bj,bg[bj:gsub('%.h','')]:getHeight())end;return bi end;local function bc(bf)if#cz>0 then for bE=1,cA do if cz[bE]~=nil then local bg;if#cz[bE][3]<=0 then cz[bE][3]=ba(cz[bE][4],cz[bE][2])end;bg=bb(cz[bE][2],cz[bE][3])cz[bE][1]=b8(bg)if cz[bE][4]:getType()=='Frame'then cz[bE][4]:recalculateDynamicValues()end end end;for bg,bi in pairs(cq)do if ct[bi]~=nil then for bj,bk in pairs(ct[bi])do if bk.eventHandler~=nil then bk:eventHandler('dynamicValueEvent',bf)end end end end end end;local function bd(bf)return cz[bf][1]end;local function be(bf)for bg,bi in pairs(ct)do for bj,bk in pairs(bi)do if bk.getHeight~=nil and bk.getY~=nil then local bl,aH=bk:getHeight(),bk:getY()if bl+aH-bf:getHeight()>aC then aC=ce(bl+aH-bf:getHeight(),0)end end end end end;cu={barActive=false,barBackground=colors.gray,barTextcolor=colors.black,barText='New Frame',barTextAlign='left',addEvent=b6,removeEvent=b7,removeEvents=b3,getEvent=b5,newDynamicValue=b9,recalculateDynamicValues=bc,getDynamicValue=bd,getType=function(bf)return cs end,setFocusedObject=function(bf,bg)if aM~=bg then if aM~=nil then aM:loseFocusHandler()end;if bg~=nil then bg:getFocusHandler()end;aM=bg end;return bf end,getVariable=function(bf,bg)return cj.getVariable(bg)end,setSize=function(bf,bg,bi,bj)cr.setSize(bf,bg,bi,bj)if bf.parent==nil then aR=c3(cB)end;for bk,bl in pairs(cq)do if ct[bl]~=nil then for aH,aI in pairs(ct[bl])do if aI.eventHandler~=nil then aI:eventHandler('basalt_resize',aI,bf)end end end end;bf:recalculateDynamicValues()aN=false;return bf end,setTheme=function(bf,bg,bi)if type(bg)=='table'then cy=bg elseif type(bg)=='string'then cy[bg]=bi end;bf:updateDraw()return bf end,getTheme=function(bf,bg)return cy[bg]or(bf.parent~=nil and bf.parent:getTheme(bg)or cj.getTheme(bg))end,setPosition=function(bf,bg,bi,bj)cr.setPosition(bf,bg,bi,bj)for bk,bl in pairs(cq)do if ct[bl]~=nil then for aH,aI in pairs(ct[bl])do if aI.eventHandler~=nil then aI:eventHandler('basalt_reposition',aI,bf)end end end end;bf:recalculateDynamicValues()return bf end,getBasaltInstance=function(bf)return cj end,setOffset=function(bf,bg,bi)aW=bg~=nil and math.floor(bg<0 and math.abs(bg)or-bg)or aW;aX=bi~=nil and math.floor(bi<0 and math.abs(bi)or-bi)or aX;bf:updateDraw()return bf end,getOffsetInternal=function(bf)return aW,aX end,getOffset=function(bf)return aW<0 and math.abs(aW)or-aW,aX<0 and math.abs(aX)or-aX end,removeFocusedObject=function(bf)if aM~=nil then aM:loseFocusHandler()end;aM=nil;return bf end,getFocusedObject=function(bf)return aM end,setCursor=function(bf,bg,bi,bj,bk)if bf.parent~=nil then local bl,aH=bf:getAnchorPosition()bf.parent:setCursor(bg or false,(bi or 0)+bl-1,(bj or 0)+aH-1,bk or aV)else local bl,aH=bf:getAbsolutePosition(bf:getAnchorPosition(bf:getX(),bf:getY(),true))aS=bg or false;if bi~=nil then aT=bl+bi-1 end;if bj~=nil then aU=aH+bj-1 end;aV=bk or aV;if aS then cB.setTextColor(aV)cB.setCursorPos(aT,aU)cB.setCursorBlink(aS)else cB.setCursorBlink(false)end end;return bf end,setMovable=function(bf,bg)if bf.parent~=nil then aG=bg or not aG;bf.parent:addEvent('mouse_click',bf)aQ['mouse_click']=true;bf.parent:addEvent('mouse_up',bf)aQ['mouse_up']=true;bf.parent:addEvent('mouse_drag',bf)aQ['mouse_drag']=true end;return bf end,setScrollable=function(bf,bg)aB=(bg or bg==nil)and true or false;if bf.parent~=nil then bf.parent:addEvent('mouse_scroll',bf)end;aQ['mouse_scroll']=true;return bf end,setScrollAmount=function(bf,bg)aC=bg or aC;aO=false;return bf end,getScrollAmount=function(bf)return aO and be(bf)or aC end,show=function(bf)cr.show(bf)if bf.parent==nil then cj.setActiveFrame(bf)if cD and not cE then cj.setMonitorFrame(cC,bf)elseif cE then cj.setMonitorFrame(bf:getName(),bf,cC)else cj.setMainFrame(bf)end end;return bf end,hide=function(bf)cr.hide(bf)if bf.parent==nil then if activeFrame==bf then activeFrame=nil end;if cD and not cE then if cj.getMonitorFrame(cC)==bf then cj.setActiveFrame(nil)end elseif cE then if cj.getMonitorFrame(bf:getName())==bf then cj.setActiveFrame(nil)end else if cj.getMainFrame()==bf then cj.setMainFrame(nil)end end end;return bf end,addLayout=function(bf,bg)if bg~=nil then if fs.exists(bg)then local bi=fs.open(bg,'r')local bj=c5:ParseXmlText(bi.readAll())bi.close()aY={}bf:setValuesByXMLData(bj)end end;return bf end,getLastLayout=function(bf)return aY end,addLayoutFromString=function(bf,bg)if bg~=nil then local bi=c5:ParseXmlText(bg)bf:setValuesByXMLData(bi)end;return bf end,setValuesByXMLData=function(bf,bg)cr.setValuesByXMLData(bf,bg)if ca('movable',bg)~=nil then if ca('movable',bg)then bf:setMovable(true)end end;if ca('scrollable',bg)~=nil then if ca('scrollable',bg)then bf:setScrollable(true)end end;if ca('monitor',bg)~=nil then bf:setMonitor(ca('monitor',bg)):show()end;if ca('mirror',bg)~=nil then bf:setMirror(ca('mirror',bg))end;if ca('bar',bg)~=nil then if ca('bar',bg)then bf:showBar(true)else bf:showBar(false)end end;if ca('barText',bg)~=nil then bf.barText=ca('barText',bg)end;if ca('barBG',bg)~=nil then bf.barBackground=colors[ca('barBG',bg)]end;if ca('barFG',bg)~=nil then bf.barTextcolor=colors[ca('barFG',bg)]end;if ca('barAlign',bg)~=nil then bf.barTextAlign=ca('barAlign',bg)end;if ca('layout',bg)~=nil then bf:addLayout(ca('layout',bg))end;if ca('xOffset',bg)~=nil then bf:setOffset(ca('xOffset',bg),aX)end;if ca('yOffset',bg)~=nil then bf:setOffset(aX,ca('yOffset',bg))end;if ca('scrollAmount',bg)~=nil then bf:setScrollAmount(ca('scrollAmount',bg))end;local bi=bg:children()for bj,bk in pairs(bi)do if bk.___name~='animation'then local bl=bk.___name:gsub('^%l',string.upper)if c2[bl]~=nil then a_(bk,bf['add'..bl],bf)end end end;a_(bg['frame'],bf.addFrame,bf)a_(bg['animation'],bf.addAnimation,bf)return bf end,showBar=function(bf,bg)bf.barActive=bg or not bf.barActive;bf:updateDraw()return bf end,setBar=function(bf,bg,bi,bj)bf.barText=bg or''bf.barBackground=bi or bf.barBackground;bf.barTextcolor=bj or bf.barTextcolor;bf:updateDraw()return bf end,setBarTextAlign=function(bf,bg)bf.barTextAlign=bg or'left'bf:updateDraw()return bf end,setMirror=function(bf,bg)if bf.parent~=nil then error'Frame has to be a base frame in order to attach a mirror.'end;aF=bg;if mirror~=nil then aR.setMirror(mirror)end;aD=true;return bf end,removeMirror=function(bf)mirror=nil;aD=false;aR.setMirror(nil)return bf end,setMonitorScale=function(bf,bg)if cD then cB.setTextScale(bg)end;return bf end,setMonitor=function(bf,bg,bi)if bg~=nil and bg~=false then if type(bg)=='string'then if peripheral.getType(bg)=='monitor'then cB=peripheral.wrap(bg)ay=true end;if bf.parent~=nil then bf.parent:removeObject(bf)end;cD=true;cj.setMonitorFrame(bg,bf)elseif type(bg)=='table'then cB=c7(bg)ay=true;cD=true;cE=true;cj.setMonitorFrame(bf:getName(),bf,true)end else cB=parentTerminal;cD=false;cE=false;if type(cC)=='string'then if cj.getMonitorFrame(cC)==bf then cj.setMonitorFrame(cC,nil)end else if cj.getMonitorFrame(bf:getName())==bf then cj.setMonitorFrame(bf:getName(),nil)end end end;if bi~=nil then cB.setTextScale(bi)end;aR=c3(cB)bf:setSize(cB.getSize())aN=true;cC=bg or nil;bf:updateDraw()return bf end,loseFocusHandler=function(bf)cr.loseFocusHandler(bf)if aM~=nil then aM:loseFocusHandler()aM=nil end end,getFocusHandler=function(bf)cr.getFocusHandler(bf)if bf.parent~=nil then if aG then bf.parent:removeEvents(bf)bf.parent:removeObject(bf)bf.parent:addObject(bf)for bg,bi in pairs(aQ)do if bi then bf.parent:addEvent(bg,bf)end end;bf:updateDraw()end end;if aM~=nil then aM:getFocusHandler()end end,eventHandler=function(bf,bg,...)cr.eventHandler(bf,bg,...)if cv['other_event']~=nil then for bi,bj in ipairs(cw['other_event'])do if cv['other_event'][bj]~=nil then for bk,bl in c9(cv['other_event'][bj])do if bl.eventHandler~=nil then if bl:eventHandler(bg,...)then return true end end end end end end;if aN and not cD then if bf.parent==nil then if bg=='term_resize'then bf:setSize(cB.getSize())aN=true end end end;if cD then if aN then if bg=='monitor_resize'then if type(cC)=='string'then bf:setSize(cB.getSize())elseif type(cC)=='table'then for bi,bj in pairs(cC)do for bk,bl in pairs(bj)do if p1==bl then bf:setSize(cB.getSize())end end end end;aN=true;bf:updateDraw()end end;if bg=='peripheral'and p1==cC then if peripheral.getType(cC)=='monitor'then ay=true;cB=peripheral.wrap(cC)aR=c3(cB)bf:updateDraw()end end;if bg=='peripheral_detach'and p1==cC then ay=false end end;if aD then if peripheral.getType(aF)=='monitor'then aE=true;aR.setMirror(peripheral.wrap(aF))end;if bg=='peripheral_detach'and p1==aF then ay=false end;if bg=='monitor_touch'and aF==p1 then bf:mouseHandler(1,p2,p3,true)end end;if bg=='terminate'and bf.parent==nil then cj.stop()end end,mouseHandler=function(bf,bg,bi,bj,bk,bl)if cE then if cB.calculateClick~=nil then bi,bj=cB.calculateClick(bl,bi,bj)end end;if cr.mouseHandler(bf,bg,bi,bj)then if cv['mouse_click']~=nil then bf:setCursor(false)for aH,aI in ipairs(cw['mouse_click'])do if cv['mouse_click'][aI]~=nil then for aJ,bh in c9(cv['mouse_click'][aI])do if bh.mouseHandler~=nil then if bh:mouseHandler(bg,bi,bj)then return true end end end end end end;if aG then local aH,aI=bf:getAbsolutePosition(bf:getAnchorPosition())if bi>=aH and bi<=aH+bf:getWidth()-1 and bj==aI then aK=true;az=aH-bi;aA=yOff and 1 or 0 end end;bf:removeFocusedObject()return true end;return false end,mouseUpHandler=function(bf,bg,bi,bj)if aK then aK=false end;if cr.mouseUpHandler(bf,bg,bi,bj)then if cv['mouse_up']~=nil then for bk,bl in ipairs(cw['mouse_up'])do if cv['mouse_up'][bl]~=nil then for aH,aI in c9(cv['mouse_up'][bl])do if aI.mouseUpHandler~=nil then if aI:mouseUpHandler(bg,bi,bj)then return true end end end end end end;return true end;return false end,scrollHandler=function(bf,bg,bi,bj)if cr.scrollHandler(bf,bg,bi,bj)then if cv['mouse_scroll']~=nil then for bl,aH in pairs(cw['mouse_scroll'])do if cv['mouse_scroll'][aH]~=nil then for aI,aJ in c9(cv['mouse_scroll'][aH])do if aJ.scrollHandler~=nil then if aJ:scrollHandler(bg,bi,bj)then return true end end end end end end;local bk=aX;if aB then be(bf)if bg>0 or bg<0 then aX=ce(cd(aX-bg,0),-aC)bf:updateDraw()end end;bf:removeFocusedObject()if aX==bk then return false end;return true end;return false end,hoverHandler=function(bf,bg,bi,bj)if cr.hoverHandler(bf,bg,bi,bj)then if cv['mouse_move']~=nil then for bk,bl in pairs(cw['mouse_move'])do if cv['mouse_move'][bl]~=nil then for aH,aI in c9(cv['mouse_move'][bl])do if aI.hoverHandler~=nil then if aI:hoverHandler(bg,bi,bj)then return true end end end end end end end;return false end,dragHandler=function(bf,bg,bi,bj)if aK then local bk,bl=bf.parent:getOffsetInternal()bk=bk<0 and math.abs(bk)or-bk;bl=bl<0 and math.abs(bl)or-bl;local aH=1;local aI=1;if bf.parent~=nil then aH,aI=bf.parent:getAbsolutePosition(bf.parent:getAnchorPosition())end;bf:setPosition(bi+az-(aH-1)+bk,bj+aA-(aI-1)+bl)bf:updateDraw()return true end;if bf:isVisible()and bf:isEnabled()then if cv['mouse_drag']~=nil then for bk,bl in ipairs(cw['mouse_drag'])do if cv['mouse_drag'][bl]~=nil then for aH,aI in c9(cv['mouse_drag'][bl])do if aI.dragHandler~=nil then if aI:dragHandler(bg,bi,bj)then return true end end end end end end end;cr.dragHandler(bf,bg,bi,bj)return false end,keyHandler=function(bf,bg,bi)if bf:isFocused()or bf.parent==nil then local bj=bf:getEventSystem():sendEvent('key',bf,'key',bg)if bj==false then return false end;if cv['key']~=nil then for bk,bl in pairs(cw['key'])do if cv['key'][bl]~=nil then for aH,aI in c9(cv['key'][bl])do if aI.keyHandler~=nil then if aI:keyHandler(bg,bi)then return true end end end end end end end;return false end,keyUpHandler=function(bf,bg)if bf:isFocused()or bf.parent==nil then local bi=bf:getEventSystem():sendEvent('key_up',bf,'key_up',bg)if bi==false then return false end;if cv['key_up']~=nil then for bj,bk in pairs(cw['key_up'])do if cv['key_up'][bk]~=nil then for bl,aH in c9(cv['key_up'][bk])do if aH.keyUpHandler~=nil then if aH:keyUpHandler(bg)then return true end end end end end end end;return false end,charHandler=function(bf,bg)if bf:isFocused()or bf.parent==nil then local bi=bf:getEventSystem():sendEvent('char',bf,'char',bg)if bi==false then return false end;if cv['char']~=nil then for bj,bk in pairs(cw['char'])do if cv['char'][bk]~=nil then for bl,aH in c9(cv['char'][bk])do if aH.charHandler~=nil then if aH:charHandler(bg)then return true end end end end end end end;return false end,setText=function(bf,bg,bi,bj)local bk,bl=bf:getAnchorPosition()if bi>=1 and bi<=bf:getHeight()then if bf.parent~=nil then bf.parent:setText(ce(bg+bk-1,bk),bl+bi-1,cc(bj,ce(1-bg+1,1),ce(bf:getWidth()-bg+1,1)))else aR.setText(ce(bg+bk-1,bk),bl+bi-1,cc(bj,ce(1-bg+1,1),ce(bf:getWidth()-bg+1,1)))end end end,setBG=function(bf,bg,bi,bj)local bk,bl=bf:getAnchorPosition()if bi>=1 and bi<=bf:getHeight()then if bf.parent~=nil then bf.parent:setBG(ce(bg+bk-1,bk),bl+bi-1,cc(bj,ce(1-bg+1,1),ce(bf:getWidth()-bg+1,1)))else aR.setBG(ce(bg+bk-1,bk),bl+bi-1,cc(bj,ce(1-bg+1,1),ce(bf:getWidth()-bg+1,1)))end end end,setFG=function(bf,bg,bi,bj)local bk,bl=bf:getAnchorPosition()if bi>=1 and bi<=bf:getHeight()then if bf.parent~=nil then bf.parent:setFG(ce(bg+bk-1,bk),bl+bi-1,cc(bj,ce(1-bg+1,1),ce(bf:getWidth()-bg+1,1)))else aR.setFG(ce(bg+bk-1,bk),bl+bi-1,cc(bj,ce(1-bg+1,1),ce(bf:getWidth()-bg+1,1)))end end end,writeText=function(bf,bg,bi,bj,bk,bl)local aH,aI=bf:getAnchorPosition()if bi>=1 and bi<=bf:getHeight()then if bf.parent~=nil then bf.parent:writeText(ce(bg+aH-1,aH),aI+bi-1,cc(bj,ce(1-bg+1,1),bf:getWidth()-bg+1),bk,bl)else aR.writeText(ce(bg+aH-1,aH),aI+bi-1,cc(bj,ce(1-bg+1,1),ce(bf:getWidth()-bg+1,1)),bk,bl)end end end,blit=function(bf,bg,bi,bj,bk,bl)local aH,aI=bf:getAnchorPosition()if bi>=1 and bi<=bf:getHeight()then local aJ=bf:getWidth()if bf.parent~=nil then bj=cc(bj,ce(1-bg+1,1),aJ-bg+1)bk=cc(bk,ce(1-bg+1,1),aJ-bg+1)bl=cc(bl,ce(1-bg+1,1),aJ-bg+1)bf.parent:blit(ce(bg+aH-1,aH),aI+bi-1,bj,bk,bl)else bj=cc(bj,ce(1-bg+1,1),ce(aJ-bg+1,1))bk=cc(bk,ce(1-bg+1,1),ce(aJ-bg+1,1))bl=cc(bl,ce(1-bg+1,1),ce(aJ-bg+1,1))aR.blit(ce(bg+aH-1,aH),aI+bi-1,bj,bk,bl)end end end,drawBackgroundBox=function(bf,bg,bi,bj,bk,bl)local aH,aI=bf:getAnchorPosition()bk=bi<1 and(bk+bi>bf:getHeight()and bf:getHeight()or bk+bi-1)or(bk+bi>bf:getHeight()and bf:getHeight()-bi+1 or bk)bj=bg<1 and(bj+bg>bf:getWidth()and bf:getWidth()or bj+bg-1)or(bj+bg>bf:getWidth()and bf:getWidth()-bg+1 or bj)if bf.parent~=nil then bf.parent:drawBackgroundBox(ce(bg+aH-1,aH),ce(bi+aI-1,aI),bj,bk,bl)else aR.drawBackgroundBox(ce(bg+aH-1,aH),ce(bi+aI-1,aI),bj,bk,bl)end end,drawTextBox=function(bf,bg,bi,bj,bk,bl)local aH,aI=bf:getAnchorPosition()bk=bi<1 and(bk+bi>bf:getHeight()and bf:getHeight()or bk+bi-1)or(bk+bi>bf:getHeight()and bf:getHeight()-bi+1 or bk)bj=bg<1 and(bj+bg>bf:getWidth()and bf:getWidth()or bj+bg-1)or(bj+bg>bf:getWidth()and bf:getWidth()-bg+1 or bj)if bf.parent~=nil then bf.parent:drawTextBox(ce(bg+aH-1,aH),ce(bi+aI-1,aI),bj,bk,cc(bl,1,1))else aR.drawTextBox(ce(bg+aH-1,aH),ce(bi+aI-1,aI),bj,bk,cc(bl,1,1))end end,drawForegroundBox=function(bf,bg,bi,bj,bk,bl)local aH,aI=bf:getAnchorPosition()bk=bi<1 and(bk+bi>bf:getHeight()and bf:getHeight()or bk+bi-1)or(bk+bi>bf:getHeight()and bf:getHeight()-bi+1 or bk)bj=bg<1 and(bj+bg>bf:getWidth()and bf:getWidth()or bj+bg-1)or(bj+bg>bf:getWidth()and bf:getWidth()-bg+1 or bj)if bf.parent~=nil then bf.parent:drawForegroundBox(ce(bg+aH-1,aH),ce(bi+aI-1,aI),bj,bk,bl)else aR.drawForegroundBox(ce(bg+aH-1,aH),ce(bi+aI-1,aI),bj,bk,bl)end end,draw=function(bf,bg)if cD and not ay then return false end;if bf.parent==nil then if bf:getDraw()==false then return false end end;if cr.draw(bf)then local bi,bj=bf:getAbsolutePosition(bf:getAnchorPosition())local bk,bl=bf:getAnchorPosition()local aH,aI=bf:getSize()if bf.parent==nil then if bf.bgColor~=false then aR.drawBackgroundBox(bk,bl,aH,aI,bf.bgColor)aR.drawTextBox(bk,bl,aH,aI,' ')end;if bf.fgColor~=false then aR.drawForegroundBox(bk,bl,aH,aI,bf.fgColor)end end;if bf.barActive then if bf.parent~=nil then bf.parent:writeText(bk,bl,c4.getTextHorizontalAlign(bf.barText,aH,bf.barTextAlign),bf.barBackground,bf.barTextcolor)else aR.writeText(bk,bl,c4.getTextHorizontalAlign(bf.barText,aH,bf.barTextAlign),bf.barBackground,bf.barTextcolor)end;if bf:getBorder'left'then if bf.parent~=nil then bf.parent:drawBackgroundBox(bk-1,bl,1,1,bf.barBackground)if bf.bgColor~=false then bf.parent:drawBackgroundBox(bk-1,bl+1,1,aI-1,bf.bgColor)end end end;if bf:getBorder'top'then if bf.parent~=nil then bf.parent:drawBackgroundBox(bk-1,bl-1,aH+1,1,bf.barBackground)end end end;for aJ,bh in c9(cq)do if ct[bh]~=nil then for bm,bn in pairs(ct[bh])do if bn.draw~=nil then bn:draw()end end end end end end,updateTerm=function(bf)if cD and not ay then return false end;aR.update()end,addObject=function(bf,bg)return b2(bg)end,removeObject=b4,getObject=function(bf,bg)return b0(bg)end,getDeepObject=function(bf,bg)return b1(bg)end,addFrame=function(bf,bg)local bi=cj.newFrame(bg or c8(),bf,nil,cj)return b2(bi)end,init=function(bf)if not aP then if cl~=nil then cr.width,cr.height=cl:getSize()bf:setBackground(cl:getTheme'FrameBG')bf:setForeground(cl:getTheme'FrameText')else cr.width,cr.height=cB.getSize()bf:setBackground(cj.getTheme'BasaltBG')bf:setForeground(cj.getTheme'BasaltText')end;aP=true end end}for bf,bg in pairs(c2)do cu['add'..bf]=function(bi,bj)return b2(bg(bj or c8(),bi))end end;setmetatable(cu,cr)return cu end end;as['default']['loadObjects']=function(...)local c6={}if at then for bT,bU in pairs(aw'objects')do c6[bT]=bU()end;return c6 end;local bR=table.pack(...)local bS=fs.getDir(bR[2]or'Basalt')if bS==nil then error('Unable to find directory '..bR[2]..' please report this bug to our discord.')end;for bT,bU in pairs(fs.list(fs.combine(bS,'objects')))do if bU~='example.lua'then local bV=bU:gsub('.lua','')c6[bV]=require(bV)end end;return c6 end;as['default']['Object']=function(...)local bS=require'basaltEvent'local bT=require'utils'local bU=bT.splitString;local bV=bT.numberFromString;local bW=bT.getValueFromXML;return function(bX)local bY='Object'local bZ={}local b_=1;local c0;local c1='topLeft'local c2=false;local c3=true;local c4=false;local c5=false;local c7=false;local c8=false;local c9={left=false,right=false,top=false,bottom=false}local ca=colors.black;local cb=true;local cc=false;local cd,ce,ck,cl=0,0,0,0;local ci=true;local cj={}local cr=bS()bZ={x=1,y=1,width=1,height=1,bgColor=colors.black,bgSymbol=' ',bgSymbolColor=colors.black,fgColor=colors.white,transparentColor=false,name=bX or'Object',parent=nil,show=function(cs)c3=true;cs:updateDraw()return cs end,hide=function(cs)c3=false;cs:updateDraw()return cs end,enable=function(cs)cb=true;return cs end,disable=function(cs)cb=false;return cs end,isEnabled=function(cs)return cb end,generateXMLEventFunction=function(cs,ct,cq)local cu=function(cv)if cv:sub(1,1)=='#'then local cw=cs:getBaseFrame():getDeepObject(cv:sub(2,cv:len()))if cw~=nil and cw.internalObjetCall~=nil then ct(cs,function()cw:internalObjetCall()end)end else ct(cs,cs:getBaseFrame():getVariable(cv))end end;if type(cq)=='string'then cu(cq)elseif type(cq)=='table'then for cv,cw in pairs(cq)do cu(cw)end end;return cs end,setValuesByXMLData=function(cs,ct)local cq=cs:getBaseFrame()if bW('x',ct)~=nil then cs:setPosition(bW('x',ct),cs.y)end;if bW('y',ct)~=nil then cs:setPosition(cs.x,bW('y',ct))end;if bW('width',ct)~=nil then cs:setSize(bW('width',ct),cs.height)end;if bW('height',ct)~=nil then cs:setSize(cs.width,bW('height',ct))end;if bW('bg',ct)~=nil then cs:setBackground(colors[bW('bg',ct)])end;if bW('fg',ct)~=nil then cs:setForeground(colors[bW('fg',ct)])end;if bW('value',ct)~=nil then cs:setValue(colors[bW('value',ct)])end;if bW('visible',ct)~=nil then if bW('visible',ct)then cs:show()else cs:hide()end end;if bW('enabled',ct)~=nil then if bW('enabled',ct)then cs:enable()else cs:disable()end end;if bW('zIndex',ct)~=nil then cs:setZIndex(bW('zIndex',ct))end;if bW('anchor',ct)~=nil then cs:setAnchor(bW('anchor',ct))end;if bW('shadowColor',ct)~=nil then cs:setShadow(colors[bW('shadowColor',ct)])end;if bW('border',ct)~=nil then cs:setBorder(colors[bW('border',ct)])end;if bW('borderLeft',ct)~=nil then c9['left']=bW('borderLeft',ct)end;if bW('borderTop',ct)~=nil then c9['top']=bW('borderTop',ct)end;if bW('borderRight',ct)~=nil then c9['right']=bW('borderRight',ct)end;if bW('borderBottom',ct)~=nil then c9['bottom']=bW('borderBottom',ct)end;if bW('borderColor',ct)~=nil then cs:setBorder(colors[bW('borderColor',ct)])end;if bW('ignoreOffset',ct)~=nil then if bW('ignoreOffset',ct)then cs:ignoreOffset(true)end end;if bW('onClick',ct)~=nil then cs:generateXMLEventFunction(cs.onClick,bW('onClick',ct))end;if bW('onClickUp',ct)~=nil then cs:generateXMLEventFunction(cs.onClickUp,bW('onClickUp',ct))end;if bW('onScroll',ct)~=nil then cs:generateXMLEventFunction(cs.onScroll,bW('onScroll',ct))end;if bW('onDrag',ct)~=nil then cs:generateXMLEventFunction(cs.onDrag,bW('onDrag',ct))end;if bW('onHover',ct)~=nil then cs:generateXMLEventFunction(cs.onHover,bW('onHover',ct))end;if bW('onLeave',ct)~=nil then cs:generateXMLEventFunction(cs.onLeave,bW('onLeave',ct))end;if bW('onKey',ct)~=nil then cs:generateXMLEventFunction(cs.onKey,bW('onKey',ct))end;if bW('onKeyUp',ct)~=nil then cs:generateXMLEventFunction(cs.onKeyUp,bW('onKeyUp',ct))end;if bW('onChange',ct)~=nil then cs:generateXMLEventFunction(cs.onChange,bW('onChange',ct))end;if bW('onResize',ct)~=nil then cs:generateXMLEventFunction(cs.onResize,bW('onResize',ct))end;if bW('onReposition',ct)~=nil then cs:generateXMLEventFunction(cs.onReposition,bW('onReposition',ct))end;if bW('onEvent',ct)~=nil then cs:generateXMLEventFunction(cs.onEvent,bW('onEvent',ct))end;if bW('onGetFocus',ct)~=nil then cs:generateXMLEventFunction(cs.onGetFocus,bW('onGetFocus',ct))end;if bW('onLoseFocus',ct)~=nil then cs:generateXMLEventFunction(cs.onLoseFocus,bW('onLoseFocus',ct))end;cs:updateDraw()return cs end,isVisible=function(cs)return c3 end,setFocus=function(cs)if cs.parent~=nil then cs.parent:setFocusedObject(cs)end;return cs end,setZIndex=function(cs,ct)b_=ct;if cs.parent~=nil then cs.parent:removeObject(cs)cs.parent:addObject(cs)cs:updateEventHandlers()end;return cs end,updateEventHandlers=function(cs)for ct,cq in pairs(cj)do if cq then cs.parent:addEvent(ct,cs)end end end,getZIndex=function(cs)return b_ end,getType=function(cs)return bY end,getName=function(cs)return cs.name end,remove=function(cs)if cs.parent~=nil then cs.parent:removeObject(cs)end;cs:updateDraw()return cs end,setParent=function(cs,ct)if ct.getType~=nil and ct:getType()=='Frame'then cs:remove()ct:addObject(cs)if cs.draw then cs:show()end end;return cs end,setValue=function(cs,ct)if c0~=ct then c0=ct;cs:updateDraw()cs:valueChangedHandler()end;return cs end,getValue=function(cs)return c0 end,getDraw=function(cs)return ci end,updateDraw=function(cs,ct)ci=ct;if ct==nil then ci=true end;if ci then if cs.parent~=nil then cs.parent:updateDraw()end end;return cs end,getEventSystem=function(cs)return cr end,getParent=function(cs)return cs.parent end,setPosition=function(cs,ct,cq,cu)if type(ct)=='number'then cs.x=cu and cs:getX()+ct or ct end;if type(cq)=='number'then cs.y=cu and cs:getY()+cq or cq end;if cs.parent~=nil then if type(ct)=='string'then cs.x=cs.parent:newDynamicValue(cs,ct)end;if type(cq)=='string'then cs.y=cs.parent:newDynamicValue(cs,cq)end;cs.parent:recalculateDynamicValues()end;cr:sendEvent('basalt_reposition',cs)cs:updateDraw()return cs end,getX=function(cs)return type(cs.x)=='number'and cs.x or math.floor(cs.x[1]+0.5)end,getY=function(cs)return type(cs.y)=='number'and cs.y or math.floor(cs.y[1]+0.5)end,getPosition=function(cs)return cs:getX(),cs:getY()end,getVisibility=function(cs)return c3 end,setVisibility=function(cs,ct)c3=ct or not c3;cs:updateDraw()return cs end,setSize=function(cs,ct,cq,cu)if type(ct)=='number'then cs.width=cu and cs:getWidth()+ct or ct end;if type(cq)=='number'then cs.height=cu and cs:getHeight()+cq or cq end;if cs.parent~=nil then if type(ct)=='string'then cs.width=cs.parent:newDynamicValue(cs,ct)end;if type(cq)=='string'then cs.height=cs.parent:newDynamicValue(cs,cq)end;cs.parent:recalculateDynamicValues()end;cr:sendEvent('basalt_resize',cs)cs:updateDraw()return cs end,getHeight=function(cs)return type(cs.height)=='number'and cs.height or math.floor(cs.height[1]+0.5)end,getWidth=function(cs)return type(cs.width)=='number'and cs.width or math.floor(cs.width[1]+0.5)end,getSize=function(cs)return cs:getWidth(),cs:getHeight()end,calculateDynamicValues=function(cs)if type(cs.width)=='table'then cs.width:calculate()end;if type(cs.height)=='table'then cs.height:calculate()end;if type(cs.x)=='table'then cs.x:calculate()end;if type(cs.y)=='table'then cs.y:calculate()end;cs:updateDraw()return cs end,setBackground=function(cs,ct,cq,cu)cs.bgColor=ct or false;cs.bgSymbol=cq or(cs.bgColor~=false and cs.bgSymbol or false)cs.bgSymbolColor=cu or cs.bgSymbolColor;cs:updateDraw()return cs end,setTransparent=function(cs,ct)cs.transparentColor=ct or false;cs.bgSymbol=false;cs.bgSymbolColor=false;cs:updateDraw()return cs end,getBackground=function(cs)return cs.bgColor end,setForeground=function(cs,ct)cs.fgColor=ct or false;cs:updateDraw()return cs end,getForeground=function(cs)return cs.fgColor end,setShadow=function(cs,ct)if ct==false then c8=false else ca=ct;c8=true end;cs:updateDraw()return cs end,isShadowActive=function(cs)return c8 end,setBorder=function(cs,...)if...~=nil then local ct={...}for cq,cu in pairs(ct)do if cu=='left'or#ct==1 then c9['left']=ct[1]end;if cu=='top'or#ct==1 then c9['top']=ct[1]end;if cu=='right'or#ct==1 then c9['right']=ct[1]end;if cu=='bottom'or#ct==1 then c9['bottom']=ct[1]end end end;cs:updateDraw()return cs end,getBorder=function(cs,ct)if ct=='left'then return borderLeft end;if ct=='top'then return borderTop end;if ct=='right'then return borderRight end;if ct=='bottom'then return borderBottom end end,draw=function(cs)if c3 then if cs.parent~=nil then local ct,cq=cs:getAnchorPosition()local cu,cv=cs:getSize()local cw,cx=cs.parent:getSize()if ct+cu<1 or ct>cw or cq+cv<1 or cq>cx then return false end;if cs.transparentColor~=false then cs.parent:drawForegroundBox(ct,cq,cu,cv,cs.transparentColor)end;if cs.bgColor~=false then cs.parent:drawBackgroundBox(ct,cq,cu,cv,cs.bgColor)end;if cs.bgSymbol~=false then cs.parent:drawTextBox(ct,cq,cu,cv,cs.bgSymbol)if cs.bgSymbol~=' 'then cs.parent:drawForegroundBox(ct,cq,cu,cv,cs.bgSymbolColor)end end;if c8 then cs.parent:drawBackgroundBox(ct+1,cq+cv,cu,1,ca)cs.parent:drawBackgroundBox(ct+cu,cq+1,1,cv,ca)cs.parent:drawForegroundBox(ct+1,cq+cv,cu,1,ca)cs.parent:drawForegroundBox(ct+cu,cq+1,1,cv,ca)end;local cy=cs.bgColor;if c9['left']~=false then cs.parent:drawTextBox(ct,cq,1,cv,'\149')if cy~=false then cs.parent:drawBackgroundBox(ct,cq,1,cv,cs.bgColor)end;cs.parent:drawForegroundBox(ct,cq,1,cv,c9['left'])end;if c9['top']~=false then cs.parent:drawTextBox(ct,cq,cu,1,'\131')if cy~=false then cs.parent:drawBackgroundBox(ct,cq,cu,1,cs.bgColor)end;cs.parent:drawForegroundBox(ct,cq,cu,1,c9['top'])end;if c9['left']~=false and c9['top']~=false then cs.parent:drawTextBox(ct,cq,1,1,'\151')if cy~=false then cs.parent:drawBackgroundBox(ct,cq,1,1,cs.bgColor)end;cs.parent:drawForegroundBox(ct,cq,1,1,c9['left'])end;if c9['right']~=false then cs.parent:drawTextBox(ct+cu-1,cq,1,cv,'\149')if cy~=false then cs.parent:drawForegroundBox(ct+cu-1,cq,1,cv,cs.bgColor)end;cs.parent:drawBackgroundBox(ct+cu-1,cq,1,cv,c9['right'])end;if c9['bottom']~=false then cs.parent:drawTextBox(ct,cq+cv-1,cu,1,'\143')if cy~=false then cs.parent:drawForegroundBox(ct,cq+cv-1,cu,1,cs.bgColor)end;cs.parent:drawBackgroundBox(ct,cq+cv-1,cu,1,c9['bottom'])end;if c9['top']~=false and c9['right']~=false then cs.parent:drawTextBox(ct+cu-1,cq,1,1,'\148')if cy~=false then cs.parent:drawForegroundBox(ct+cu-1,cq,1,1,cs.bgColor)end;cs.parent:drawBackgroundBox(ct+cu-1,cq,1,1,c9['right'])end;if c9['right']~=false and c9['bottom']~=false then cs.parent:drawTextBox(ct+cu-1,cq+cv-1,1,1,'\133')if cy~=false then cs.parent:drawForegroundBox(ct+cu-1,cq+cv-1,1,1,cs.bgColor)end;cs.parent:drawBackgroundBox(ct+cu-1,cq+cv-1,1,1,c9['right'])end;if c9['bottom']~=false and c9['left']~=false then cs.parent:drawTextBox(ct,cq+cv-1,1,1,'\138')if cy~=false then cs.parent:drawForegroundBox(ct-1,cq+cv-1,1,1,cs.bgColor)end;cs.parent:drawBackgroundBox(ct,cq+cv-1,1,1,c9['left'])end end;ci=false;return true end;return false end,getAbsolutePosition=function(cs,ct,cq)if ct==nil or cq==nil then ct,cq=cs:getAnchorPosition()end;if cs.parent~=nil then local cu,cv=cs.parent:getAbsolutePosition()ct=cu+ct-1;cq=cv+cq-1 end;return ct,cq end,getAnchorPosition=function(cs,ct,cq,cu)if ct==nil then ct=cs:getX()end;if cq==nil then cq=cs:getY()end;if cs.parent~=nil then local cv,cw=cs.parent:getSize()if c1=='top'then ct=math.floor(cv/2)+ct-1 elseif c1=='topRight'then ct=cv+ct-1 elseif c1=='right'then ct=cv+ct-1;cq=math.floor(cw/2)+cq-1 elseif c1=='bottomRight'then ct=cv+ct-1;cq=cw+cq-1 elseif c1=='bottom'then ct=math.floor(cv/2)+ct-1;cq=cw+cq-1 elseif c1=='bottomLeft'then cq=cw+cq-1 elseif c1=='left'then cq=math.floor(cw/2)+cq-1 elseif c1=='center'then ct=math.floor(cv/2)+ct-1;cq=math.floor(cw/2)+cq-1 end;local cx,cy=cs.parent:getOffsetInternal()if not(c2 or cu)then return ct+cx,cq+cy end end;return ct,cq end,ignoreOffset=function(cs,ct)c2=ct;if ct==nil then c2=true end;return cs end,getBaseFrame=function(cs)if cs.parent~=nil then return cs.parent:getBaseFrame()end;return cs end,setAnchor=function(cs,ct)c1=ct;cs:updateDraw()return cs end,getAnchor=function(cs)return c1 end,onChange=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('value_changed',cq)end end;return cs end,onClick=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('mouse_click',cq)end end;if cs.parent~=nil then cs.parent:addEvent('mouse_click',cs)cj['mouse_click']=true;cs.parent:addEvent('mouse_up',cs)cj['mouse_up']=true end;return cs end,onClickUp=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('mouse_up',cq)end end;if cs.parent~=nil then cs.parent:addEvent('mouse_click',cs)cj['mouse_click']=true;cs.parent:addEvent('mouse_up',cs)cj['mouse_up']=true end;return cs end,onRelease=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('mouse_release',cq)end end;if cs.parent~=nil then cs.parent:addEvent('mouse_click',cs)cj['mouse_click']=true;cs.parent:addEvent('mouse_up',cs)cj['mouse_up']=true end;return cs end,onScroll=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('mouse_scroll',cq)end end;if cs.parent~=nil then cs.parent:addEvent('mouse_scroll',cs)cj['mouse_scroll']=true end;return cs end,onHover=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('mouse_hover',cq)end end;if cs.parent~=nil then cs.parent:addEvent('mouse_move',cs)cj['mouse_move']=true end;return cs end,onLeave=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('mouse_leave',cq)end end;if cs.parent~=nil then cs.parent:addEvent('mouse_move',cs)cj['mouse_move']=true end;return cs end,onDrag=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('mouse_drag',cq)end end;if cs.parent~=nil then cs.parent:addEvent('mouse_drag',cs)cj['mouse_drag']=true;cs.parent:addEvent('mouse_click',cs)cj['mouse_click']=true;cs.parent:addEvent('mouse_up',cs)cj['mouse_up']=true end;return cs end,onEvent=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('other_event',cq)end end;if cs.parent~=nil then cs.parent:addEvent('other_event',cs)cj['other_event']=true end;return cs end,onKey=function(cs,...)if cb then for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('key',cq)end end;if cs.parent~=nil then cs.parent:addEvent('key',cs)cj['key']=true end end;return cs end,onChar=function(cs,...)if cb then for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('char',cq)end end;if cs.parent~=nil then cs.parent:addEvent('char',cs)cj['char']=true end end;return cs end,onResize=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('basalt_resize',cq)end end;return cs end,onReposition=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('basalt_reposition',cq)end end;return cs end,onKeyUp=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('key_up',cq)end end;if cs.parent~=nil then cs.parent:addEvent('key_up',cs)cj['key_up']=true end;return cs end,isFocused=function(cs)if cs.parent~=nil then return cs.parent:getFocusedObject()==cs end;return false end,onGetFocus=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('get_focus',cq)end end;if cs.parent~=nil then cs.parent:addEvent('mouse_click',cs)cj['mouse_click']=true end;return cs end,onLoseFocus=function(cs,...)for ct,cq in pairs(table.pack(...))do if type(cq)=='function'then cs:registerEvent('lose_focus',cq)end end;if cs.parent~=nil then cs.parent:addEvent('mouse_click',cs)cj['mouse_click']=true end;return cs end,registerEvent=function(cs,ct,cq)return cr:registerEvent(ct,cq)end,removeEvent=function(cs,ct,cq)return cr:removeEvent(ct,cq)end,sendEvent=function(cs,ct,...)return cr:sendEvent(ct,cs,...)end,isCoordsInObject=function(cs,ct,cq)if c3 and cb then if ct==nil or cq==nil then return false end;local cu,cv=cs:getAbsolutePosition()local cw,cx=cs:getSize()if cu<=ct and cu+cw>ct and cv<=cq and cv+cx>cq then return true end end;return false end,mouseHandler=function(cs,ct,cq,cu,cv)if cs:isCoordsInObject(cq,cu)then local cw,cx=cs:getAbsolutePosition()local cy=cr:sendEvent('mouse_click',cs,'mouse_click',ct,cq-(cw-1),cu-(cx-1),cv)if cy==false then return false end;if cs.parent~=nil then cs.parent:setFocusedObject(cs)end;c7=true;cc=true;cd,ce=cq,cu;return true end;return false end,mouseUpHandler=function(cs,ct,cq,cu)cc=false;if c7 then local cv,cw=cs:getAbsolutePosition()local cx=cr:sendEvent('mouse_release',cs,'mouse_release',ct,cq-(cv-1),cu-(cw-1))c7=false end;if cs:isCoordsInObject(cq,cu)then local cv,cw=cs:getAbsolutePosition()local cx=cr:sendEvent('mouse_up',cs,'mouse_up',ct,cq-(cv-1),cu-(cw-1))if cx==false then return false end;return true end;return false end,dragHandler=function(cs,ct,cq,cu)if cc then local cv,cw=cs:getAbsolutePosition()local cx=cr:sendEvent('mouse_drag',cs,'mouse_drag',ct,cq-(cv-1),cu-(cw-1),cd-cq,ce-cu,cq,cu)cd,ce=cq,cu;if cx~=nil then return cx end;if cs.parent~=nil then cs.parent:setFocusedObject(cs)end;return true end;if cs:isCoordsInObject(cq,cu)then local cv,cw=cs:getAbsolutePosition(cs:getAnchorPosition())cd,ce=cq,cu;ck,cl=cv-cq,cw-cu end;return false end,scrollHandler=function(cs,ct,cq,cu)if cs:isCoordsInObject(cq,cu)then local cv,cw=cs:getAbsolutePosition()local cx=cr:sendEvent('mouse_scroll',cs,'mouse_scroll',ct,cq-(cv-1),cu-(cw-1))if cx==false then return false end;if cs.parent~=nil then cs.parent:setFocusedObject(cs)end;return true end;return false end,hoverHandler=function(cs,ct,cq,cu)if cs:isCoordsInObject(ct,cq)then local cv=cr:sendEvent('mouse_hover',cs,'mouse_hover',ct,cq,cu)if cv==false then return false end;c5=true;return true end;if c5 then local cv=cr:sendEvent('mouse_leave',cs,'mouse_leave',ct,cq,cu)if cv==false then return false end;c5=false end;return false end,keyHandler=function(cs,ct,cq)if cb and c3 then if cs:isFocused()then local cu=cr:sendEvent('key',cs,'key',ct,cq)if cu==false then return false end;return true end end;return false end,keyUpHandler=function(cs,ct)if cb and c3 then if cs:isFocused()then local cq=cr:sendEvent('key_up',cs,'key_up',ct)if cq==false then return false end;return true end end;return false end,charHandler=function(cs,ct)if cb and c3 then if cs:isFocused()then local cq=cr:sendEvent('char',cs,'char',ct)if cq==false then return false end;return true end end;return false end,valueChangedHandler=function(cs)cr:sendEvent('value_changed',cs,c0)end,eventHandler=function(cs,ct,cq,cu,cv,cw)local cx=cr:sendEvent('other_event',cs,ct,cq,cu,cv,cw)if cx~=nil then return cx end;return true end,getFocusHandler=function(cs)local ct=cr:sendEvent('get_focus',cs)if ct~=nil then return ct end;return true end,loseFocusHandler=function(cs)cc=false;local ct=cr:sendEvent('lose_focus',cs)if ct~=nil then return ct end;return true end,init=function(cs)if cs.parent~=nil then for ct,cq in pairs(cj)do if cq then cs.parent:addEvent(ct,cs)end end end;if not c4 then c4=true;return true end;return false end}bZ.__index=bZ;return bZ end end;as['default']['theme']=function(...)return{BasaltBG=colors.lightGray,BasaltText=colors.black,FrameBG=colors.gray,FrameText=colors.black,ButtonBG=colors.gray,ButtonText=colors.black,CheckboxBG=colors.gray,CheckboxText=colors.black,InputBG=colors.gray,InputText=colors.black,TextfieldBG=colors.gray,TextfieldText=colors.black,ListBG=colors.gray,ListText=colors.black,MenubarBG=colors.gray,MenubarText=colors.black,DropdownBG=colors.gray,DropdownText=colors.black,RadioBG=colors.gray,RadioText=colors.black,SelectionBG=colors.black,SelectionText=colors.lightGray,GraphicBG=colors.black,ImageBG=colors.black,PaneBG=colors.black,ProgramBG=colors.black,ProgressbarBG=colors.gray,ProgressbarText=colors.black,ProgressbarActiveBG=colors.black,ScrollbarBG=colors.lightGray,ScrollbarText=colors.gray,ScrollbarSymbolColor=colors.black,SliderBG=false,SliderText=colors.gray,SliderSymbolColor=colors.black,SwitchBG=colors.lightGray,SwitchText=colors.gray,SwitchBGSymbol=colors.black,SwitchInactive=colors.red,SwitchActive=colors.green,LabelBG=false,LabelText=colors.black}end;local ay=require'basaltEvent'()local az=require'Frame'local aA=require'theme'local aB=require'utils'local aC=require'basaltLogs'local aD=aB.uuid;local aE=aB.createText;local aF=aB.tableCount;local aG=300;local aK=50;local aL=term.current()local aM='1.6.2'local aN=fs.getDir''local aO,aP,aQ,aR,aS,aT={},{},{},{},{},{}local aU,aV,aW,aX;local aY={}if not term.isColor or not term.isColor()then error('Basalt requires an advanced (golden) computer to run.',0)end;local function aZ()aX=false;aL.clear()aL.setCursorPos(1,1)end;local a_=function(aH)aL.clear()aL.setBackgroundColor(colors.black)aL.setTextColor(colors.red)local aI,aJ=aL.getSize()if aY.logging then aC(aH,'Error')end;local bh=aE('Basalt error: '..aH,aI)local bm=1;for bn,bo in pairs(bh)do aL.setCursorPos(1,bm)aL.write(bo)bm=bm+1 end;aL.setCursorPos(1,bm+1)aX=false end;local function b0(aH)assert(aH~='function','Schedule needs a function in order to work!')return function(...)local aI=coroutine.create(aH)local aJ,bh=coroutine.resume(aI,...)if aJ then table.insert(aT,aI)else a_(bh)end end end;local b1=function(aH,aI)aS[aH]=aI end;local b2=function(aH)return aS[aH]end;local b3=function(aH)aA=aH end;local b4=function(aH)return aA[aH]end;local b5={getMainFrame=function()return aU end,setVariable=b1,getVariable=b2,getTheme=b4,setMainFrame=function(aH)aU=aH end,getActiveFrame=function()return aV end,setActiveFrame=function(aH)aV=aH end,getFocusedObject=function()return aW end,setFocusedObject=function(aH)aW=aH end,getMonitorFrame=function(aH)return aQ[aH]or aR[aH][1]end,setMonitorFrame=function(aH,aI,aJ)if aU==aI then aU=nil end;if aJ then aR[aH]={aI,sides}else aQ[aH]=aI end;if aI==nil then aR[aH]=nil end end,getBaseTerm=function()return aL end,schedule=b0,stop=aZ,newFrame=az,getDirectory=function()return aN end}local function b6(aH,aI,aJ,bh,bm)if#aT>0 then local bn={}for bE=1,#aT do if aT[bE]~=nil then if coroutine.status(aT[bE])=='suspended'then local bo,bp=coroutine.resume(aT[bE],aH,aI,aJ,bh,bm)if not bo then a_(bp)end else table.insert(bn,bE)end end end;for bE=1,#bn do table.remove(aT,bn[bE]-(bE-1))end end end;local function b7()if aX==false then return end;if aU~=nil then aU:draw()aU:updateTerm()end;for aH,aI in pairs(aQ)do aI:draw()aI:updateTerm()end;for aH,aI in pairs(aR)do aI[1]:draw()aI[1]:updateTerm()end end;local b8,b9,ba=nil,nil,nil;local bb=nil;local function bc(aH,aI,aJ)b8,b9,ba=b8,aI,aJ;if bb==nil then bb=os.startTimer(aG/1000)end end;local function bd()bb=nil;aU:hoverHandler(b9,ba,b8)aV=aU end;local be,bf,bg=nil,nil,nil;local bi=nil;local function bj()bi=nil;aU:dragHandler(be,bf,bg)aV=aU end;local function bk(aH,aI,aJ)be,bf,bg=aH,aI,aJ;if aK<50 then bj()else if bi==nil then bi=os.startTimer(aK/1000)end end end;local function bl(aH,aI,aJ,bh,bm)if ay:sendEvent('basaltEventCycle',aH,aI,aJ,bh,bm)==false then return end;if aU~=nil then if aH=='mouse_click'then aU:mouseHandler(aI,aJ,bh,false)aV=aU elseif aH=='mouse_drag'then bk(aI,aJ,bh)elseif aH=='mouse_up'then aU:mouseUpHandler(aI,aJ,bh,bm)aV=aU elseif aH=='mouse_scroll'then aU:scrollHandler(aI,aJ,bh,bm)aV=aU elseif aH=='mouse_move'then bc(aI,aJ,bh)end end;if aH=='monitor_touch'then if aQ[aI]~=nil then aQ[aI]:mouseHandler(1,aJ,bh,true)aV=aQ[aI]end;if aF(aR)>0 then for bn,bo in pairs(aR)do bo[1]:mouseHandler(1,aJ,bh,true,aI)end end end;if aH=='char'then if aV~=nil then aV:charHandler(aI)end end;if aH=='key_up'then if aV~=nil then aV:keyUpHandler(aI)end;aO[aI]=false end;if aH=='key'then if aV~=nil then aV:keyHandler(aI,aJ)end;aO[aI]=true end;if aH=='terminate'then if aV~=nil then aV:eventHandler(aH)if aX==false then return end end end;if aH~='mouse_click'and aH~='mouse_up'and aH~='mouse_scroll'and aH~='mouse_drag'and aH~='mouse_move'and aH~='key'and aH~='key_up'and aH~='char'and aH~='terminate'then if aH=='timer'and aI==bb then bd()elseif aH=='timer'and aI==bi then bj()else for bn,bo in pairs(aP)do bo:eventHandler(aH,aI,aJ,bh,bm)end end end;b6(aH,aI,aJ,bh,bm)b7()end;aY={logging=false,setTheme=b3,getTheme=b4,drawFrames=b7,getVersion=function()return aM end,setVariable=b1,getVariable=b2,setBaseTerm=function(aH)aL=aH end,log=function(...)aC(...)end,setMouseMoveThrottle=function(aH)if _HOST:find'CraftOS%-PC'then if config.get'mouse_move_throttle'~=10 then config.set('mouse_move_throttle',10)end;if aH<100 then aG=100 else aG=aH end;return true end;return false end,setMouseDragThrottle=function(aH)if aH<=0 then aK=0 else bi=nil;aK=aH end end,autoUpdate=function(aH)aX=aH;if aH==nil then aX=true end;local function aI()b7()while aX do bl(os.pullEventRaw())end end;local aJ,bh=xpcall(aI,debug.traceback)if not aJ then a_(bh)return end end,update=function(aH,aI,aJ,bh,bm)if aH~=nil then local bn,bo=xpcall(bl,debug.traceback,aH,aI,aJ,bh,bm)if not bn then a_(bo)return end end end,stop=aZ,stopUpdate=aZ,isKeyDown=function(aH)if aO[aH]==nil then return false end;return aO[aH]end,getFrame=function(aH)for aI,aJ in pairs(aP)do if aJ.name==aH then return aJ end end end,getActiveFrame=function()return aV end,setActiveFrame=function(aH)if aH:getType()=='Frame'then aV=aH;return true end;return false end,onEvent=function(...)for aH,aI in pairs(table.pack(...))do if type(aI)=='function'then ay:registerEvent('basaltEventCycle',aI)end end end,schedule=b0,createFrame=function(aH)aH=aH or aD()for aJ,bh in pairs(aP)do if bh.name==aH then return nil end end;local aI=az(aH,nil,nil,b5)aI:init()table.insert(aP,aI)if aU==nil and aI:getName()~='basaltDebuggingFrame'then aI:show()end;return aI end,removeFrame=function(aH)aP[aH]=nil end,setProjectDir=function(aH)aN=aH end,debug=function(...)local aH={...}if aU==nil then print(...)return end;if aU.name~='basaltDebuggingFrame'then if aU~=aY.debugFrame then aY.debugLabel:setParent(aU)end end;local aI=''for aJ,bh in pairs(aH)do aI=aI..tostring(bh)..(#aH~=aJ and', 'or'')end;aY.debugLabel:setText('[Debug] '..aI)for aJ,bh in pairs(aE(aI,aY.debugList:getWidth()))do aY.debugList:addItem(bh)end;if aY.debugList:getItemCount()>50 then aY.debugList:removeItem(1)end;aY.debugList:setValue(aY.debugList:getItem(aY.debugList:getItemCount()))if aY.debugList.getItemCount()>aY.debugList:getHeight()then aY.debugList:setOffset(aY.debugList:getItemCount()-aY.debugList:getHeight())end;aY.debugLabel:show()end}aY.debugFrame=aY.createFrame('basaltDebuggingFrame'):showBar():setBackground(colors.lightGray):setBar('Debug',colors.black,colors.gray)aY.debugFrame:addButton('back'):setAnchor('topRight'):setSize(1,1):setText('\22'):onClick(function()if aY.oldFrame~=nil then aY.oldFrame:show()end end):setBackground(colors.red):show()aY.debugList=aY.debugFrame:addList('debugList'):setSize('parent.w - 2','parent.h - 3'):setPosition(2,3):setScrollable(true):show()aY.debugLabel=aY.debugFrame:addLabel('debugLabel'):onClick(function()aY.oldFrame=aU;aY.debugFrame:show()end):setBackground(colors.black):setForeground(colors.white):setAnchor('bottomLeft'):ignoreOffset():setZIndex(20):show()return aY end;d['packages/basalt.lua'].cache=c;d['packages/basalt.lua'].isCached=false;d['packages/base64.lua']={}d['packages/base64.lua'].load=function()local l='base64.lua'local m='packages/base64.lua'local n='packages'local o='abb838d74919d0c924ed1acf353dcf667886b064e70a109c7bd514b0e96f38c168e23adf930d75cfc288dad437591d485b8a35ce11fa4f8dc08a8090956796bd'local cM={}local cN={}for cO=65,90 do table.insert(cM,cO)end;for cO=97,122 do table.insert(cM,cO)end;for cO=48,57 do table.insert(cM,cO)end;table.insert(cM,43)table.insert(cM,47)for cO,cP in ipairs(cM)do cN[cP]=cO end;local cQ={}local cR=bit32.rshift;local cS=bit32.lshift;local cT=bit32.band;function cQ.Encode(cU)local cV={}local cW=0;for cO=1,#cU,3 do local cX,cY,cZ=string.byte(cU,cO,cO+2)local c_=cR(cX,2)local d0=cS(cT(cX,3),4)+cR(cY or 0,4)local d1=cS(cT(cY or 0,15),2)+cR(cZ or 0,6)local d2=cT(cZ or 0,63)cW=cW+1;cV[cW]=cM[c_+1]cW=cW+1;cV[cW]=cM[d0+1]cW=cW+1;cV[cW]=cY and cM[d1+1]or 61;cW=cW+1;cV[cW]=cZ and cM[d2+1]or 61 end;local d3={}local d4=0;local d5;for cO=1,cW,4096 do d4=d4+1;d5=cO+4096-1;d3[d4]=string.char(table.unpack(cV,cO,d5>cW and cW or d5))end;return table.concat(d3)end;function cQ.Decode(cU)local cV={}local cW=0;for cO=1,#cU,4 do local cX,cY,cZ,d6=string.byte(cU,cO,cO+3)local d7=cN[cX]-1;local d8=cN[cY]-1;local d9=(cN[cZ]or 1)-1;local da=(cN[d6]or 1)-1;local c_=cS(d7,2)+cR(d8,4)local d0=cS(cT(d8,15),4)+cR(d9,2)local d1=cS(cT(d9,3),6)+da;cW=cW+1;cV[cW]=c_;if cZ~=61 then cW=cW+1;cV[cW]=d0 end;if d6~=61 then cW=cW+1;cV[cW]=d1 end end;local d3={}local d4=0;local d5;for cO=1,cW,4096 do d4=d4+1;d5=cO+4096-1;d3[d4]=string.char(table.unpack(cV,cO,d5>cW and cW or d5))end;return table.concat(d3)end;return cQ end;d['packages/base64.lua'].cache=c;d['packages/base64.lua'].isCached=false;d['packages/bitop.lua']={}d['packages/bitop.lua'].load=function()local l='bitop.lua'local m='packages/bitop.lua'local n='packages'local o='3eb8138fba20e6efce960c977bd8b3d0120aa7c230bc95a3ec462484610b8433d05a6035ad08c36f43925f6af3d63338fcde5ed1956391b382b49546ed9e245b'local db={_TYPE='module',_NAME='bitop.funcs',_VERSION='1.0-0'}local dc=math.floor;local dd=2^32;local de=dd-1;local function df(X)local dg={}local dh=setmetatable({},dg)function dg:__index(af)local ag=X(af)dh[af]=ag;return ag end;return dh end;local function di(dh,dj)local function dk(cJ,av)local dl,dm=0,1;while cJ~=0 and av~=0 do local dn,dp=cJ%dj,av%dj;dl=dl+dh[dn][dp]*dm;cJ=(cJ-dn)/dj;av=(av-dp)/dj;dm=dm*dj end;dl=dl+(cJ+av)*dm;return dl end;return dk end;local function dq(dh)local dr=di(dh,2^1)local ds=df(function(cJ)return df(function(av)return dr(cJ,av)end)end)return di(ds,2^(dh.n or 1))end;function db.tobit(x)return x%2^32 end;db.bxor=dq{[0]={[0]=0,[1]=1},[1]={[0]=1,[1]=0},n=4}local dt=db.bxor;function db.bnot(cJ)return de-cJ end;local du=db.bnot;function db.band(cJ,av)return(cJ+av-dt(cJ,av))/2 end;local dv=db.band;function db.bor(cJ,av)return de-dv(de-cJ,de-av)end;local dw=db.bor;local dx,dy;function db.rshift(cJ,dz)if dz<0 then return dx(cJ,-dz)end;return dc(cJ%2^32/2^dz)end;dy=db.rshift;function db.lshift(cJ,dz)if dz<0 then return dy(cJ,-dz)end;return cJ*2^dz%2^32 end;dx=db.lshift;function db.tohex(x,bE)bE=bE or 8;local dA;if bE<=0 then if bE==0 then return''end;dA=true;bE=-bE end;x=dv(x,16^bE-1)return('%0'..bE..(dA and'X'or'x')):format(x)end;local dB=db.tohex;function db.extract(bE,dC,dD)dD=dD or 1;return dv(dy(bE,dC),2^dD-1)end;local dE=db.extract;function db.replace(bE,ag,dC,dD)dD=dD or 1;local dF=2^dD-1;ag=dv(ag,dF)local dG=du(dx(dF,dC))return dv(bE,dG)+dx(ag,dC)end;local dH=db.replace;function db.bswap(x)local cJ=dv(x,0xff)x=dy(x,8)local av=dv(x,0xff)x=dy(x,8)local cf=dv(x,0xff)x=dy(x,8)local c6=dv(x,0xff)return dx(dx(dx(cJ,8)+av,8)+cf,8)+c6 end;local dI=db.bswap;function db.rrotate(x,dz)dz=dz%32;local dJ=dv(x,2^dz-1)return dy(x,dz)+dx(dJ,32-dz)end;local dK=db.rrotate;function db.lrotate(x,dz)return dK(x,-dz)end;local dL=db.lrotate;db.rol=db.lrotate;db.ror=db.rrotate;function db.arshift(x,dz)local dM=dy(x,dz)if x>=0x80000000 then dM=dM+dx(2^dz-1,32-dz)end;return dM end;local dN=db.arshift;function db.btest(x,y)return dv(x,y)~=0 end;db.bit32={}local function dO(x)return(-1-x)%dd end;db.bit32.bnot=dO;local function dP(cJ,av,cf,...)local dM;if av then cJ=cJ%dd;av=av%dd;dM=dt(cJ,av)if cf then dM=dP(dM,cf,...)end;return dM elseif cJ then return cJ%dd else return 0 end end;db.bit32.bxor=dP;local function cT(cJ,av,cf,...)local dM;if av then cJ=cJ%dd;av=av%dd;dM=(cJ+av-dt(cJ,av))/2;if cf then dM=cT(dM,cf,...)end;return dM elseif cJ then return cJ%dd else return de end end;db.bit32.band=cT;local function dQ(cJ,av,cf,...)local dM;if av then cJ=cJ%dd;av=av%dd;dM=de-dv(de-cJ,de-av)if cf then dM=dQ(dM,cf,...)end;return dM elseif cJ then return cJ%dd else return 0 end end;db.bit32.bor=dQ;function db.bit32.btest(...)return cT(...)~=0 end;function db.bit32.lrotate(x,dz)return dL(x%dd,dz)end;function db.bit32.rrotate(x,dz)return dK(x%dd,dz)end;function db.bit32.lshift(x,dz)if dz>31 or dz<-31 then return 0 end;return dx(x%dd,dz)end;function db.bit32.rshift(x,dz)if dz>31 or dz<-31 then return 0 end;return dy(x%dd,dz)end;function db.bit32.arshift(x,dz)x=x%dd;if dz>=0 then if dz>31 then return x>=0x80000000 and de or 0 else local dM=dy(x,dz)if x>=0x80000000 then dM=dM+dx(2^dz-1,32-dz)end;return dM end else return dx(x,-dz)end end;function db.bit32.extract(x,dC,...)local dD=...or 1;if dC<0 or dC>31 or dD<0 or dC+dD>32 then error'out of range'end;x=x%dd;return dE(x,dC,...)end;function db.bit32.replace(x,ag,dC,...)local dD=...or 1;if dC<0 or dC>31 or dD<0 or dC+dD>32 then error'out of range'end;x=x%dd;ag=ag%dd;return dH(x,ag,dC,...)end;db.bit={}function db.bit.tobit(x)x=x%dd;if x>=0x80000000 then x=x-dd end;return x end;local dR=db.bit.tobit;function db.bit.tohex(x,...)return dB(x%dd,...)end;function db.bit.bnot(x)return dR(du(x%dd))end;local function dS(cJ,av,cf,...)if cf then return dS(dS(cJ,av),cf,...)elseif av then return dR(dw(cJ%dd,av%dd))else return dR(cJ)end end;db.bit.bor=dS;local function dT(cJ,av,cf,...)if cf then return dT(dT(cJ,av),cf,...)elseif av then return dR(dv(cJ%dd,av%dd))else return dR(cJ)end end;db.bit.band=dT;local function dU(cJ,av,cf,...)if cf then return dU(dU(cJ,av),cf,...)elseif av then return dR(dt(cJ%dd,av%dd))else return dR(cJ)end end;db.bit.bxor=dU;function db.bit.lshift(x,bE)return dR(dx(x%dd,bE%32))end;function db.bit.rshift(x,bE)return dR(dy(x%dd,bE%32))end;function db.bit.arshift(x,bE)return dR(dN(x%dd,bE%32))end;function db.bit.rol(x,bE)return dR(dL(x%dd,bE%32))end;function db.bit.ror(x,bE)return dR(dK(x%dd,bE%32))end;function db.bit.bswap(x)return dR(dI(x%dd))end;return db end;d['packages/bitop.lua'].cache=c;d['packages/bitop.lua'].isCached=false;d['packages/child_process.lua']={}d['packages/child_process.lua'].load=function()local l='child_process.lua'local m='packages/child_process.lua'local n='packages'local o='d4d9127b6d57470743431b879789e451653aa26ade0fc0440567f71aefbaddd05601ce4fcf995065ff2ebe3c70eb5c88c380ea8d1bc7015a06f330e14d75b5fc'local dV=0;return{['execSync']=function(dW,...)error'non-functional as of now'end,['execLuaSync']=function(dX,dY)dV=dV+1;local cf,dZ=loadstring(dX,dY or'Unknown Chunk Name - Chunk #'..tostring(dV))if not cf then error('Compilation Error: '..dZ)end;return cf()end}end;d['packages/child_process.lua'].cache=c;d['packages/child_process.lua'].isCached=false;d['packages/console.lua']={}d['packages/console.lua'].load=function()local l='console.lua'local m='packages/console.lua'local n='packages'local o='4680436d6f199fd8fcb61ecc496c4bf33dbe7448eb2eefe36f8d0ab419726c0183db12921807d96b6d921011909418ca6d6ed8156e4a53ec2a0adee832c88a11'return{['clear']=function()term.clear()term.setCursorPos(1,1)end,['log']=print,['warn']=print,['error']=print,['centerLog']=function(d_)local e0,e1=term.getSize()local g,e2=d_:gsub('\n','')term.setCursorPos(math.floor(e0/2)-math.floor(#d_/2),math.floor(e1/2)-math.floor(e2/2))print(d_)end,['logNoNl']=function(d_)local x,y=term.getCursorPos()term.write(d_)term.setCursorPos(x+#d_,y)end}end;d['packages/console.lua'].cache=c;d['packages/console.lua'].isCached=false;d['packages/forceyield.lua']={}d['packages/forceyield.lua'].load=function()local l='forceyield.lua'local m='packages/forceyield.lua'local n='packages'local o='eb04b7f3c25eb022ecf4eb6d4cd49852ba4d34df8f91b9a51667256940f57f740f52dc3c6b3e3630b96f26bc12fee62fb72ed3f7ecc9608960b9727b447b964a'return function()os.queueEvent'fakeEvent'os.pullEvent()end end;d['packages/forceyield.lua'].cache=c;d['packages/forceyield.lua'].isCached=false;d['packages/hash.lua']={}d['packages/hash.lua'].load=function()local l='hash.lua'local m='packages/hash.lua'local n='packages'local o='634545ee941dd77783331999bdf495b4922468b96b61595d91f7b6bb76a09319f23ec27b6cf379889b8fd528366d47aa45563bcf1f5a3bfe2e5f5cbb385b3d66'local cQ=require'base64'local ipairs=ipairs;local cT=bit32.band;local dQ=bit32.bor;local dP=bit32.bxor;local cS=bit32.lshift;local cR=bit32.rshift;local e3=bit32.lrotate;local e4=bit32.rrotate;local e5,e6,e7,e8,e9,ea={},{},{},{},{},{}local eb={[224]={},[256]=e8}local ec,ed={[384]={},[512]=e7},{[384]={},[512]=e8}local ee,ef={},{0x67452301,0xEFCDAB89,0x98BADCFE,0x10325476,0xC3D2E1F0}local eg={0,0,0,0,0,0,0,0,28,25,26,27,0,0,10,9,11,12,0,15,16,17,18,0,20,22,23,21}local eh,ei,ej;local ek={}local el,em,en=4294967296,0,0;local eo=2^-56;local ep=2^-17;local eq=2^2;local er=2^3;local es=2^4;local et=2^5;local eu=2^6;local ev=2^7;local ew=2^8;local ex=2^9;local ey=2^10;local ez=2^11;local eA=2^12;local eB=2^13;local eC=2^14;local eD=2^15;local eE=2^16;local eF=2^17;local eG=2^18;local eH=2^19;local eI=2^20;local eJ=2^21;local eK=2^22;local eL=2^23;local eM=2^24;local eN=2^25;local eO=2^26;local eP=2^27;local eQ=2^28;local eR=2^29;local eS=2^30;local eT=2^31;local eU=2^32;local eV=2^40;local eW=256^7;local function eX(eY,eZ,e_,f0)local f1,f2=ek,e6;local f3,f4,f5,f6,f7,f8,f9,fa=eY[1],eY[2],eY[3],eY[4],eY[5],eY[6],eY[7],eY[8]for fb=e_,e_+f0-1,64 do for ch=1,16 do fb=fb+4;local cJ,av,cf,c6=string.byte(eZ,fb-3,fb)f1[ch]=((cJ*256+av)*256+cf)*256+c6 end;for ch=17,64 do local cJ,av=f1[ch-15],f1[ch-2]f1[ch]=dP(e4(cJ,7),e3(cJ,14),cR(cJ,3))+dP(e3(av,15),e3(av,13),cR(av,10))+f1[ch-7]+f1[ch-16]end;local cJ,av,cf,c6,fc,X,fd,h=f3,f4,f5,f6,f7,f8,f9,fa;for ch=1,64 do local dM=dP(e4(fc,6),e4(fc,11),e3(fc,7))+cT(fc,X)+cT(-1-fc,fd)+h+f2[ch]+f1[ch]h=fd;fd=X;X=fc;fc=dM+c6;c6=cf;cf=av;av=cJ;cJ=dM+cT(c6,cf)+cT(cJ,dP(c6,cf))+dP(e4(cJ,2),e4(cJ,13),e3(cJ,10))end;f3,f4,f5,f6=(cJ+f3)%4294967296,(av+f4)%4294967296,(cf+f5)%4294967296,(c6+f6)%4294967296;f7,f8,f9,fa=(fc+f7)%4294967296,(X+f8)%4294967296,(fd+f9)%4294967296,(h+fa)%4294967296 end;eY[1],eY[2],eY[3],eY[4],eY[5],eY[6],eY[7],eY[8]=f3,f4,f5,f6,f7,f8,f9,fa end;local function fe(ff,fg,eZ,e_,f0)local f1,fh,fi=ek,e5,e6;local fj,fk,fl,fm,fn,fo,fp,fq=ff[1],ff[2],ff[3],ff[4],ff[5],ff[6],ff[7],ff[8]local fr,ft,fu,fv,fw,fx,fy,fz=fg[1],fg[2],fg[3],fg[4],fg[5],fg[6],fg[7],fg[8]for fb=e_,e_+f0-1,128 do for ch=1,16*2 do fb=fb+4;local cJ,av,cf,c6=string.byte(eZ,fb-3,fb)f1[ch]=((cJ*256+av)*256+cf)*256+c6 end;for fA=34,160,2 do local fB,fC,fD,fE=f1[fA-30],f1[fA-31],f1[fA-4],f1[fA-5]local fF=dP(cR(fB,1)+cS(fC,31),cR(fB,8)+cS(fC,24),cR(fB,7)+cS(fC,25))%4294967296+dP(cR(fD,19)+cS(fE,13),cS(fD,3)+cR(fE,29),cR(fD,6)+cS(fE,26))%4294967296+f1[fA-14]+f1[fA-32]local fG=fF%4294967296;f1[fA-1]=dP(cR(fC,1)+cS(fB,31),cR(fC,8)+cS(fB,24),cR(fC,7))+dP(cR(fE,19)+cS(fD,13),cS(fE,3)+cR(fD,29),cR(fE,6))+f1[fA-15]+f1[fA-33]+(fF-fG)/4294967296;f1[fA]=fG end;local fB,fD,fH,fI,fJ,fK,fL,fM=fj,fk,fl,fm,fn,fo,fp,fq;local fC,fE,fN,fO,fP,fQ,fR,fS=fr,ft,fu,fv,fw,fx,fy,fz;for ch=1,80 do local fA=2*ch;local fF=dP(cR(fJ,14)+cS(fP,18),cR(fJ,18)+cS(fP,14),cS(fJ,23)+cR(fP,9))%4294967296+(cT(fJ,fK)+cT(-1-fJ,fL))%4294967296+fM+fh[ch]+f1[fA]local fT=fF%4294967296;local fU=dP(cR(fP,14)+cS(fJ,18),cR(fP,18)+cS(fJ,14),cS(fP,23)+cR(fJ,9))+cT(fP,fQ)+cT(-1-fP,fR)+fS+fi[ch]+f1[fA-1]+(fF-fT)/4294967296;fM=fL;fS=fR;fL=fK;fR=fQ;fK=fJ;fQ=fP;fF=fT+fI;fJ=fF%4294967296;fP=fU+fO+(fF-fJ)/4294967296;fI=fH;fO=fN;fH=fD;fN=fE;fD=fB;fE=fC;fF=fT+(cT(fI,fH)+cT(fD,dP(fI,fH)))%4294967296+dP(cR(fD,28)+cS(fE,4),cS(fD,30)+cR(fE,2),cS(fD,25)+cR(fE,7))%4294967296;fB=fF%4294967296;fC=fU+cT(fO,fN)+cT(fE,dP(fO,fN))+dP(cR(fE,28)+cS(fD,4),cS(fE,30)+cR(fD,2),cS(fE,25)+cR(fD,7))+(fF-fB)/4294967296 end;fB=fj+fB;fj=fB%4294967296;fr=(fr+fC+(fB-fj)/4294967296)%4294967296;fB=fk+fD;fk=fB%4294967296;ft=(ft+fE+(fB-fk)/4294967296)%4294967296;fB=fl+fH;fl=fB%4294967296;fu=(fu+fN+(fB-fl)/4294967296)%4294967296;fB=fm+fI;fm=fB%4294967296;fv=(fv+fO+(fB-fm)/4294967296)%4294967296;fB=fn+fJ;fn=fB%4294967296;fw=(fw+fP+(fB-fn)/4294967296)%4294967296;fB=fo+fK;fo=fB%4294967296;fx=(fx+fQ+(fB-fo)/4294967296)%4294967296;fB=fp+fL;fp=fB%4294967296;fy=(fy+fR+(fB-fp)/4294967296)%4294967296;fB=fq+fM;fq=fB%4294967296;fz=(fz+fS+(fB-fq)/4294967296)%4294967296 end;ff[1],ff[2],ff[3],ff[4],ff[5],ff[6],ff[7],ff[8]=fj,fk,fl,fm,fn,fo,fp,fq;fg[1],fg[2],fg[3],fg[4],fg[5],fg[6],fg[7],fg[8]=fr,ft,fu,fv,fw,fx,fy,fz end;local function fV(eY,eZ,e_,f0)local f1,f2,eg=ek,ee,eg;local f3,f4,f5,f6=eY[1],eY[2],eY[3],eY[4]for fb=e_,e_+f0-1,64 do for ch=1,16 do fb=fb+4;local cJ,av,cf,c6=string.byte(eZ,fb-3,fb)f1[ch]=((c6*256+cf)*256+av)*256+cJ end;local cJ,av,cf,c6=f3,f4,f5,f6;local fW=25;for ch=1,16 do local fX=e4(cT(av,cf)+cT(-1-av,c6)+cJ+f2[ch]+f1[ch],fW)+av;fW=eg[fW]cJ=c6;c6=cf;cf=av;av=fX end;fW=27;for ch=17,32 do local fX=e4(cT(c6,av)+cT(-1-c6,cf)+cJ+f2[ch]+f1[(5*ch-4)%16+1],fW)+av;fW=eg[fW]cJ=c6;c6=cf;cf=av;av=fX end;fW=28;for ch=33,48 do local fX=e4(dP(dP(av,cf),c6)+cJ+f2[ch]+f1[(3*ch+2)%16+1],fW)+av;fW=eg[fW]cJ=c6;c6=cf;cf=av;av=fX end;fW=26;for ch=49,64 do local fX=e4(dP(cf,dQ(av,-1-c6))+cJ+f2[ch]+f1[(ch*7-7)%16+1],fW)+av;fW=eg[fW]cJ=c6;c6=cf;cf=av;av=fX end;f3=(cJ+f3)%4294967296;f4=(av+f4)%4294967296;f5=(cf+f5)%4294967296;f6=(c6+f6)%4294967296 end;eY[1],eY[2],eY[3],eY[4]=f3,f4,f5,f6 end;local function fY(eY,eZ,e_,f0)local f1=ek;local f3,f4,f5,f6,f7=eY[1],eY[2],eY[3],eY[4],eY[5]for fb=e_,e_+f0-1,64 do for ch=1,16 do fb=fb+4;local cJ,av,cf,c6=string.byte(eZ,fb-3,fb)f1[ch]=((cJ*256+av)*256+cf)*256+c6 end;for ch=17,80 do f1[ch]=e3(dP(f1[ch-3],f1[ch-8],f1[ch-14],f1[ch-16]),1)end;local cJ,av,cf,c6,fc=f3,f4,f5,f6,f7;for ch=1,20 do local dM=e3(cJ,5)+cT(av,cf)+cT(-1-av,c6)+0x5A827999+f1[ch]+fc;fc=c6;c6=cf;cf=e4(av,2)av=cJ;cJ=dM end;for ch=21,40 do local dM=e3(cJ,5)+dP(av,cf,c6)+0x6ED9EBA1+f1[ch]+fc;fc=c6;c6=cf;cf=e4(av,2)av=cJ;cJ=dM end;for ch=41,60 do local dM=e3(cJ,5)+cT(c6,cf)+cT(av,dP(c6,cf))+0x8F1BBCDC+f1[ch]+fc;fc=c6;c6=cf;cf=e4(av,2)av=cJ;cJ=dM end;for ch=61,80 do local dM=e3(cJ,5)+dP(av,cf,c6)+0xCA62C1D6+f1[ch]+fc;fc=c6;c6=cf;cf=e4(av,2)av=cJ;cJ=dM end;f3=(cJ+f3)%4294967296;f4=(av+f4)%4294967296;f5=(cf+f5)%4294967296;f6=(c6+f6)%4294967296;f7=(fc+f7)%4294967296 end;eY[1],eY[2],eY[3],eY[4],eY[5]=f3,f4,f5,f6,f7 end;local function fZ(f_,g0,eZ,e_,f0,g1)local g2,g3=e9,ea;local g4=g1/8;for fb=e_,e_+f0-1,g1 do for ch=1,g4 do local cJ,av,cf,c6=string.byte(eZ,fb+1,fb+4)f_[ch]=dP(f_[ch],((c6*256+cf)*256+av)*256+cJ)fb=fb+8;cJ,av,cf,c6=string.byte(eZ,fb-3,fb)g0[ch]=dP(g0[ch],((c6*256+cf)*256+av)*256+cJ)end;local g5,g6,g7,g8,g9,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn,go,gp,gq,gr,gs,gt,gu,gv,gw,gx,gy,gz,gA,gB,gC,gD,gE,gF,gG,gH,gI,gJ,gK,gL,gM,gN,gO,gP,gQ,gR,gS=f_[1],g0[1],f_[2],g0[2],f_[3],g0[3],f_[4],g0[4],f_[5],g0[5],f_[6],g0[6],f_[7],g0[7],f_[8],g0[8],f_[9],g0[9],f_[10],g0[10],f_[11],g0[11],f_[12],g0[12],f_[13],g0[13],f_[14],g0[14],f_[15],g0[15],f_[16],g0[16],f_[17],g0[17],f_[18],g0[18],f_[19],g0[19],f_[20],g0[20],f_[21],g0[21],f_[22],g0[22],f_[23],g0[23],f_[24],g0[24],f_[25],g0[25]for gT=1,24 do local gU=dP(g5,gf,gp,gz,gJ)local gV=dP(g6,gg,gq,gA,gK)local gW=dP(g7,gh,gr,gB,gL)local gX=dP(g8,gi,gs,gC,gM)local gY=dP(g9,gj,gt,gD,gN)local gZ=dP(ga,gk,gu,gE,gO)local g_=dP(gb,gl,gv,gF,gP)local h0=dP(gc,gm,gw,gG,gQ)local h1=dP(gd,gn,gx,gH,gR)local h2=dP(ge,go,gy,gI,gS)local h3=dP(gU,gY*2+(gZ%eU-gZ%eT)/eT)local h4=dP(gV,gZ*2+(gY%eU-gY%eT)/eT)local h5=dP(h3,g7)local h6=dP(h4,g8)local h7=dP(h3,gh)local h8=dP(h4,gi)local h9=dP(h3,gr)local ha=dP(h4,gs)local hb=dP(h3,gB)local hc=dP(h4,gC)local hd=dP(h3,gL)local he=dP(h4,gM)g7=(h7%eU-h7%eI)/eI+h8*eA;g8=(h8%eU-h8%eI)/eI+h7*eA;gh=(hb%eU-hb%eH)/eH+hc*eB;gi=(hc%eU-hc%eH)/eH+hb*eB;gr=h5*2+(h6%eU-h6%eT)/eT;gs=h6*2+(h5%eU-h5%eT)/eT;gB=h9*ey+(ha%eU-ha%eK)/eK;gC=ha*ey+(h9%eU-h9%eK)/eK;gL=hd*eq+(he%eU-he%eS)/eS;gM=he*eq+(hd%eU-hd%eS)/eS;h3=dP(gW,g_*2+(h0%eU-h0%eT)/eT)h4=dP(gX,h0*2+(g_%eU-g_%eT)/eT)h5=dP(h3,g9)h6=dP(h4,ga)h7=dP(h3,gj)h8=dP(h4,gk)h9=dP(h3,gt)ha=dP(h4,gu)hb=dP(h3,gD)hc=dP(h4,gE)hd=dP(h3,gN)he=dP(h4,gO)g9=(h9%eU-h9%eJ)/eJ+ha*ez;ga=(ha%eU-ha%eJ)/eJ+h9*ez;gj=(hd%eU-hd%er)/er+he*eR%eU;gk=(he%eU-he%er)/er+hd*eR%eU;gt=h7*eu+(h8%eU-h8%eO)/eO;gu=h8*eu+(h7%eU-h7%eO)/eO;gD=hb*eD+(hc%eU-hc%eF)/eF;gE=hc*eD+(hb%eU-hb%eF)/eF;gN=(h5%eU-h5%eq)/eq+h6*eS%eU;gO=(h6%eU-h6%eq)/eq+h5*eS%eU;h3=dP(gY,h1*2+(h2%eU-h2%eT)/eT)h4=dP(gZ,h2*2+(h1%eU-h1%eT)/eT)h5=dP(h3,gb)h6=dP(h4,gc)h7=dP(h3,gl)h8=dP(h4,gm)h9=dP(h3,gv)ha=dP(h4,gw)hb=dP(h3,gF)hc=dP(h4,gG)hd=dP(h3,gP)he=dP(h4,gQ)gb=hb*eJ%eU+(hc%eU-hc%ez)/ez;gc=hc*eJ%eU+(hb%eU-hb%ez)/ez;gl=h5*eQ%eU+(h6%eU-h6%es)/es;gm=h6*eQ%eU+(h5%eU-h5%es)/es;gv=h9*eN%eU+(ha%eU-ha%ev)/ev;gw=ha*eN%eU+(h9%eU-h9%ev)/ev;gF=(hd%eU-hd%ew)/ew+he*eM%eU;gG=(he%eU-he%ew)/ew+hd*eM%eU;gP=(h7%eU-h7%ex)/ex+h8*eL%eU;gQ=(h8%eU-h8%ex)/ex+h7*eL%eU;h3=dP(g_,gU*2+(gV%eU-gV%eT)/eT)h4=dP(h0,gV*2+(gU%eU-gU%eT)/eT)h5=dP(h3,gd)h6=dP(h4,ge)h7=dP(h3,gn)h8=dP(h4,go)h9=dP(h3,gx)ha=dP(h4,gy)hb=dP(h3,gH)hc=dP(h4,gI)hd=dP(h3,gR)he=dP(h4,gS)gd=hd*eC+(he%eU-he%eG)/eG;ge=he*eC+(hd%eU-hd%eG)/eG;gn=h7*eI%eU+(h8%eU-h8%eA)/eA;go=h8*eI%eU+(h7%eU-h7%eA)/eA;gx=hb*ew+(hc%eU-hc%eM)/eM;gy=hc*ew+(hb%eU-hb%eM)/eM;gH=h5*eP%eU+(h6%eU-h6%et)/et;gI=h6*eP%eU+(h5%eU-h5%et)/et;gR=(h9%eU-h9%eN)/eN+ha*ev;gS=(ha%eU-ha%eN)/eN+h9*ev;h3=dP(h1,gW*2+(gX%eU-gX%eT)/eT)h4=dP(h2,gX*2+(gW%eU-gW%eT)/eT)h7=dP(h3,gf)h8=dP(h4,gg)h9=dP(h3,gp)ha=dP(h4,gq)hb=dP(h3,gz)hc=dP(h4,gA)hd=dP(h3,gJ)he=dP(h4,gK)gf=h9*er+(ha%eU-ha%eR)/eR;gg=ha*er+(h9%eU-h9%eR)/eR;gp=hd*eG+(he%eU-he%eC)/eC;gq=he*eG+(hd%eU-hd%eC)/eC;gz=(h7%eU-h7%eQ)/eQ+h8*es;gA=(h8%eU-h8%eQ)/eQ+h7*es;gJ=(hb%eU-hb%eL)/eL+hc*ex;gK=(hc%eU-hc%eL)/eL+hb*ex;g5=dP(h3,g5)g6=dP(h4,g6)g5,g7,g9,gb,gd=dP(g5,cT(-1-g7,g9)),dP(g7,cT(-1-g9,gb)),dP(g9,cT(-1-gb,gd)),dP(gb,cT(-1-gd,g5)),dP(gd,cT(-1-g5,g7))g6,g8,ga,gc,ge=dP(g6,cT(-1-g8,ga)),dP(g8,cT(-1-ga,gc)),dP(ga,cT(-1-gc,ge)),dP(gc,cT(-1-ge,g6)),dP(ge,cT(-1-g6,g8))gf,gh,gj,gl,gn=dP(gl,cT(-1-gn,gf)),dP(gn,cT(-1-gf,gh)),dP(gf,cT(-1-gh,gj)),dP(gh,cT(-1-gj,gl)),dP(gj,cT(-1-gl,gn))gg,gi,gk,gm,go=dP(gm,cT(-1-go,gg)),dP(go,cT(-1-gg,gi)),dP(gg,cT(-1-gi,gk)),dP(gi,cT(-1-gk,gm)),dP(gk,cT(-1-gm,go))gp,gr,gt,gv,gx=dP(gr,cT(-1-gt,gv)),dP(gt,cT(-1-gv,gx)),dP(gv,cT(-1-gx,gp)),dP(gx,cT(-1-gp,gr)),dP(gp,cT(-1-gr,gt))gq,gs,gu,gw,gy=dP(gs,cT(-1-gu,gw)),dP(gu,cT(-1-gw,gy)),dP(gw,cT(-1-gy,gq)),dP(gy,cT(-1-gq,gs)),dP(gq,cT(-1-gs,gu))gz,gB,gD,gF,gH=dP(gH,cT(-1-gz,gB)),dP(gz,cT(-1-gB,gD)),dP(gB,cT(-1-gD,gF)),dP(gD,cT(-1-gF,gH)),dP(gF,cT(-1-gH,gz))gA,gC,gE,gG,gI=dP(gI,cT(-1-gA,gC)),dP(gA,cT(-1-gC,gE)),dP(gC,cT(-1-gE,gG)),dP(gE,cT(-1-gG,gI)),dP(gG,cT(-1-gI,gA))gJ,gL,gN,gP,gR=dP(gN,cT(-1-gP,gR)),dP(gP,cT(-1-gR,gJ)),dP(gR,cT(-1-gJ,gL)),dP(gJ,cT(-1-gL,gN)),dP(gL,cT(-1-gN,gP))gK,gM,gO,gQ,gS=dP(gO,cT(-1-gQ,gS)),dP(gQ,cT(-1-gS,gK)),dP(gS,cT(-1-gK,gM)),dP(gK,cT(-1-gM,gO)),dP(gM,cT(-1-gO,gQ))g5=dP(g5,g2[gT])g6=g6+g3[gT]end;f_[1]=g5;g0[1]=g6;f_[2]=g7;g0[2]=g8;f_[3]=g9;g0[3]=ga;f_[4]=gb;g0[4]=gc;f_[5]=gd;g0[5]=ge;f_[6]=gf;g0[6]=gg;f_[7]=gh;g0[7]=gi;f_[8]=gj;g0[8]=gk;f_[9]=gl;g0[9]=gm;f_[10]=gn;g0[10]=go;f_[11]=gp;g0[11]=gq;f_[12]=gr;g0[12]=gs;f_[13]=gt;g0[13]=gu;f_[14]=gv;g0[14]=gw;f_[15]=gx;g0[15]=gy;f_[16]=gz;g0[16]=gA;f_[17]=gB;g0[17]=gC;f_[18]=gD;g0[18]=gE;f_[19]=gF;g0[19]=gG;f_[20]=gH;g0[20]=gI;f_[21]=gJ;g0[21]=gK;f_[22]=gL;g0[22]=gM;f_[23]=gN;g0[23]=gO;f_[24]=gP;g0[24]=gQ;f_[25]=gR;g0[25]=gS end end;do local function hf(hg,hh,hi,hj)local result,hk,hl,hm=table.create(hj),0,0,1;for ch=1,hj do for af=math.max(1,ch+1-#hh),math.min(ch,#hg)do hk=hk+hi*hg[af]*hh[ch+1-af]end;local hn=hk%eM;result[ch]=math.floor(hn)hk=(hk-hn)/eM;hl=hl+hn*hm;hm=hm*eM end;return result,hl end;local ho,hp,dm,hq,hr,hs=0,{4,1,2,-2,2},4,{1},e8,e7;repeat dm=dm+hp[dm%6]local c6=1;repeat c6=c6+hp[c6%6]if c6*c6>dm then local ht=dm^(1/3)local hu=ht*eV;hu=hf(table.create(1,math.floor(hu)),hq,1,2)local g,hv=hf(hu,hf(hu,hu,1,4),-1,4)local hw=hu[2]%65536*65536+math.floor(hu[1]/256)local hx=hu[1]%256*16777216+math.floor(hv*eo/3*ht/dm)if ho<16 then ht=math.sqrt(dm)hu=ht*eV;hu=hf(table.create(1,math.floor(hu)),hq,1,2)g,hv=hf(hu,hu,-1,2)local hw=hu[2]%65536*65536+math.floor(hu[1]/256)local hx=hu[1]%256*16777216+math.floor(hv*ep/ht)local ho=ho%8+1;eb[224][ho]=hx;hr[ho],hs[ho]=hw,hx+hw*em;if ho>7 then hr,hs=ed[384],ec[384]end end;ho=ho+1;e6[ho],e5[ho]=hw,hx%el+hw*em;break end until dm%c6==0 until ho>79 end;for dD=224,256,32 do local ff,fg={},nil;if ei then for ch=1,8 do ff[ch]=ei(e7[ch])end else fg={}for ch=1,8 do ff[ch]=dP(e7[ch],0xA5A5A5A5)%4294967296;fg[ch]=dP(e8[ch],0xA5A5A5A5)%4294967296 end end;fe(ff,fg,'SHA-512/'..tostring(dD)..'\128'..string.rep('\0',115)..'\88',0,128)ec[dD]=ff;ed[dD]=fg end;do for ho=1,64 do local hw,hx=math.modf(math.abs(math.sin(ho))*eE)ee[ho]=hw*65536+math.floor(hx*eE)end end;do local hy=29;local function hz()local hA=hy%2;hy=dP((hy-hA)/2,142*hA)return hA end;for ho=1,24 do local hx,dj=0,nil;for g=1,6 do dj=dj and dj*dj*2 or 1;hx=hx+hz()*dj end;local hw=hz()*dj;ea[ho],e9[ho]=hw,hx+hw*en end end;local function hB(dD,hC)local hD=eb[dD]local hE,hF=0,''local eY=table.create(8)eY[1],eY[2],eY[3],eY[4],eY[5],eY[6],eY[7],eY[8]=hD[1],hD[2],hD[3],hD[4],hD[5],hD[6],hD[7],hD[8]local function hG(hH)if hH then local hI=#hH;if hF then hE=hE+hI;local e_=0;local hJ=#hF;if hF~=''and hJ+hI>=64 then e_=64-hJ;eX(eY,hF..string.sub(hH,1,e_),0,64)hF=''end;local f0=hI-e_;local hK=f0%64;eX(eY,hH,e_,f0-hK)hF=hF..string.sub(hH,hI+1-hK)return hG else error('Adding more chunks is not allowed after receiving the result',2)end else if hF then local hL=table.create(10)hL[1]=hF;hL[2]='\128'hL[3]=string.rep('\0',(-9-hE)%64+1)hF=nil;hE=hE*8/eW;for ch=4,10 do hE=hE%1*256;hL[ch]=string.char(math.floor(hE))end;hL=table.concat(hL)eX(eY,hL,0,#hL)local hM=dD/32;for ch=1,hM do eY[ch]=string.format('%08x',eY[ch]%4294967296)end;eY=table.concat(eY,'',1,hM)end;return eY end end;if hC then return hG(hC)()else return hG end end;local function hN(dD,hC)local hE,hF,ff,fg=0,'',table.pack(table.unpack(ec[dD])),not eh and table.pack(table.unpack(ed[dD]))local function hG(hH)if hH then local hI=#hH;if hF then hE=hE+hI;local e_=0;if hF~=''and#hF+hI>=128 then e_=128-#hF;fe(ff,fg,hF..string.sub(hH,1,e_),0,128)hF=''end;local f0=hI-e_;local hK=f0%128;fe(ff,fg,hH,e_,f0-hK)hF=hF..string.sub(hH,hI+1-hK)return hG else error('Adding more chunks is not allowed after receiving the result',2)end else if hF then local hL=table.create(3)hL[1]=hF;hL[2]='\128'hL[3]=string.rep('\0',(-17-hE)%128+9)hF=nil;hE=hE*8/eW;for ch=4,10 do hE=hE%1*256;hL[ch]=string.char(math.floor(hE))end;hL=table.concat(hL)fe(ff,fg,hL,0,#hL)local hM=math.ceil(dD/64)if eh then for ch=1,hM do ff[ch]=eh(ff[ch])end else for ch=1,hM do ff[ch]=string.format('%08x',fg[ch]%4294967296)..string.format('%08x',ff[ch]%4294967296)end;fg=nil end;ff=string.sub(table.concat(ff,'',1,hM),1,dD/4)end;return ff end end;if hC then return hG(hC)()else return hG end end;local function hO(hC)local eY,hE,hF=table.create(4),0,''eY[1],eY[2],eY[3],eY[4]=ef[1],ef[2],ef[3],ef[4]local function hG(hH)if hH then local hI=#hH;if hF then hE=hE+hI;local e_=0;if hF~=''and#hF+hI>=64 then e_=64-#hF;fV(eY,hF..string.sub(hH,1,e_),0,64)hF=''end;local f0=hI-e_;local hK=f0%64;fV(eY,hH,e_,f0-hK)hF=hF..string.sub(hH,hI+1-hK)return hG else error('Adding more chunks is not allowed after receiving the result',2)end else if hF then local hL=table.create(3)hL[1]=hF;hL[2]='\128'hL[3]=string.rep('\0',(-9-hE)%64)hF=nil;hE=hE*8;for ch=4,11 do local hP=hE%256;hL[ch]=string.char(hP)hE=(hE-hP)/256 end;hL=table.concat(hL)fV(eY,hL,0,#hL)for ch=1,4 do eY[ch]=string.format('%08x',eY[ch]%4294967296)end;eY=string.gsub(table.concat(eY),'(..)(..)(..)(..)','%4%3%2%1')end;return eY end end;if hC then return hG(hC)()else return hG end end;local function hQ(hC)local eY,hE,hF=table.pack(table.unpack(ef)),0,''local function hG(hH)if hH then local hI=#hH;if hF then hE=hE+hI;local e_=0;if hF~=''and#hF+hI>=64 then e_=64-#hF;fY(eY,hF..string.sub(hH,1,e_),0,64)hF=''end;local f0=hI-e_;local hK=f0%64;fY(eY,hH,e_,f0-hK)hF=hF..string.sub(hH,hI+1-hK)return hG else error('Adding more chunks is not allowed after receiving the result',2)end else if hF then local hL=table.create(10)hL[1]=hF;hL[2]='\128'hL[3]=string.rep('\0',(-9-hE)%64+1)hF=nil;hE=hE*8/eW;for ch=4,10 do hE=hE%1*256;hL[ch]=string.char(math.floor(hE))end;hL=table.concat(hL)fY(eY,hL,0,#hL)for ch=1,5 do eY[ch]=string.format('%08x',eY[ch]%4294967296)end;eY=table.concat(eY)end;return eY end end;if hC then return hG(hC)()else return hG end end;local function hR(g1,hS,hT,hC)if type(hS)~='number'then error('Argument \'digest_size_in_bytes\' must be a number',2)end;local hF,f_,g0='',table.create(25,0),en==0 and table.create(25,0)local result;local function hG(hH)if hH then local hI=#hH;if hF then local e_=0;if hF~=''and#hF+hI>=g1 then e_=g1-#hF;fZ(f_,g0,hF..string.sub(hH,1,e_),0,g1,g1)hF=''end;local f0=hI-e_;local hK=f0%g1;fZ(f_,g0,hH,e_,f0-hK,g1)hF=hF..string.sub(hH,hI+1-hK)return hG else error('Adding more chunks is not allowed after receiving the result',2)end else if hF then local hU=hT and 31 or 6;hF=hF..(#hF+1==g1 and string.char(hU+128)or string.char(hU)..string.rep('\0',(-2-#hF)%g1)..'\128')fZ(f_,g0,hF,0,#hF,g1)hF=nil;local hV=0;local hW=math.floor(g1/8)local hX={}local function hY(g4)if hV>=hW then fZ(f_,g0,'\0\0\0\0\0\0\0\0',0,8,8)hV=0 end;g4=math.floor(math.min(g4,hW-hV))if en~=0 then for ch=1,g4 do hX[ch]=eh(f_[hV+ch-1+ej])end else for ch=1,g4 do hX[ch]=string.format('%08x',g0[hV+ch]%4294967296)..string.format('%08x',f_[hV+ch]%4294967296)end end;hV=hV+g4;return string.gsub(table.concat(hX,'',1,g4),'(..)(..)(..)(..)(..)(..)(..)(..)','%8%7%6%5%4%3%2%1'),g4*8 end;local hZ={}local h_,i0='',0;local function i1(i2)i2=i2 or 1;if i2<=i0 then i0=i0-i2;local i3=i2*2;local result=string.sub(h_,1,i3)h_=string.sub(h_,i3+1)return result end;local i4=0;if i0>0 then i4=1;hZ[i4]=h_;i2=i2-i0 end;while i2>=8 do local i5,i6=hY(i2/8)i4=i4+1;hZ[i4]=i5;i2=i2-i6 end;if i2>0 then h_,i0=hY(1)i4=i4+1;hZ[i4]=i1(i2)else h_,i0='',0 end;return table.concat(hZ,'',1,i4)end;if hS<0 then result=i1 else result=i1(hS)end end;return result end end;if hC then return hG(hC)()else return hG end end;local function i7(i8)return string.char(tonumber(i8,16))end;local function i9(ia)return string.gsub(ia,'%x%x',i7)end;local ib={['+']=62,['-']=62,[62]='+',['/']=63,['_']=63,[63]='/',['=']=-1,['.']=-1,[-1]='='}local ic=0;for ch,id in ipairs{'AZ','az','09'}do for ie=string.byte(id),string.byte(id,2)do local ig=string.char(ie)ib[ig]=ic;ib[ic]=ig;ic=ic+1 end end;local function ih(ii)local ij=#ii;local result=table.create(math.ceil(ij/3))local hE=0;for fb=1,#ii,3 do local ik,il,im,ip=string.byte(string.sub(ii,fb,fb+2)..'\0',1,-1)hE=hE+1;result[hE]=ib[math.floor(ik/4)]..ib[ik%4*16+math.floor(il/16)]..ib[im and il%16*4+math.floor(im/64)or-1]..ib[ip and im%64 or-1]end;return table.concat(result)end;local function iq(ir)local result,is={},3;for fb,ig in string.gmatch(string.gsub(ir,'%s+',''),'()(.)')do local it=ib[ig]if it<0 then is=is-1;it=0 end;local ho=fb%4;if ho>0 then result[-ho]=it else local ik=result[-1]*4+math.floor(result[-2]/16)local il=result[-2]%16*16+math.floor(result[-3]/4)local im=result[-3]%4*64+it;result[#result+1]=string.sub(string.char(ik,il,im),1,is)end end;return table.concat(result)end;local iu;local iv={}for cO=0,255 do iv[string.format('%02x',cO)]=string.char(cO)end;local function iw(ix,iy,hC,iz)local iA=iu[ix]if not iA then error('Unknown hash function',2)end;local iB=#iy;if iB>iA then iy=string.gsub(ix(iy),'%x%x',i7)iB=#iy end;local iC=ix()(string.gsub(iy,'.',function(cf)return string.char(dP(string.byte(cf),0x36))end)..string.rep('6',iA-iB))local result;local function hG(hH)if not hH then result=result or ix(string.gsub(iy,'.',function(cf)return string.char(dP(string.byte(cf),0x5c))end)..string.rep('\\',iA-iB)..string.gsub(iC(),'%x%x',i7))return result elseif result then error('Adding more chunks is not allowed after receiving the result',2)else iC(hH)return hG end end;if hC then local iD=hG(hC)()return iz and string.gsub(iD,'%x%x',iv)or iD else return hG end end;local iE={md5=hO,sha1=hQ,sha224=function(hC)return hB(224,hC)end,sha256=function(hC)return hB(256,hC)end,sha512_224=function(hC)return hN(224,hC)end,sha512_256=function(hC)return hN(256,hC)end,sha384=function(hC)return hN(384,hC)end,sha512=function(hC)return hN(512,hC)end,sha3_224=function(hC)return hR((1600-2*224)/8,224/8,false,hC)end,sha3_256=function(hC)return hR((1600-2*256)/8,256/8,false,hC)end,sha3_384=function(hC)return hR((1600-2*384)/8,384/8,false,hC)end,sha3_512=function(hC)return hR((1600-2*512)/8,512/8,false,hC)end,shake128=function(hC,hS)return hR((1600-2*128)/8,hS,true,hC)end,shake256=function(hC,hS)return hR((1600-2*256)/8,hS,true,hC)end,hmac=iw,hex_to_bin=i9,base64_to_bin=iq,bin_to_base64=ih,base64_encode=cQ.Encode,base64_decode=cQ.Decode}iu={[iE.md5]=64,[iE.sha1]=64,[iE.sha224]=64,[iE.sha256]=64,[iE.sha512_224]=128,[iE.sha512_256]=128,[iE.sha384]=128,[iE.sha512]=128,[iE.sha3_224]=(1600-2*224)/8,[iE.sha3_256]=(1600-2*256)/8,[iE.sha3_384]=(1600-2*384)/8,[iE.sha3_512]=(1600-2*512)/8}return iE end;d['packages/hash.lua'].cache=c;d['packages/hash.lua'].isCached=false;d['packages/json.lua']={}d['packages/json.lua'].load=function()local l='json.lua'local m='packages/json.lua'local n='packages'local o='4dc5f6c3b5bcd0f200b1ef9ff4a812b86e199331cbfa9858a9c73f2c8b513872a4d3fbd59b0a2d82a36115ac629be786085aa54cbe4d445b0ade77bea5350a86'local cJ={}local function av(cf)if type(cf)~='table'then return type(cf)end;local c6=1;for fc in pairs(cf)do if cf[c6]~=nil then c6=c6+1 else return'table'end end;if c6==1 then return'table'else return'array'end end;local function X(fd)local h={'\\','"','/','\b','\f','\n','\r','\t'}local cg={'\\','"','/','b','f','n','r','t'}for c6,ch in ipairs(h)do fd=fd:gsub(ch,'\\'..cg[c6])end;return fd end;local function af(iF,dj,bE,v)dj=dj+#iF:match('^%s*',dj)if iF:sub(dj,dj)~=bE then if v then error('Expected '..bE..' near position '..dj)end;return dj,false end;return dj+1,true end;local function dm(iF,dj,iG)iG=iG or''local hA='End of input found while parsing string.'if dj>#iF then error(hA)end;local ch=iF:sub(dj,dj)if ch=='"'then return iG,dj+1 end;if ch~='\\'then return dm(iF,dj+1,iG..ch)end;local fW={b='\b',f='\f',n='\n',r='\r',t='\t'}local dh=iF:sub(dj+1,dj+1)if not dh then error(hA)end;return dm(iF,dj+2,iG..(fW[dh]or dh))end;local function iH(iF,dj)local ag=iF:match('^-?%d+%.?%d*[eE]?[+-]?%d*',dj)local iG=tonumber(ag)if not iG then error('Error parsing number at position '..dj..'.')end;return iG,dj+#ag end;function cJ.stringify(cf,w)local fd={}local x=av(cf)if x=='array'then if w then error'Can\'t encode array as key.'end;fd[#fd+1]='['for c6,iG in ipairs(cf)do if c6>1 then fd[#fd+1]=', 'end;fd[#fd+1]=cJ.stringify(iG)end;fd[#fd+1]=']'elseif x=='table'then if w then error'Can\'t encode table as key.'end;fd[#fd+1]='{'for y,dM in pairs(cf)do if#fd>1 then fd[#fd+1]=', 'end;fd[#fd+1]=cJ.stringify(y,true)fd[#fd+1]=':'fd[#fd+1]=cJ.stringify(dM)end;fd[#fd+1]='}'elseif x=='string'then return'"'..X(cf)..'"'elseif x=='number'then if w then return'"'..tostring(cf)..'"'end;return tostring(cf)elseif x=='boolean'then return tostring(cf)elseif x=='nil'then return'null'else error('Unjsonifiable type: '..x..'.')end;return table.concat(fd)end;cJ.null={}function cJ.parse(iF,dj,c_)dj=dj or 1;if dj>#iF then error'Reached unexpected end of input.'end;local dj=dj+#iF:match('^%s*',dj)local d0=iF:sub(dj,dj)if d0=='{'then local cf,d1,d2={},true,true;dj=dj+1;while true do d1,dj=cJ.parse(iF,dj,'}')if d1==nil then return cf,dj end;if not d2 then error'Comma missing between object items.'end;dj=af(iF,dj,':',true)cf[d1],dj=cJ.parse(iF,dj)dj,d2=af(iF,dj,',')end elseif d0=='['then local iI,iG,d2={},true,true;dj=dj+1;while true do iG,dj=cJ.parse(iF,dj,']')if iG==nil then return iI,dj end;if not d2 then error'Comma missing between array items.'end;iI[#iI+1]=iG;dj,d2=af(iF,dj,',')end elseif d0=='"'then return dm(iF,dj+1)elseif d0=='-'or d0:match'%d'then return iH(iF,dj)elseif d0==c_ then return nil,dj+1 else local fX={['true']=true,['false']=false,['null']=cJ.null}for iJ,eY in pairs(fX)do local iK=dj+#iJ-1;if iF:sub(dj,iK)==iJ then return eY,iK+1 end end;local iL='position '..dj..': '..iF:sub(dj,dj+10)error('Invalid json syntax starting at '..iL)end end;return cJ end;d['packages/json.lua'].cache=c;d['packages/json.lua'].isCached=false;d['packages/polyfills/table.create.lua']={}d['packages/polyfills/table.create.lua'].load=function()local l='table.create.lua'local m='packages/polyfills/table.create.lua'local n='packages/polyfills'local o='19eaa311cabc2e4b53501a8cc4090692c36cbccc4e75a0d082e8cfa7543f48cf5f70db601dba94ede670a483e36bcd7a309d720e32921ef0fd000770c799fced'_G.table.create=table.create or function(iM,hl)local dh={}for cg=1,iM,1 do dh[cg]=hl end;return dh end end;d['packages/polyfills/table.create.lua'].cache=c;d['packages/polyfills/table.create.lua'].isCached=false;d['packages/rstr.lua']={}d['packages/rstr.lua'].load=function()local l='rstr.lua'local m='packages/rstr.lua'local n='packages'local o='3fbb599255778057fec55666068f44b9a1168c88fe0501982982796a7a4ed688899a4351a63875869b27a384b203df47f132982656b98423029bfe4e91d51645'local iN=function(iO)iO=iO or'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890 'local iP=math.random(1,#iO)return iO:sub(iP,iP)end;return function(iQ,iO)local eZ=''for cg=1,iQ,1 do eZ=eZ..iN(iO)end;return eZ end end;d['packages/rstr.lua'].cache=c;d['packages/rstr.lua'].isCached=false;d['packages/termination.lua']={}d['packages/termination.lua'].load=function()local l='termination.lua'local m='packages/termination.lua'local n='packages'local o='363f9ffadf1be9c7074c012ecb77d6377a0d2f277f09668eefa74399becf750fbce66eaa4c0b31af551d25107c01d0d99855051a8b4473e1a01b04f4ec019dd5'local iR=false;local iS=os.pullEvent;return{['setDisabled']=function(ag)if ag then if ag~=iR then iS=os.pullEvent end;os.pullEvent=os.pullEventRaw else os.pullEvent=iS end;iR=ag end,['getDisabled']=function()return iR end}end;d['packages/termination.lua'].cache=c;d['packages/termination.lua'].isCached=false;d['packages/uniquekeys.lua']={}d['packages/uniquekeys.lua'].load=function()local l='uniquekeys.lua'local m='packages/uniquekeys.lua'local n='packages'local o='0da3f5a0df8b67ee7f998acc2a713a7096ffbe297e6829d6ada0e4d84bcb46a26512d9256d17c669f2b4126548801a9f80bccec971cbfe4071d67739d368e36a'local iT=function(iU)return string.sub(iU,1,3)~='!!!'end;local keys={['pw']='!!!pw',['enc']='!!!enc',['Eenc']='!!!Eenc'}for af,ag in pairs(keys)do if not iT(ag)then keys[af]=require'rstr'(512)end end;local iV=false;if iV then for af,ag in pairs(keys)do keys[af]=require('base64').Decode(ag)end end;return keys end;d['packages/uniquekeys.lua'].cache=c;d['packages/uniquekeys.lua'].isCached=false;d['packages/xor.lua']={}d['packages/xor.lua'].load=function()local l='xor.lua'local m='packages/xor.lua'local n='packages'local o='12d0c046a9f96fd64280170a2c96a2a7f5260f2189c4756df9dc028a99a73a464037fc967316fb58d20cdf15f91533f94e69c163cf7c06b73c60472bc6528eb2'function repeat_key(iy,hE)if#iy>=hE then return iy:sub(1,hE)end;times=math.floor(hE/#iy)remain=hE%#iy;result=''for cg=1,times do result=result..iy end;if remain>0 then result=result..iy:sub(1,remain)end;return result end;function xor(hC,iy)rkey=repeat_key(iy,#hC)result=''for cg=1,#hC do k_char=rkey:sub(cg,cg)m_char=hC:sub(cg,cg)k_byte=k_char:byte()m_byte=m_char:byte()xor_byte=require('bitop').bxor(m_byte,k_byte)xor_char=string.char(xor_byte)result=result..xor_char end;return result end;return xor end;d['packages/xor.lua'].cache=c;d['packages/xor.lua'].isCached=false;d['version.lua']={}d['version.lua'].load=function()local l='version.lua'local m='version.lua'local n=''local o='7a5cd8cbe43906f7f1c1d50eb18312aff11909772deab5fdcb3a901ad7a86384bebb471694b4760cc67147c5c541519eaba249f1e6426369a2d2db6a32eadfc4'return'1.0.0'end;d['version.lua'].cache=c;d['version.lua'].isCached=false;d['auth']=d['auth.lua']d['auth.lua']=d['auth.lua']d['auth']=d['auth.lua']d['/auth']=d['auth.lua']d['\\auth.lua']=d['auth.lua']d['\\auth']=d['auth.lua']d['boot']=d['boot.lua']d['boot.lua']=d['boot.lua']d['boot']=d['boot.lua']d['/boot']=d['boot.lua']d['\\boot.lua']=d['boot.lua']d['\\boot']=d['boot.lua']d['index']=d['index.lua']d['index.lua']=d['index.lua']d['index']=d['index.lua']d['/index']=d['index.lua']d['\\index.lua']=d['index.lua']d['\\index']=d['index.lua']d['']=d['index.lua']d['']=d['index.lua']d['']=d['index.lua']d['/']=d['index.lua']d['\\']=d['index.lua']d['\\']=d['index.lua']d['load-installer']=d['load-installer.lua']d['load-installer.lua']=d['load-installer.lua']d['load-installer']=d['load-installer.lua']d['/load-installer']=d['load-installer.lua']d['\\load-installer.lua']=d['load-installer.lua']d['\\load-installer']=d['load-installer.lua']d['login']=d['login.lua']d['login.lua']=d['login.lua']d['login']=d['login.lua']d['/login']=d['login.lua']d['\\login.lua']=d['login.lua']d['\\login']=d['login.lua']d['misc/chime']=d['misc/chime.lua']d['misc\\chime.lua']=d['misc/chime.lua']d['misc\\chime']=d['misc/chime.lua']d['/misc/chime']=d['misc/chime.lua']d['\\misc\\chime.lua']=d['misc/chime.lua']d['\\misc\\chime']=d['misc/chime.lua']d['packages/basalt']=d['packages/basalt.lua']d['packages\\basalt.lua']=d['packages/basalt.lua']d['packages\\basalt']=d['packages/basalt.lua']d['basalt']=d['packages/basalt.lua']d['basalt.lua']=d['packages/basalt.lua']d['basalt']=d['packages/basalt.lua']d['/basalt']=d['packages/basalt.lua']d['\\basalt.lua']=d['packages/basalt.lua']d['\\basalt']=d['packages/basalt.lua']d['/packages/basalt']=d['packages/basalt.lua']d['\\packages\\basalt.lua']=d['packages/basalt.lua']d['\\packages\\basalt']=d['packages/basalt.lua']d['packages/base64']=d['packages/base64.lua']d['packages\\base64.lua']=d['packages/base64.lua']d['packages\\base64']=d['packages/base64.lua']d['base64']=d['packages/base64.lua']d['base64.lua']=d['packages/base64.lua']d['base64']=d['packages/base64.lua']d['/base64']=d['packages/base64.lua']d['\\base64.lua']=d['packages/base64.lua']d['\\base64']=d['packages/base64.lua']d['/packages/base64']=d['packages/base64.lua']d['\\packages\\base64.lua']=d['packages/base64.lua']d['\\packages\\base64']=d['packages/base64.lua']d['packages/bitop']=d['packages/bitop.lua']d['packages\\bitop.lua']=d['packages/bitop.lua']d['packages\\bitop']=d['packages/bitop.lua']d['bitop']=d['packages/bitop.lua']d['bitop.lua']=d['packages/bitop.lua']d['bitop']=d['packages/bitop.lua']d['/bitop']=d['packages/bitop.lua']d['\\bitop.lua']=d['packages/bitop.lua']d['\\bitop']=d['packages/bitop.lua']d['/packages/bitop']=d['packages/bitop.lua']d['\\packages\\bitop.lua']=d['packages/bitop.lua']d['\\packages\\bitop']=d['packages/bitop.lua']d['packages/child_process']=d['packages/child_process.lua']d['packages\\child_process.lua']=d['packages/child_process.lua']d['packages\\child_process']=d['packages/child_process.lua']d['child_process']=d['packages/child_process.lua']d['child_process.lua']=d['packages/child_process.lua']d['child_process']=d['packages/child_process.lua']d['/child_process']=d['packages/child_process.lua']d['\\child_process.lua']=d['packages/child_process.lua']d['\\child_process']=d['packages/child_process.lua']d['/packages/child_process']=d['packages/child_process.lua']d['\\packages\\child_process.lua']=d['packages/child_process.lua']d['\\packages\\child_process']=d['packages/child_process.lua']d['packages/console']=d['packages/console.lua']d['packages\\console.lua']=d['packages/console.lua']d['packages\\console']=d['packages/console.lua']d['console']=d['packages/console.lua']d['console.lua']=d['packages/console.lua']d['console']=d['packages/console.lua']d['/console']=d['packages/console.lua']d['\\console.lua']=d['packages/console.lua']d['\\console']=d['packages/console.lua']d['/packages/console']=d['packages/console.lua']d['\\packages\\console.lua']=d['packages/console.lua']d['\\packages\\console']=d['packages/console.lua']d['packages/forceyield']=d['packages/forceyield.lua']d['packages\\forceyield.lua']=d['packages/forceyield.lua']d['packages\\forceyield']=d['packages/forceyield.lua']d['forceyield']=d['packages/forceyield.lua']d['forceyield.lua']=d['packages/forceyield.lua']d['forceyield']=d['packages/forceyield.lua']d['/forceyield']=d['packages/forceyield.lua']d['\\forceyield.lua']=d['packages/forceyield.lua']d['\\forceyield']=d['packages/forceyield.lua']d['/packages/forceyield']=d['packages/forceyield.lua']d['\\packages\\forceyield.lua']=d['packages/forceyield.lua']d['\\packages\\forceyield']=d['packages/forceyield.lua']d['packages/hash']=d['packages/hash.lua']d['packages\\hash.lua']=d['packages/hash.lua']d['packages\\hash']=d['packages/hash.lua']d['hash']=d['packages/hash.lua']d['hash.lua']=d['packages/hash.lua']d['hash']=d['packages/hash.lua']d['/hash']=d['packages/hash.lua']d['\\hash.lua']=d['packages/hash.lua']d['\\hash']=d['packages/hash.lua']d['/packages/hash']=d['packages/hash.lua']d['\\packages\\hash.lua']=d['packages/hash.lua']d['\\packages\\hash']=d['packages/hash.lua']d['packages/json']=d['packages/json.lua']d['packages\\json.lua']=d['packages/json.lua']d['packages\\json']=d['packages/json.lua']d['json']=d['packages/json.lua']d['json.lua']=d['packages/json.lua']d['json']=d['packages/json.lua']d['/json']=d['packages/json.lua']d['\\json.lua']=d['packages/json.lua']d['\\json']=d['packages/json.lua']d['/packages/json']=d['packages/json.lua']d['\\packages\\json.lua']=d['packages/json.lua']d['\\packages\\json']=d['packages/json.lua']d['packages/polyfills/table.create']=d['packages/polyfills/table.create.lua']d['packages\\polyfills\\table.create.lua']=d['packages/polyfills/table.create.lua']d['packages\\polyfills\\table.create']=d['packages/polyfills/table.create.lua']d['polyfills/table.create']=d['packages/polyfills/table.create.lua']d['polyfills\\table.create.lua']=d['packages/polyfills/table.create.lua']d['polyfills\\table.create']=d['packages/polyfills/table.create.lua']d['/polyfills/table.create']=d['packages/polyfills/table.create.lua']d['\\polyfills\\table.create.lua']=d['packages/polyfills/table.create.lua']d['\\polyfills\\table.create']=d['packages/polyfills/table.create.lua']d['/packages/polyfills/table.create']=d['packages/polyfills/table.create.lua']d['\\packages\\polyfills\\table.create.lua']=d['packages/polyfills/table.create.lua']d['\\packages\\polyfills\\table.create']=d['packages/polyfills/table.create.lua']d['packages/rstr']=d['packages/rstr.lua']d['packages\\rstr.lua']=d['packages/rstr.lua']d['packages\\rstr']=d['packages/rstr.lua']d['rstr']=d['packages/rstr.lua']d['rstr.lua']=d['packages/rstr.lua']d['rstr']=d['packages/rstr.lua']d['/rstr']=d['packages/rstr.lua']d['\\rstr.lua']=d['packages/rstr.lua']d['\\rstr']=d['packages/rstr.lua']d['/packages/rstr']=d['packages/rstr.lua']d['\\packages\\rstr.lua']=d['packages/rstr.lua']d['\\packages\\rstr']=d['packages/rstr.lua']d['packages/termination']=d['packages/termination.lua']d['packages\\termination.lua']=d['packages/termination.lua']d['packages\\termination']=d['packages/termination.lua']d['termination']=d['packages/termination.lua']d['termination.lua']=d['packages/termination.lua']d['termination']=d['packages/termination.lua']d['/termination']=d['packages/termination.lua']d['\\termination.lua']=d['packages/termination.lua']d['\\termination']=d['packages/termination.lua']d['/packages/termination']=d['packages/termination.lua']d['\\packages\\termination.lua']=d['packages/termination.lua']d['\\packages\\termination']=d['packages/termination.lua']d['packages/uniquekeys']=d['packages/uniquekeys.lua']d['packages\\uniquekeys.lua']=d['packages/uniquekeys.lua']d['packages\\uniquekeys']=d['packages/uniquekeys.lua']d['uniquekeys']=d['packages/uniquekeys.lua']d['uniquekeys.lua']=d['packages/uniquekeys.lua']d['uniquekeys']=d['packages/uniquekeys.lua']d['/uniquekeys']=d['packages/uniquekeys.lua']d['\\uniquekeys.lua']=d['packages/uniquekeys.lua']d['\\uniquekeys']=d['packages/uniquekeys.lua']d['/packages/uniquekeys']=d['packages/uniquekeys.lua']d['\\packages\\uniquekeys.lua']=d['packages/uniquekeys.lua']d['\\packages\\uniquekeys']=d['packages/uniquekeys.lua']d['packages/xor']=d['packages/xor.lua']d['packages\\xor.lua']=d['packages/xor.lua']d['packages\\xor']=d['packages/xor.lua']d['xor']=d['packages/xor.lua']d['xor.lua']=d['packages/xor.lua']d['xor']=d['packages/xor.lua']d['/xor']=d['packages/xor.lua']d['\\xor.lua']=d['packages/xor.lua']d['\\xor']=d['packages/xor.lua']d['/packages/xor']=d['packages/xor.lua']d['\\packages\\xor.lua']=d['packages/xor.lua']d['\\packages\\xor']=d['packages/xor.lua']d['version']=d['version.lua']d['version.lua']=d['version.lua']d['version']=d['version.lua']d['/version']=d['version.lua']d['\\version.lua']=d['version.lua']d['\\version']=d['version.lua']return require'index'end)(require or function()end,...)